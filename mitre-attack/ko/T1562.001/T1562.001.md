# 🛡️ SentinelOne 우회 공격 기법 분석: MITRE T1562.001 기반

> SentinelOne은 고급 행위 기반 EDR 솔루션이지만, **MITRE ATT&CK의 T1562.001 (Security Software Disable)** 기법을 통해 공격자에 의해 우회 또는 무력화될 수 있습니다. 본 문서는 해당 기술을 중심으로 실제 공격 시나리오, 방어 메커니즘, 우회 사례를 정리합니다.

---

## 🎯 T1562.001 – Security Software Disable: Disable or Modify Tools

**보안 소프트웨어 또는 방어 기능을 비활성화하거나 수정하여 탐지를 회피**하고 공격을 지속할 수 있도록 하는 대표적인 우회 기법입니다.  
SentinelOne과 같은 EDR 제품도 이 기법의 주요 타깃이 됩니다.

---

## 🚧 SentinelOne 우회를 위한 실제 공격 시나리오

| 단계 | 기법 또는 시도 | 설명 |
|------|----------------|------|
| 🔍 탐지 우선 조사 | `tasklist`, `sc query` 등으로 서비스 이름 확인 | `SentinelAgent`, `SentinelOne Monitor` 등 |
| 🚫 Agent 종료 시도 | `taskkill`, 서비스 중지 | 관리자 권한 또는 LPE 취약점 이용 시 가능 |
| 🧰 Driver/Service 제거 | `sc delete`, 레지스트리 삭제 | SentinelOne 드라이버(`SentinelMonitor.sys`) 제거 시도 |
| ⚠️ Tamper Protection 우회 | UAC 우회, 서명된 바이너리 하이재킹 | 보호 설정 무력화 시도 |
| 🪝 Process Injection / API Hooking | 악성 인젝션으로 모듈 기능 방해 | 행위 탐지 회피 목적 |
| 🧟 Signed Binary Proxy Execution (T1218) | `rundll32`, `mshta` 등 정상 프로세스 활용 | 평판 기반 탐지 우회 |

---

## 🧨 실제 사용 사례

### HermeticWiper
- 커널 레벨에서 SentinelOne 포함 EDR 드라이버 제거 및 파괴

### Cobalt Strike
- `dllhost.exe`, `notepad.exe`에 인젝션하여 SentinelOne 회피

### Lazarus Group
- CVE-2021-21551 (Dell 드라이버 LPE)로 Tamper Protection 우회 후 드라이버 언로드

---

## 🧷 SentinelOne 자체 보호 메커니즘

| 기능 | 설명 |
|------|------|
| 🔐 Tamper Protection | 관리자 권한 있어도 중지 불가 |
| 🔄 Self-Healing | Agent 손상 시 자동 복구 |
| 🧠 커널 레벨 행위 모니터링 | 비정상 행위 감지 및 차단, 격리 |
| 🔒 디지털 서명 검증 | 보호 모듈 위조 방지 |

---

## 💣 SentinelOne 우회/무력화 가능성

### 1. 커널 취약점 + 드라이버 언로드

- **CVE-2021-21551** 같은 LPE 취약점으로 커널 권한 획득  
- SentinelOne 드라이버 언로드 및 Agent 제거 가능  
- APT 그룹에서 실제 사용된 바 있음

---

### 2. 부트킷 or UEFI 루트킷

- SentinelOne보다 먼저 실행되어 **행위 모니터링 무력화**  
- MBR/UEFI 공격은 흔치 않지만 치명적

---

### 3. Signed Binary Proxy Execution (T1218) + 인젝션

- `rundll32`, `mshta` 등 정상 서명 바이너리를 이용  
- 악성 DLL 로딩 후 메모리 인젝션으로 탐지 우회

---

### 4. EDR Blind Spot: LOLBins

- `InstallUtil.exe`, `PresentationHost.exe` 등 사용  
- SentinelOne 탐지 제외 대상 도구를 활용해 우회

---

### 5. EDR Kill Tools

- 다크웹 유통 `EDRKiller`, `Invoke-EDRKill`, `AvosLocker Tool` 등  
- AMSI 우회, 드라이버 제거, 서비스 중지 시도  
- 변형된 버전은 탐지 우회 가능성 있음

---

## ✅ SentinelOne 우회 요약

| 항목 | 내용 |
|------|------|
| ✅ 우회 가능성 | 존재함 (커널 취약점, 루트킷, 인젝션 등) |
| 📌 필요 조건 | 관리자 권한, LPE, Signed Driver 등 |
| 🛑 공격자 수준 | 고급 공격자/APT 그룹 |
| 🔒 방어 수단 | Tamper Protection, Self-Healing, 커널 모니터링 등 |

---

## 🧩 결론

SentinelOne은 시장에서 매우 강력한 보안 솔루션이지만, **권한 상승 및 커널 접근 권한을 확보한 공격자**에 의해 우회될 수 있습니다.  
**MITRE T1562.001 기법은 SentinelOne을 직접 무력화하거나 방해하기 위해 실제로 자주 사용되는 고급 공격 기법이며**,  
이에 대한 방어 체계는 EDR 단독이 아닌 **다계층 보안(MDR, SOAR, WAF, 포렌식 등)**과의 연계가 반드시 필요합니다.

---
