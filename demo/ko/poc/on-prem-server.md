# PLURA-XDR 온프레미스 PoC — 목표 및 제원

아래 문서는 PoC(Proof-of-Concept) 목적, 범위, 요구 제원(하드웨어/네트워크/소프트웨어), 테스트 시나리오 및 성공 기준을 한 장으로 정리한 문서입니다.

---

# 1) PoC 개요

**목표**

* 단일 온프레미스 서버에서 PLURA-XDR의 로그 수집·분석·탐지·자동대응 기능을 검증한다.
* 웹 POST-body 탐지, 엔드포인트 탐지(EDR), 포렌식 증적 수집, 자동격리/차단을 시나리오로 재현하여 기능·성능·운영성을 확인한다.

**기간**

* 준비: 5 영업일
* 설치·초기 구성: 1~2일
* 테스트·시나리오 실행: 3~5일
* 결과 검증·보고서: 1~2일

**범위**

* 로그 수집 및 분석 서버: 1대(온프레미스)
* 대상 시스템: Windows, Linux, 단말(Windows PC), Unix(syslog 수집)
* 웹로그: 웹방화벽의 포트 미러 기능으로 수집 또는 PLURA 리버스 프록시로 연동하여 수집

---

# 2) PoC 대상 시스템

* **윈도우 (서버 / AD 등)** : 
  - 예) 파일서버01 (Windows Server 2019, 192.168.10.11) — 역할: AD/파일서버
  - 작성 팁: 호스트명, OS버전, 내부IP, 역할(AD/Web/DB 등)을 포함하세요.

* **리눅스 (웹 / API / DB 등)** :
  - 예) web01 (Ubuntu 22.04, 192.168.10.21) — 역할: nginx + application
  - 작성 팁: 웹서버, API서버, DB서버를 각각 구분해 적어주세요. POST-body 수집 대상 여부 표기 권장.

* **단말 PC (엔드포인트 테스트용)** :
  - 예) user-pc-01 (Windows 10, 192.168.10.101) — 테스트 사용자: test1
  - 작성 팁: 테스트용으로 사용할 PC 최소 1~3대 명시(소유/가상머신 가능). 에이전트 설치 가능 여부 표기.

* **유닉스 (syslog 수집 — 에이전트 미설치)** :
  - 예) unix-log-01 (AIX 7.1, 192.168.10.31) — 전송: syslog TCP/UDP
  - 작성 팁: 에이전트 설치 불가 호스트에 대해 syslog 포워딩 설정(UDP/TCP/CEF/JSON) 정보 기입.

# 📖 매뉴얼
- 윈도우 / 리눅스 (에이전트 설치/설정): https://docs.plura.io/ko/agents/edr  
- 유닉스 (syslog 설정 안내): https://docs.plura.io/ko/agents/siem/cplc

---

# 3) 서버 제원 (권장 / 최소)

**PoC 단기간/경량**

* CPU: 40 vCPU (20코어 x2 하이퍼스레드 허용)
* 메모리: 512 GB RAM
* 디스크: 5 TB SSD (최소, 로그 보관량 작을 때)
* 네트워크: 1 Gbps NIC (관리/수집 전용 VLAN 권장)
* OS: Rocky Linux 8

**디스크 산정 예시**

* 예상 일일 로그 생성량 = 10 GB/day
* 보관기간 7일 => 최소 70 GB + 여유 30% = 100 GB → **1 TB 이상 권장**
  (실제 로그량은 POST body 포함 여부, 트래픽, 샘플링 정책에 따라 달라짐)

---

# 4) 웹방화벽 운영 관련 (요구/검증 항목)

* **포트 미러링(SPAN) 지원 여부**: [ ] 지원  [ ] 미지원

  * 지원 시: 웹방화벽 미러 포트 → PLURA 수집 NIC로 미러링
* **포트 미러 미지원 시 웹 로그 수집 방안**:

  * PLURA를 웹방화벽과 웹서버 사이에 위치하도록 구성함
  * 프록시(리버스) 레벨에서 액세스 로그 포워딩
* **리버스 프록시로 운영**: 가능 — 리버스 프록시의 요청 본문(POST) 수집 및 PLURA로 전송

  * 리버스 프록시 방화벽 구성 매뉴얼: [https://docs.plura.io/ko/iaas/ncloud/plurawaf](https://docs.plura.io/ko/iaas/ncloud/plurawaf)

---

# 5) Agent / Syslog 설정 (핵심 체크포인트)

* Windows: 에이전트 설치(EDR + SIEM 에이전트), Windows Event Log 수집 설정, Sysmon 설치 권장
* Linux: 에이전트 설치(파일/프로세스/네트워크), /var/log/secure, /var/log/messages, nginx/apache access+error + POST body 로그 설정
* Unix (에이전트 미설치): syslog(UDP/TCP)로 PLURA Collector에 포워딩 — 포맷(CEF/JSON/etc) 확인
* 시간 동기화(NTP), 로컬 디스크 퍼미션(로그 접근), SELinux/AppArmor 정책 검토

(📖 매뉴얼: [https://docs.plura.io/ko/agents/siem/cplc](https://docs.plura.io/ko/agents/siem/cplc) )

---

# 6) 테스트 시나리오 (우선순위 포함)

1. **웹 POST 공격 시나리오 (최우선)**

   * SQLi 페이로드 포함 POST 요청 전송 → PLURA 탐지 및 WAF/프록시 차단 여부 확인
   * WebShell 업로드 시도 → 파일 업로드 탐지 → 자동격리/프로세스 차단

2. **인증 관련 공격**

   * Credential stuffing (동시/연속 로그인 실패) → 탐지/계정 차단/경보 생성

3. **엔드포인트 악성행위**

   * 랜섬웨어 샘플 실행(테스트 샘플) → 프로세스 종료, 파일 격리, 호스트 종료(자동) 검증

4. **수집·상관 분석 검증**

   * 동일 공격의 웹 로그 + EDR 이벤트 상관 → 타임라인 및 공격 전파 경로 시각화

5. **포렌식 검증**

   * 특정 시점의 메모리·파일·레지스트리 스냅샷 요청 → 증적 추출·다운로드

6. **성능/부하 테스트**

   * 동시 로그 입력(예: 초당 N건) → 수집 지연/분석 지연 측정

---

# 7) 성공 기준

* 웹 POST-body 기반 공격(예: SQLi, WebShell 업로드) **탐지율 ≥ 90%** 및 탐지 시 알림 생성  
* EDR로부터의 실행 프로세스(악성행위)에 대해 **자동 차단(Kill) 또는 네트워크 격리**가 정상 동작  
* 공격 시점으로부터 **타임라인 생성 ≤ 5분** (로그 수집→상관분석→대시보드 반영)  
* 증적(포렌식) 수집이 가능하고, **증적 추출 기능 정상 동작** (파일/메모리/레지스트리)  
* 단일 서버 환경에서 **평상시 로그처리 지연 < 10초**, 부하 시 허용범위 내 성능 유지  
* 테스트 완료 후 **보고서(탐지 이력, 미탐 사례, 개선 권고)** 제공  

---

# 8) 산출물 (PoC 종료 시 제공)

* 설치·구성 문서 (설치 스크립트, 설정값)
* 네트워크 구성도(최종) 및 포트/방화벽 규칙 목록
* 테스트 케이스별 결과표(탐지·대응·로그샘플 포함)
* 포렌식 증적 파일(요청 시) 및 타임라인 리포트
* 성능측정 결과 및 권장 운영 제원(정식 도입 제안 포함)

---

# 9) 위험요소 및 대응 방안

* **로그 과다(디스크 부족)** → 초기 샘플링/압축·회전 정책 적용, 보관기간 조정
* **네트워크 미러링 불가** → 리버스 프록시/웹서버 로그 포워딩으로 대체
* **에이전트 설치 불가 호스트** → syslog/Netflow 또는 네트워크 기반 탐지로 보완
* **시계 불일치(NTP 미설정)** → 타임라인/포렌식 무결성 문제 — NTP 필수 적용

---

# 10) 권장 체크리스트 매핑

* 위협 탐지: 웹 POST본문·Sysmon·기본 악성코드 탐지 항목 포함 → **시나리오 1,2,3**으로 검증
* 대응: 네트워크 격리, 프로세스/파일 차단, 호스트 종료 → **시나리오 3**로 검증
* 분석·포렌식: 타임라인, 명령어 히스토리, 포렌식 수집 → **시나리오 4,5**로 검증
* 에이전트 관리: 에이전트 설치·그룹관리·미동작 추적 → 설치 단계 검증
* 안정성: 리소스/성능 테스트 → **시나리오 6**로 검증

---

# 11) 권장 체크포인트(사전 준비 목록)

* [ ] PoC 대상 서버·IP 목록 제출
* [ ] SPAN/미러 포트 여부 확인 (네트워크 담당자 확인)
* [ ] 관리자 계정(SSH/RDP) 제공(제한적 시간)
* [ ] 테스트용 랜섬웨어/악성 샘플 제공(격리된 테스트 환경에서만)
* [ ] 로그 보관 정책(기간) 및 샘플 로그 제공
* [ ] 방화벽 규칙(PLURA Collector 접근 허용) 적용

---
