# PLURA-XDR 온프레미스 PoC — 목표 및 제원

아래 문서는 PoC(Proof-of-Concept) 목적, 범위, 요구 제원(하드웨어/네트워크/소프트웨어), 테스트 시나리오 및 성공 기준을 한 장으로 정리한 문서입니다.

---

# 1) PoC 개요

**목표**

* 단일 온프레미스 서버에서 PLURA-XDR의 **로그 수집·분석·탐지·자동대응**을 검증합니다.
* **웹 POST-body 탐지**, **엔드포인트 탐지(EDR)**, **포렌식 증적 수집**, **자동 격리/차단**을 시나리오로 재현하여 **기능·성능·운영성**을 확인합니다.

**기간**

* 준비: 5 영업일
* 설치·초기 구성: 1~2일
* 테스트·시나리오 실행: 3~5일
* 결과 검증·보고서: 1~2일

**범위**

* 로그 수집 및 분석 서버: 1대(온프레미스)
* 대상 시스템: Windows, Linux, 단말(Windows PC), **Unix(syslog 수집)**
* 웹로그: **웹방화벽 포트 미러(SPAN)** 또는 **PLURA 리버스 프록시 연동**으로 수집

---

# 2) PoC 대상 시스템

* **Windows(서버/AD 등)**
  예) `filesv01` (Windows Server 2019, 192.168.10.11) — 역할: AD/파일
  ☑︎ 호스트명, OS, 내부 IP, 역할(AD/Web/DB 등) 명시

* **Linux(웹/API/DB 등)**
  예) `web01` (Ubuntu 22.04, 192.168.10.21) — 역할: Nginx + App
  ☑︎ 웹/API/DB 구분, **POST-body 수집 대상 여부** 표기

* **단말 PC(엔드포인트 테스트용)**
  예) `user-pc-01` (Windows 10, 192.168.10.101) — 테스트 계정: `test1`
  ☑︎ 1~3대, 에이전트 설치 가능 여부 표기

* **Unix(에이전트 미설치, syslog 수집)**
  예) `unix-log-01` (AIX 7.1, 192.168.10.31) — 전송: syslog TCP/UDP
  ☑︎ syslog 포워딩(UDP/TCP/CEF/JSON) 정보 기입

**📖 매뉴얼**

* Windows/Linux 에이전트: [https://docs.plura.io/ko/agents/edr](https://docs.plura.io/ko/agents/edr)
* Unix(syslog) 설정: [https://docs.plura.io/ko/agents/siem/cplc](https://docs.plura.io/ko/agents/siem/cplc)

---

# 3) 서버 제원

> 본 PoC는 **인프라/업무 서버 1대당 5MB/일** 가정을 기준으로 산정합니다.
> (웹/대용량 POST-body 테스트는 아래 “확장형” 권장)

**기본(경량) 권장**

* CPU: **40 vCPU**
* 메모리: **512GB RAM**
* 디스크: **5TB SSD**(로그/인덱스/메타 포함)
* 네트워크: 1GbE (수집 전용 VLAN 권장)
* OS: Rocky Linux 8

**디스크 산정 예시(보존 2주, 서버 30대 가정)**

* 일일 총 로그량: **5MB × 30대 = 150MB/일(≈0.15GB/일)**
* **보존 14일**: **~2.1GB(raw)** → 압축(2:1) 시 **~1.05GB**
* 인덱스·메타·여유(×1.5) 반영: **~1.6GB 내외**
* 스파이크/초기 튜닝, 스냅샷 등을 고려한 최소 여유: **≥ 20GB 권장**
* ※ 상기 규모 기준에서 **기본 디스크(5TB SSD)**는 PoC 범위를 **충분히 상회**하여 **여유 운용**이 가능합니다.
* **대용량 POST-body 시나리오**(트래픽 집중, 파일 업·다운로드 대량 등) 수행 시에는 별도 버퍼를 고려해 **수백 GB~1TB 추가 여유**를 권장합니다.

---

# 4) 웹방화벽 연동(요구/검증)

* **포트 미러링(SPAN)**

  * [ ] 지원  [ ] 미지원
  * 지원 시: **WAF 미러 포트 → PLURA 수집 NIC**
* **미러 미지원 시 대안**

  * **리버스 프록시 구성**(WAF↔웹서버 사이) + **요청 본문(POST) 로그 포워딩**
* 리버스 프록시 구성 가이드: [https://docs.plura.io/ko/iaas/ncloud/plurawaf](https://docs.plura.io/ko/iaas/ncloud/plurawaf)

---

# 5) Agent / Syslog 설정(핵심)

* **Windows**: EDR+SIEM 에이전트, Windows Event Log, **Sysmon 권장**
* **Linux**: 에이전트(파일/프로세스/네트워크), `/var/log/secure`, `/var/log/messages`, **nginx/apache access+error + POST-body**
* **Unix(에이전트 미설치)**: **syslog(UDP/TCP)**로 PLURA Collector 포워딩(CEF/JSON 등 포맷 확인)
* **공통**: NTP, 권한/SELinux/AppArmor 점검

---

# 6) 테스트 시나리오(우선순위)

1. **웹 POST 공격(최우선)**

   * SQLi 포함 POST 전송 → 탐지 & WAF/프록시 차단
   * WebShell 업로드 시도 → 업로드 탐지 → 자동 격리/프로세스 차단
2. **인증 공격**

   * Credential stuffing(연속 실패) → 탐지/계정 차단/경보
3. **엔드포인트 악성행위**

   * 안전한 테스트 샘플로 랜섬웨어 행위 유사 패턴 실행 → 프로세스 Kill/격리/호스트 격리
4. **상관 분석**

   * 동일 공격의 **웹로그 + EDR 이벤트** 상관 → 타임라인/전파 경로
5. **포렌식**

   * 특정 시점 **메모리/파일/레지스트리** 수집 → 증적 추출
6. **성능/부하**

   * 초당 N건 동시 입력 → 수집/분석 지연 측정

---

# 7) 성공 기준

* 웹 POST-body 기반 공격(SQLi, WebShell 업로드) **탐지율 ≥ 90%**, 탐지 시 알림 생성
* EDR에서 악성/의심 프로세스에 대해 **자동 차단 또는 네트워크 격리 동작**
* 공격 발생 후 **타임라인 생성 ≤ 5분**(수집→상관→대시보드)
* **포렌식 증적 수집 및 추출** 정상 동작
* 단일 서버에서 **평상시 처리 지연 < 10초**, 부하 시 허용 범위 유지
* 테스트 종료 보고서(탐지 이력/미탐/개선 권고) 제공

---

# 8) 산출물

* 설치·구성 문서(스크립트/설정)
* 최종 네트워크 구성도 및 포트/방화벽 규칙
* 테스트 케이스 결과표(탐지·대응·로그샘플)
* 포렌식 증적 파일(요청 시) 및 타임라인 리포트
* 성능 측정 결과 및 권장 운영 제원(정식 도입 제안)

---

# 9) 위험요소 및 대응

* **로그 급증(디스크 부족)** → 초기 샘플링, 압축/회전, 보존기간 조정
* **미러링 불가** → 리버스 프록시/웹서버 로그 포워딩
* **에이전트 미설치 호스트** → **syslog 수집으로 대체**
* **시간 동기화 미흡** → NTP 의무화(타임라인·증적 무결성)

---

# 10) 체크리스트 매핑

* 위협 탐지: 웹 POST-body·Sysmon·기본 악성코드 → **시나리오 1~3**
* 대응: 네트워크 격리/프로세스·파일 차단/호스트 종료 → **시나리오 3**
* 분석·포렌식: 타임라인/명령 히스토리/포렌식 수집 → **시나리오 4~5**
* 에이전트 관리: 설치·그룹·미동작 추적 → 설치 단계
* 안정성: 리소스/성능 → **시나리오 6**

---

# 11) 사전 준비 체크리스트

* [ ] PoC 대상 서버·IP 목록
* [ ] SPAN/미러 포트 지원 여부(네트워크 담당 확인)
* [ ] 관리자 계정(SSH/RDP) — 제한 시간 제공
* [ ] 테스트 샘플(격리된 환경 전용)
* [ ] 로그 보존 정책(기간) 및 샘플 로그
* [ ] 방화벽 규칙(PLURA Collector 접근 허용)

---

## 간단 메모(두 줄 요약)

* **로그량 가정**: 인프라/업무 서버 **5MB/일 × 300대 = 1.5GB/일** → 30일 **~45GB(raw)** (압축 후 ~22.5GB).
* **syslog 범위**: **syslog 출력이 가능한 모든 장비의 로그를 수집 가능**(FW/라우터/스위치/VPN/WAF/ADC/DNS/DHCP/프록시/메일·인증 등).

