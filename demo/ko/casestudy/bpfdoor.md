SKT 사건과 관련된 BPFDoor 공격 사례를 중심으로, BPFDoor의 일반적인 작동 원리와 다양한 공격 사례까지 폭넓게 정리하고, 시스템 관리자 및 보안 운영팀을 위한 심화 대응 전략도 포함하여 작성하겠습니다.  

# SKT 유심 해킹 사건과 BPFDoor 악성코드 분석

## 1. SKT 사건에 사용된 BPFDoor 악성코드 분석
### 1.1 공격 방법과 내부 침투 경로  
SK텔레콤 **홈 가입자 서버(HSS)**에 공격자가 침투하여 `BPFDoor` 백도어를 심은 것으로 파악되었습니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=SKT%EB%8A%94%2022%EC%9D%BC%20%EC%9C%A0%EC%8B%AC%20%EA%B4%80%EB%A0%A8%20%EC%A0%95%EB%B3%B4%EA%B0%80,%EC%BD%94%EB%93%9C%EA%B0%80%20BRF%EB%8F%84%EC%96%B4%EC%9D%BC%20%EA%B0%80%EB%8A%A5%EC%84%B1%EC%9D%B4%20%EB%86%92%EB%8B%A4%EB%8A%94%20%EA%B2%83%EC%9D%B4%EB%8B%A4)) ([KISA "최근 사용된 악성코드 주의보"…SKT 해킹 악성파일 공개 | 연합뉴스](https://www.yna.co.kr/view/AKR20250425168300017#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%B0%B1%EB%8F%84%EC%96%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A1%9C%202021%EB%85%84%20PWC%EC%82%AC%EC%9D%98,%EC%B5%9C%EC%B4%88%EB%A1%9C%20%EC%95%8C%EB%A0%A4%EC%A7%84%20%EC%82%AC%EC%9D%B4%EB%B2%84%20%EA%B3%B5%EA%B2%A9%20%EC%88%98%EB%B2%95%EC%9D%B4%EB%8B%A4)). HSS는 가입자 전화번호, IMSI 등 **유심(USIM) 정보**와 통신 서비스 인증 데이터를 관리하는 핵심 서버로, 공격자는 이 서버를 장악해 대량의 가입자 정보를 탈취한 것으로 보입니다. 초기 침투 수법으로는 **APT 공격**에서 흔한 방법(예: 제로데이 취약점 악용, 관리자 계정 탈취 등)이 거론되며, 구체적으로는 알려지지 않았으나 **중국계 해킹 그룹**의 정교한 **지능형 지속 위협(APT)** 전술이 의심됩니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B8%B0%EB%B0%98%20HSS%EC%97%90%20%EC%B9%A8%ED%88%AC%ED%95%B4,%EC%9D%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4%EB%A1%9C%20%EA%B3%B5%EA%B0%9C%ED%96%88%EA%B8%B0%20%EB%95%8C%EB%AC%B8%EC%9D%B4%EB%8B%A4)). 일단 HSS 시스템 장악에 성공한 공격자는 루트 권한을 확보하여 리눅스용 백도어 **BPFDoor**를 해당 서버에 설치하고 실행함으로써 내부에 지속적으로 머무르며 추가 행동을 할 수 있는 거점을 마련했습니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B8%B0%EB%B0%98%20HSS%EC%97%90%20%EC%B9%A8%ED%88%AC%ED%95%B4,%EC%9D%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4%EB%A1%9C%20%EA%B3%B5%EA%B0%9C%ED%96%88%EA%B8%B0%20%EB%95%8C%EB%AC%B8%EC%9D%B4%EB%8B%A4)). 특히 BPFDoor는 2021년 PwC 보고서로 처음 존재가 밝혀진 **스텔스 백도어**로, 2017년 이후 수년간 탐지되지 않을 정도로 은밀하게 사용되어 온 악성코드입니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%EB%82%98%20%EC%86%94%EB%9D%BC%EB%A6%AC%EC%8A%A4%20%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84,PwC%20%EC%97%B0%EA%B5%AC%EC%A7%84%EC%97%90%20%EC%9D%98%ED%95%B4%20%EB%8B%A4%EC%8B%9C%20%EB%B0%9C%EA%B2%AC%EB%90%90%EB%8B%A4)). 공격자는 이러한 특성을 노려 BPFDoor를 HSS에 심어 **장기간 들키지 않고 내부망에 상주**하며 추가 정찰이나 데이터 유출을 시도했을 가능성이 높습니다.

### 1.2 백도어 설치 및 권한 유지 방식  
BPFDoor가 실행되면 우선 자신을 **메모리 상에 은닉**하기 위한 일련의 동작을 수행합니다. 외부에서 유입된 BPFDoor 바이너리를 `/dev/shm` 같은 메모리 기반 파일시스템 경로에 복사한 뒤 (`kdmtmpflush`라는 이름 사용) 원본 파일을 삭제하여 디스크 상의 흔적을 지웁니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=When%20BPFDoor%20is%20first%20executed%2C,no%20exception%20to%20the%20case)) ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)). 그런 다음 백도어 프로세스는 부모 프로세스를 종료하고 **`--init` 플래그로 포크(fork)된 자식 프로세스를 init(1) 프로세스의 자식으로 배치**하여, 프로세스 트리 상에서 고아 프로세스로 남게 됩니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1036%20%20,Masquerading%20%3A%20%2055)). 이를 통해 백도어 프로세스는 사용자의 세션이나 터미널에 연결되지 않아 **백그라운드 데몬**처럼 은밀히 실행될 수 있습니다. 또한 BPFDoor는 `prctl()`을 이용해 **프로세스 이름과 인자값을 교묘히 위조**합니다. 예를 들어 실행 중인 프로세스의 `argv[0]` 등을 변경하여 `/sbin/udevd -d`, `dbus-daemon --system`, `systemd-journald`와 같이 시스템의 정상 데몬 프로세스처럼 보이게 이름을 바꿉니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20overwrites%20the%20%60argv,journald%60.%5B1)). 이러한 **프로세스 위장(Masquerading)** 기법으로 관리자가 `ps` 명령 등으로 봤을 때 수상하지 않게 만들고, 심지어 동일한 이름의 합법적 프로세스가 이미 동작 중이면 **중복 발생으로 인한 단서를 흐리는 효과**도 기대합니다.  

BPFDoor는 **지속성(Persistence)** 확보를 위해 일반적으로 서비스나 부팅 스크립트에 자신을 등록하지는 않습니다. 대신 **서버 메모리에 상주**하며 **서버가 계속 가동되는 한 유지**되는 형태입니다 ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=Attack%20Lifecycle)). HSS와 같은 핵심 서버는 가동률이 높아 재부팅이 드문 점을 악용한 것으로, 시스템이 재시작되지 않는 이상 BPFDoor 프로세스는 메모리에서 사라지지 않아 지속적으로 공격자에게 뒷문을 제공했습니다 ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=Attack%20Lifecycle)). 만약 재부팅 등이 발생해 백도어 프로세스가 사라질 경우, 공격자는 동일한 초기 침투 경로나 다른 persistence 수법 (예: 크론 작업, Launch Daemon 등록 등)으로 재설치를 시도할 수 있습니다. 하지만 **디스크에 자체를 남기지 않고 메모리에만 존재**하도록 설계된 BPFDoor 특성상, 이번 SKT 사례에서도 디스크 포렌식으로는 악성 실행파일을 찾기 어려웠고 메모리 분석을 통해서만 존재가 드러났을 가능성이 큽니다.  

### 1.3 통신 (C2) 기법의 기술적 원리  
BPFDoor의 가장 눈에 띄는 특징은 **네트워크 통신 방식의 은밀성**입니다. 일반적인 백도어처럼 C2 서버에 주기적으로 접속하거나 포트를 열어 두는 대신, BPFDoor는 **리눅스 커널의 Berkeley Packet Filter(BPF)** 기능을 남용하여 **수동적으로 네트워크 패킷을 감시**합니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=BPFDoor%20abuses%20BPF%20to%20operate,stealthily%20on%20the%20infected%20system)). 백도어 프로세스는 실행 후 **원격 명령을 기다리며 BPF 필터**를 커널에 등록하는데, 이 필터는 사전에 정해둔 **“매직 바이트” 패턴**을 가진 패킷을 식별하는 역할을 합니다. 예컨대 BPFDoor가 등록한 필터는 **TCP 패킷에서 0x5293 값**을, UDP 패킷이나 ICMP Echo (핑) 패킷에서는 **0x7255 값**을 체크하도록 되어 있습니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=BPFDoor%20also%20utilizes%20BPF%20and,and%20ICMP%20protocol%E2%80%99s%20Echo%20Request)). 공격자는 이러한 매직 시그니처를 포함한 특수 패킷을 해당 서버로 보내 백도어를 깨워냅니다. 필터에 매칭되지 않는 트래픽은 무시되지만, **정해진 매직 바이트를 포함한 패킷**이 들어오면 BPFDoor는 이를 인식하여 공격자의 명령세션을 초기화합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20uses%20BPF%20bytecode,2)). 이 과정에서 BPFDoor는 여전히 **임의의 포트를 리슨(listen)하지 않으므로 방화벽이나 포트 스캐닝으로는 존재를 알아채기 어렵습니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=BPFDoor%20abuses%20BPF%20to%20operate,stealthily%20on%20the%20infected%20system))**.  

매직 패킷을 통해 명령이 전달되면 BPFDoor는 **포함된 “암호(passphrase)”와 명령 코드**를 해석하여 세 가지 동작 모드 중 하나를 실행합니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Command%20Password%20Feature%200%20pass,shell%202%20N%2FA%20%E2%80%9C1%E2%80%9D%20response)). 첫 번째 모드(명령 코드 0)는 패킷에 특정 암호(예: `"justforfun"`)가 포함된 경우로, 이때 BPFDoor는 패킷 내에 지정된 공격자 IP와 포트로 **즉시 역방향 연결(Reverse Shell)을 맺어** 공격자에게 대상 시스템의 셸 접근을 제공합니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)). 두 번째 모드(코드 1)는 패킷 암호가 `"socket"`인 경우로, BPFDoor가 **로컬에 새로운 포트를 열어(bind shell)** 공격자의 접속을 기다리는 모드입니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)). 이때도 백도어는 무작정 포트를 여는 것이 아니라, **`iptables` 방화벽 규칙을 동적으로 추가**하여 오직 공격자의 IP에서 오는 연결만 허용하고 해당 트래픽을 백도어 포트로 리다이렉트합니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=In%20the%20bind%20shell%20process%2C,that%20was%20added%20is%20removed)). 이렇게 함으로써 **불특정 외부에 포트가 노출되지 않도록 은폐**하고, 공격자가 접속을 완료하면 곧바로 임시로 추가했던 방화벽 규칙을 제거하여 흔적을 지웁니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=In%20the%20bind%20shell%20process%2C,that%20was%20added%20is%20removed)). 마지막으로 세 번째 동작(코드 2)은 인증 암호가 맞지 않을 경우로, 이때 BPFDoor는 응답으로 단지 **“1” 바이트**를 공격자에게 되돌려 보냅니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=password%20in%20the%20source%20code,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Command%20Password%20Feature%200%20pass,shell%202%20N%2FA%20%E2%80%9C1%E2%80%9D%20response)). 이 응답은 공격자 입장에서 해당 시스템에 BPFDoor가 **설치되어 실행 중임을 확인**하는 신호로 활용됩니다. 즉, 공격자는 무차별 패킷을 보내보거나 스캔함으로써 “1” 응답을 얻으면 목표 시스템에 이미 백도어가 심겨있음을 알 수 있고, 이후 올바른 암호를 사용해 본격적인 셸 세션을 열 수 있습니다. BPFDoor 프로토콜 자체는 **RC4 암호화나 자체 라이브러리 암호화**를 사용해 명령 데이터를 평문으로 보내지 않도록 설계되어 있어 분석과 탐지를 더욱 어렵게 합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1027%20%20,57)). 이러한 **맞춤형 통신 프로토콜** 덕분에 BPFDoor는 **전형적이지 않은 비표준 포트/프로토콜(ICMP 등)**을 통해 C2 통신을 수행하며, 트래픽 내용도 암호화되어 침입방지시스템(IPS)이나 보안 모니터링에 쉽게 걸리지 않습니다.

### 1.4 은폐 및 방어 회피 기법  
BPFDoor는 **다층적인 은폐 기법**으로 보안 솔루션과 관리자의 눈을 피합니다. 앞서 언급한 **포트 비개방 통신**과 **프로세스 위장** 외에도, 실행 시 **환경설정과 로그를 조작**하여 단서를 제거합니다. 예를 들어 셸 실행 이력이 남는 것을 막기 위해 프로세스 환경변수로 `HISTFILE` 등을 `/dev/null`로 설정하여 **명령 기록을 비활성화**합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20sets%20the%20,PID%3E%2Fenviron%60.%5B1)). 또한 실행 직후 `utimes()` 함수를 호출해 악성 파일의 타임스탬프를 조작(일명 **타임스템핑**)하여 파일 생성/변경 시각이 오래된 정상 파일처럼 보이게 위장합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)). BPFDoor 프로세스는 `SIGHUP` 등 특정 시그널들을 무시하도록 설정해 우발적인 종료나 디버깅을 어렵게 만들고 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20set%27s%20it%27s%20process%20to,2)), `/proc/<PID>/environ` 등의 프로세스 정보 영역도 지워 자신의 환경 변수나 실행 인자 흔적을 숨깁니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1070%20%20,51)).  

**파일 삭제와 자기은폐**도 핵심적인 회피 기법입니다. BPFDoor는 자신을 /dev/shm 등에 복제한 후 원본 악성파일을 즉시 삭제하여 디스크 상의 인디케이터(해시, 파일경로)를 제거합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)). 실행 중에도 `/dev/shm/kdmtmpflush (deleted)`와 같이 **삭제된 파일로서만 프로세스가 존재**하게 되어, 관리자가 파일 시스템을 살펴봐도 악성 파일을 찾기 어렵습니다. 이처럼 **디스크 무존재(fileless)** 특성과 **커널 레벨 패킷 훅킹**을 악용한 기법으로 인해, BPFDoor는 수년간 여러 시스템에 숨어있어도 탐지되지 않을 만큼 강력한 **방어 회피(Defense Evasion)** 능력을 보여줍니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%EB%82%98%20%EC%86%94%EB%9D%BC%EB%A6%AC%EC%8A%A4%20%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84,PwC%20%EC%97%B0%EA%B5%AC%EC%A7%84%EC%97%90%20%EC%9D%98%ED%95%B4%20%EB%8B%A4%EC%8B%9C%20%EB%B0%9C%EA%B2%AC%EB%90%90%EB%8B%A4)). SKT 사건에서도 백도어가 오랜 기간 눈치채이지 않고 HSS 내에 상주하면서 유심 데이터를 유출할 수 있었던 것은 이러한 은폐 기술 덕분이며, **“루트킷에 버금가는 스텔스성”**을 지닌 백도어로 평가됩니다 ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Introduction)).

## 2. BPFDoor의 작동 원리와 글로벌 공격 사례
### 2.1 BPFDoor의 일반적인 작동 원리  
BPFDoor는 주로 **리눅스(Linux) 및 솔라리스(Solaris)** 서버를 노리는 **백도어 악성코드**입니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%EB%82%98%20%EC%86%94%EB%9D%BC%EB%A6%AC%EC%8A%A4%20%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84,PwC%20%EC%97%B0%EA%B5%AC%EC%A7%84%EC%97%90%20%EC%9D%98%ED%95%B4%20%EB%8B%A4%EC%8B%9C%20%EB%B0%9C%EA%B2%AC%EB%90%90%EB%8B%A4)). 그 이름이 나타내듯 BPF(Berkeley Packet Filter) 기술을 악용하여 동작하므로, **일반 프로세스와 네트워크 연결의 관점에서 거의 보이지 않게 숨어있는 것이 특징**입니다. 전술한 바와 같이 BPFDoor는 감염된 시스템에서 **자신을 메모리에 상주**시키고, **매직 패킷** 수신 시에만 활동하는 **수동형 백도어(passive backdoor)**로 작동합니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=BPFDoor%20abuses%20BPF%20to%20operate,stealthily%20on%20the%20infected%20system)). 이러한 설계 목적은 **이미 침투에 성공한 시스템에 대한 재진입 통로**를 확보하는 데 있습니다 ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=In%20this%20research%20piece%2C%20we,or%20actively%20compromised%20target%20environment)) ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=BPFDoor%20is%20a%20backdoor%20payload,research%20post%20released%20last%20week)). 즉, 공격자가 초기 침입에 성공한 후 만일에 대비해 심어두는 **“비상 출입구”** 역할을 하는 것이 BPFDoor입니다. 일단 심어두면 평소에는 시스템 자원을 최소한만 사용하면서 조용히 대기하고, 나중에 필요할 때 (예: 다른 악성 페이로드가 삭제되거나 새로운 명령 수행 필요 시) **공격자에게 다시 진입할 수 있는 은밀한 채널**을 제공하게 됩니다 ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=BPFDoor%20is%20a%20backdoor%20payload,research%20post%20released%20last%20week)) ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=Attack%20Lifecycle)). BPFDoor는 **사전 공유된 암호**와 **커스텀 프로토콜**을 사용하므로, 공격자 이외에는 해당 백도어를 활성화하기 어렵습니다. 이러한 **동작 원리의 비대칭성** 때문에, 방어자는 백도어가 존재하는지 알아채기도 어렵고 심지어 알고도 쉽게 제거하기 힘든 난관에 직면하게 됩니다.

BPFDoor의 **내부 구조**를 살펴보면, 실행 단계에서 **자기복제 및 은폐**, **BPF 필터 설치**, **명령 처리 쓰레드 대기**의 순서로 이루어집니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=When%20BPFDoor%20is%20first%20executed%2C,no%20exception%20to%20the%20case)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)). BPF 필터는 앞서 언급한 특수 패킷을 식별하도록 조합된 **바이트코드 필터**로, 주로 SSH(22), HTTP(80), HTTPS(443) 포트의 수신 패킷을 가로채 그 내용에 매직 키가 있는지 검사합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20uses%20BPF%20bytecode,2)). 이러한 설계는 공격자가 마치 정상적인 웹 트래픽이나 SSH 접속 패킷인 양 위장한 특수 패킷을 보낼 수 있게 함으로써, **방화벽 및 침입탐지 시스템을 우회**하는 효과를 줍니다. BPFDoor가 매직 패킷을 감지하면 해당 패킷에서 **공격자 지정 IP/포트와 명령 코드, 패스프레이즈** 등을 추출한 후, **자식 프로세스를 포크하여 명령을 수행**하는 구조로 동작합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20uses%20BPF%20bytecode,2)). 한편 부모 프로세스는 그대로 BPF 필터를 유지한 채 백그라운드에 남아 추후 들어올 패킷을 계속 감시합니다. 이러한 방식으로 BPFDoor는 **하나의 프로세스로 상시 대기하면서도 필요한 순간에 여러 개의 세션을 동시에 처리**할 수도 있습니다.  

전반적으로 BPFDoor의 작동은 **최소한의 footprint로 최대한의 은밀성**을 확보하는 데 중점을 두고 있습니다. 디스크를 건드리지 않고, 네트워크에 흔적을 거의 남기지 않으며, 시스템 API 호출을 통한 행위도 제한적으로 수행하므로 행위기반 탐지에도 잘 걸리지 않습니다. 다만 백도어 자체는 **파일 다운로드/업로드, 키로깅, 자체 전파 등의 부가기능은 없고**, 어디까지나 **원격 쉘 통로** 역할에 충실합니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Command%20Password%20Feature%200%20pass,shell%202%20N%2FA%20%E2%80%9C1%E2%80%9D%20response)). 결국 BPFDoor의 파괴력은 이 백도어를 이용하는 **공격자의 능력**에 달려 있는데, 숙련된 APT 공격자라면 이 백도어를 통해 내부망을 장기간 은밀히 장악하고 필요한 모든 작업(예: 추가 악성코드 설치, 데이터베이스 조회, 데이터 탈취 등)을 수행할 수 있게 됩니다. SKT 사례에서도 BPFDoor 자체가 특별히 유심정보를 훔치는 기능을 갖춘 것이 아니라, 백도어를 통해 **공격자가 HSS 데이터베이스 쿼리 및 파일 유출 명령을 직접 내려** 유심 정보를 탈취한 것으로 보입니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B8%B0%EB%B0%98%20HSS%EC%97%90%20%EC%B9%A8%ED%88%AC%ED%95%B4,%EC%9D%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4%EB%A1%9C%20%EA%B3%B5%EA%B0%9C%ED%96%88%EA%B8%B0%20%EB%95%8C%EB%AC%B8%EC%9D%B4%EB%8B%A4)). BPFDoor는 그러한 **지능형 사이버간첩 활동**의 도구로 설계된 악성 플랫폼이라 할 수 있습니다.

### 2.2 중국 APT 그룹 연계 및 글로벌 공격 사례  
BPFDoor는 초기부터 **중국계 사이버 첩보 그룹**에 의해 활용된 정황이 짙습니다. 2021년 PwC의 위협 보고서에 따르면, 중국 해킹 그룹 **“레드멘션(Red Menshen)”**이 수년간 중동과 아시아 지역을 대상으로 BPFDoor를 사용해 왔음이 확인되었습니다 ([SKT 해킹에 中해커 주특기 백도어 악성코드…"주체 단정 어려워" | 연합뉴스](https://www.yna.co.kr/view/AKR20250424055300017#:~:text=match%20at%20L82%20%EB%B3%B4%EA%B3%A0%EC%84%9C%EC%97%90%20%EB%94%B0%EB%A5%B4%EB%A9%B4,%EA%B3%B5%EA%B2%A9%EC%97%90%20%EC%88%98%EB%85%84%EA%B0%84%20BPF%EB%8F%84%EC%96%B4%EB%A5%BC%20%EC%82%AC%EC%9A%A9%ED%95%B4%20%EC%99%94%EB%8B%A4)). 레드멘션은 해당 백도어에 패스프레이즈 `"justforfun"`을 사용하는 자체 변종을 사용했고, CrowdStrike 등에서는 이 백도어를 **“JustForFun” 백도어**로 부르기도 했습니다. 이후 2022년 경부터 BPFDoor 관련 정보가 공개되자, **다른 중국 APT 조직들도 이 도구를 공유**하거나 유사 기법을 채택하기 시작한 것으로 보입니다. 실제로 Mandiant의 보고에 의하면, 중국의 대표적인 해킹그룹 중 하나인 **APT41(일명 Winnti)**이 2022년에 남아시아 정부기관을 해킹하면서 BPFDoor를 사용한 사례가 포착되기도 했습니다 ([Stealth Mode: Chinese Cyber Espionage Actors Continue to Evolve Tactics to Avoid Detection | Mandiant | Google Cloud Blog](https://cloud.google.com/blog/topics/threat-intelligence/chinese-espionage-tactics#:~:text=,to%20APT15%2C%20APT25%2C%20and%20Ke3chang)). 이처럼 BPFDoor는 특정 그룹의 전유물이 아니라 **여러 위협 행위자가 활용하는 도구화된 백도어**로 진화하고 있습니다.

**주요 글로벌 공격 사례**를 살펴보면, **통신 분야**에서 두드러진 피해가 보고됩니다. 2021년 PwC 보고서 이후 각국 보안업체들은 BPFDoor의 활동을 추적해왔으며, **트렌드마이크로**는 2022~2023년 사이에 **한국, 홍콩, 미얀마, 말레이시아, 이집트 등**지의 **통신사, 금융기관, 소매기업**을 겨냥한 BPFDoor 공격이 다수 관찰되었다고 밝혔습니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=%ED%8A%B8%EB%A0%8C%EB%93%9C%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EB%8A%94%20%EC%B5%9C%EA%B7%BC%20%EB%B0%9C%EA%B0%84%ED%95%9C%20%EB%B3%B4%EA%B3%A0%EC%84%9C%EC%97%90%EC%84%9C%20%ED%95%9C%EA%B5%AD%EA%B3%BC,%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%20%ED%8A%B8%EB%9E%98%ED%94%BD%EC%97%90%20%EB%8C%80%ED%95%9C%20%EC%96%B8%EA%B8%89%EC%9D%B4%20%EC%9E%88%EB%8B%A4)). 특히 한국의 통신사들에 대한 시도가 이미 **2022년 7월과 12월**에도 있었으며, 이번 SKT 사례처럼 **대규모 가입자 정보 탈취**를 노린 정황이 있다고 분석되었습니다 ([SKT 해킹에 中해커 주특기 백도어 악성코드…"주체 단정 어려워" | 연합뉴스](https://www.yna.co.kr/view/AKR20250424055300017#:~:text=%EB%B3%B4%EC%95%88%20%EC%A0%84%EB%AC%B8%ED%9A%8C%EC%82%AC%20%ED%8A%B8%EB%A0%8C%EB%93%9C%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%20%EB%B3%B4%EA%B3%A0%EC%84%9C%EC%97%90%20%EB%94%B0%EB%A5%B4%EB%A9%B4,%EB%AF%B8%EC%96%80%EB%A7%88%2C%20%EB%A7%90%EB%A0%88%EC%9D%B4%EC%8B%9C%EC%95%84%2C%20%EC%9D%B4%EC%A7%91%ED%8A%B8%EC%97%90%EC%84%9C%20%EA%B3%B5%EA%B2%A9%EC%9D%B4%20%EA%B4%80%EC%B0%B0%EB%90%90%EB%8B%A4)). SKT 사건 발생 직전인 2025년 4월 초에도 Trend Micro는 BPFDoor의 **새로운 C2 컨트롤러**에 대한 분석을 공개하며, 이를 **중국 APT 그룹 “Earth Bluecrow” (레드멘션의 트렌드마이크로식 명칭)**의 소행으로 추정했습니다 ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=%2A%20BPFDoor%C2%A0is%20a%20state,attacks%20zero%20in%20on%20the)). 이 보고서에서 언급된 바와 같이, 해당 공격자들은 BPFDoor를 통해 뒷문을 열어놓은 뒤 **피해망 내부로 횡적으로 이동(lateral movement)**하며 보다 깊숙한 시스템 장악과 데이터 접근을 시도하는 등 **조직적인 사이버스파이 활동**을 벌여왔습니다 ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Micro%20tracks%20as%20Earth%20Bluecrow,Intrusion%20Prevention%20and%20Deep%20Discovery)) ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=movement%2C%20enabling%20attackers%20to%20enter,customers%20to%20protect%20them%20against)).

BPFDoor는 또한 **오픈소스로 소스코드가 유출**된 것으로 알려져, 최근에는 중국이 아닌 다른 주체도 이 악성코드를 활용할 가능성이 제기됩니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B8%B0%EB%B0%98%20HSS%EC%97%90%20%EC%B9%A8%ED%88%AC%ED%95%B4,%EC%9D%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4%EB%A1%9C%20%EA%B3%B5%EA%B0%9C%ED%96%88%EA%B8%B0%20%EB%95%8C%EB%AC%B8%EC%9D%B4%EB%8B%A4)). 실제로 2023년 이후 GitHub 등에 BPFDoor와 유사한 기능의 코드가 공개되어 연구 목적으로 분석이 이뤄졌고, 이를 토대로 **파생 악성코드**가 등장할 수 있습니다. 그러나 여전히 **주요 사용 사례는 중국 국가소행 공격**으로 평가되며, **사이버 첩보/스파이 활동 목적**이 대부분입니다 ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=%2A%20BPFDoor%C2%A0is%20a%20state,attacks%20zero%20in%20on%20the)). 피해 대상도 주로 **정보가치가 높은 정부, 통신, 첨단기술, 금융 분야**가 많습니다 ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=movement%2C%20enabling%20attackers%20to%20enter,customers%20to%20protect%20them%20against)). 예컨대 2021년에는 중동 지역 통신사들이 이 백도어에 당했고, 2022년에는 아시아의 여러 정부 및 기업망에서 발견되었습니다. 2024~2025년 들어 한국의 통신사가 연이어 표적이 된 것도 이러한 글로벌 캠페인의 연장선으로 보입니다. SKT 유심 정보 대량 유출 사건은 BPFDoor가 현실적으로 가한 피해 중 가장 대중의 주목을 받은 사례로, **전 국민 휴대폰 가입자 정보**가 표적이 되었다는 점에서 파급력이 컸습니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=SKT%EB%8A%94%2022%EC%9D%BC%20%EC%9C%A0%EC%8B%AC%20%EA%B4%80%EB%A0%A8%20%EC%A0%95%EB%B3%B4%EA%B0%80,%EC%BD%94%EB%93%9C%EA%B0%80%20BRF%EB%8F%84%EC%96%B4%EC%9D%BC%20%EA%B0%80%EB%8A%A5%EC%84%B1%EC%9D%B4%20%EB%86%92%EB%8B%A4%EB%8A%94%20%EA%B2%83%EC%9D%B4%EB%8B%A4)). 이처럼 BPFDoor는 전세계적으로 **은밀히 침투하여 기밀 데이터를 수집**하는 사이버 공격들의 공통 분모로 등장하고 있으며, **한국을 포함한 여러 국가의 핵심 인프라를 위협**하는 요소로 부상하고 있습니다.

## 3. BPFDoor 관련 MITRE ATT&CK 전술 및 기법 매핑
BPFDoor가 수행하거나 관련된 주요 행위를 MITRE ATT&CK 매트릭스에 따라 분석하면 다음과 같습니다 (※ **전술**: 공격단계, **기법**: 세부 수법):

- **초기 침투 (Initial Access)** – *취약점 악용 (Exploit Public-Facing Application, T1190)*: BPFDoor 자체는 초기 침투 수단이 아니지만, 공격자는 취약한 웹 서버나 VPN 장비 등 외부 서비스의 제로데이 취약점을 악용하여 HSS 서버 등 내부망에 첫 발을 들였을 가능성이 높습니다. 또한 *합법적 자격증명 악용 (Valid Accounts, T1078)* 기법도 추정되는데, 이를 통해 관리자 계정을 탈취한 뒤 정상 로그인하여 백도어를 설치했을 가능성도 있습니다 (실제 APT41 등은 보안장비 계정 탈취 후 BPFDoor 심기 사례가 있음 ([Stealth Mode: Chinese Cyber Espionage Actors Continue to Evolve Tactics to Avoid Detection | Mandiant | Google Cloud Blog](https://cloud.google.com/blog/topics/threat-intelligence/chinese-espionage-tactics#:~:text=,to%20APT15%2C%20APT25%2C%20and%20Ke3chang))). 초기 침투 자체는 BPFDoor의 기능 범위 밖이지만, 해당 악성코드를 배포하기 위한 현실 전술로서 이러한 MITRE 기법들이 고려됩니다.

- **실행 (Execution)** – *명령-Line 인터페이스 (Command-Line Interface, T1059.004)*: 공격자는 리눅스 쉘 상에서 `cp`, `chmod`, `rm` 등의 명령을 사용해 BPFDoor를 설치/실행했습니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=When%20BPFDoor%20is%20first%20executed%2C,no%20exception%20to%20the%20case)). 또한 BPFDoor 프로세스는 실행 후 스스로 `fork`와 `exec`를 수행하며 백그라운드에서 지속 실행됩니다. *시스템 서비스 등록 (Create or Modify System Process, T1543)*는 BPFDoor 자체에는 내장되지 않았으나, 공격자가 수동으로 root 권한 cron에 추가하거나 `rc.local` 등에 실행 스크립트를 넣어 영구화를 시도했을 가능성도 있습니다. BPFDoor 프로세스는 실행되면 자동으로 init의 자식으로 들어가는데, 이는 *프로세스 트리 위장 (Masquerading: Break Process Tree, **T1036.009**)*에 해당하며, 부모 프로세스를 종료해 자신을 고아 프로세스로 남김으로써 관리 콘솔에서 떼어놓는 기술입니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1036%20%20,Masquerading%20%3A%20%2055)).

- **지속성 (Persistence)** – BPFDoor는 설계상 *메모리 상주 백도어*이며, 일반적인 **지속성 기법**(예: 부팅시 자동실행)은 사용하지 않습니다 ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=Attack%20Lifecycle)). 따라서 MITRE에 정의된 전통적 지속성 기술 (예: *시스템 부팅 또는 로그인 실행, T1547* 등)은 직접 해당하지 않습니다. 다만, 공격자는 필요시 *시스템 서비스Hijacking (T1543)*이나 *스케줄링 작업 추가 (Scheduled Task/Job, T1053)* 등을 활용해 BPFDoor를 재부팅 후에도 재실행하도록 환경을 구축할 수 있습니다. 이번 SKT 사례에서는 서버가 장시간 재가동 없이 운영되었기에 메모리 상주만으로도 충분했겠지만, 일반적으로 공격자는 백도어 프로세스가 죽거나 시스템이 재시작되면 다른 수법으로 재침투하거나 추가 Persistence 기법을 병행할 수 있습니다. 즉, BPFDoor 자체로는 Persistence 전술에 큰 가담을 하지 않지만 **공격 지속성**을 위한 플랫폼으로 활용됩니다.

- **권한 상승 (Privilege Escalation)** – BPFDoor 설치 전제 조건으로 *루트 권한 획득*이 필요합니다. BPF 소켓 필터를 설치하려면 커널 레벨 권한(CAP_SYS_ADMIN 또는 root)이 필요하기 때문입니다. 따라서 공격자는 초기 침투 후 **루트 권한 획득**을 위해 *커널 취약점 악용 (Exploitation for Privilege Escalation, T1068)*이나 *자격 증명 덤프 후 재사용 (Credential Dump & Use)* 등을 수행했을 것입니다. 일단 루트가 된 이후 백도어를 심었으므로, BPFDoor 실행 자체는 이미 최고 권한으로 행해져 별도의 UAC 우회 등이 필요 없었습니다. 또한 BPFDoor는 자체적으로 *Setuid*나 *권한도용 (Token Impersonation)* 같은 기능은 사용하지 않습니다.

- **방어 회피 (Defense Evasion)** – BPFDoor의 핵심 전술로 여러 **기법**들이 동원됩니다:  
  - *파일 삭제 (Indicator Removal on Host: File Deletion, **T1070.004**)* – 백도어 실행 직후 원본 악성 파일을 삭제해 디스크 포렌식에 남지 않도록 합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)).  
  - *시간스탬프 위조 (Indicator Removal: Timestomp, **T1070.006**)* – `utimes()`로 파일의 생성/변경 시간을 조작해 수상한 최신 파일처럼 안 보이게 합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)).  
  - *로그 및 히스토리 삭제/비활성화 (Impair Defenses: Disable or Modify Logging, **T1562.003**)* – 환경변수 `HISTFILE` 등을 `/dev/null`로 지정해 shell 명령 이력을 남기지 않고, 프로세스 환경을 지워 사용자 활동 로그 추적을 어렵게 합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1562%20%20,Impair%20Defenses%20%3A%20%2049)).  
  - *프로세스 위장 (Masquerading: Rename or Overwrite Process Arguments, **T1036.011**)* – 악성 프로세스 이름을 리눅스 시스템 데몬처럼 바꾸고 실행 인자를 거짓으로 채워 `/proc` 상에 표시되는 정보를 속입니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20overwrites%20the%20%60argv,journald%60.%5B1)). 예를 들어 실제로는 백도어이지만 프로세스 목록에는 `dbus-daemon --system` 등으로 보이게 하는 식입니다.  
  - *프로세스 트리 숨기기 (Masquerading: Parent PID Spoofing, T1036.004 및 T1036.009)* – `--init` 인자를 통해 프로세스를 fork/exec하여 init 프로세스가 부모인 것처럼 가장합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1036%20%20,Masquerading%20%3A%20%2055)). 이로써 `pstree` 등을 보더라도 해당 프로세스가 어떤 프로세스에서 시작됐는지 추적하기 어렵습니다.  
  - *시스템 방화벽 우회 (Impair Defenses: Disable or Modify System Firewall, **T1562.004**)* – 필요 시 `iptables` 규칙을 조작하여 공격자 IP에 대해서만 문을 열고, 세션 연결 후에는 다시 닫는 식으로 방화벽을 일시적으로 무력화합니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=,Disable%20or%20Modify%20System%20Firewall)). 이는 백도어 통신이 외부 보안장비에 탐지되지 않도록 하고, 포렌식 시에도 방화벽 설정이 남지 않게 하는 교묘한 기법입니다.  

  이 외에도 BPFDoor는 *패킷 스니핑 (Network Sniffing, T1040)* 행위를 통해 자신을 숨기는데, 일반적으로 네트워크 인터페이스를 프로미스큐어스(promiscuous) 모드로 전환하여 패킷을 엿보므로, 인터페이스 동작을 모니터링하지 않는 이상 이런 은밀한 감시를 알 수 없습니다. 전반적으로 BPFDoor는 **Defense Evasion** 전술 하에 다수의 세부 기술을 조합하여 백신, EDR, IDS 등의 탐지를 피합니다 ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Introduction)).

- **발견 (Discovery)** – BPFDoor 자체는 내부 네트워크 스캔이나 시스템 정보 열람 등의 **발견 활동**을 수행하지 않습니다. 그러나 백도어를 통해 셸을 얻은 공격자가 후속 단계에서 *시스템 서비스 열람 (System Service Discovery, T1007)*, *네트워크 연결 조회 (System Network Connections Discovery, T1049)* 등을 실시하여 주변 환경을 파악할 수 있습니다. 이러한 행동은 BPFDoor의 고유 기능은 아니지만, 백도어를 활용한 공격자의 수동적 행동으로 MITRE 매핑에서는 연관될 수 있습니다.

- **이동 (Lateral Movement)** – BPFDoor는 감염된 시스템 한정으로 동작하지만, 공격자는 이 백도어를 거점 삼아 다른 시스템으로 이동할 수 있습니다. 예를 들어, *원격 서비스 실행 (Remote Services: SSH, T1021.004)* 등을 통해 횡적으로 다른 서버에 접근하거나, BPFDoor를 추가로 배포할 수 있습니다. 실제 Trend Micro 분석에서는 BPFDoor 컨트롤러를 사용해 **다른 시스템으로의 리버스 셸을 반복적으로 열어** 내부망 깊숙이 침투한 사례가 소개되었는데 ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Micro%20tracks%20as%20Earth%20Bluecrow,Intrusion%20Prevention%20and%20Deep%20Discovery)), 이는 MITRE 기법상 *원격 쉘을 통한 횡적이동*에 해당합니다. BPFDoor 그 자체는 웜처럼 자동 전파하진 않지만, APT 공격자는 수동으로 백도어를 여러대에 설치함으로써 내부망을 이동해갑니다.

- **명령 제어 (Command and Control)** – BPFDoor의 통신 방식은 **MITRE ATT&CK에 새롭게 추가된 기술 범주인 트래픽 시그널링(Traffic Signaling)**에 정확히 부합합니다. 구체적으로 *소켓 필터(Socket Filters)을 이용한 신호, **T1205.002*** 기법으로 분류되며, 이는 임의의 소켓에 필터를 걸어 특정 패턴의 트래픽을 신호로 사용하는 C2 방법입니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20uses%20BPF%20bytecode,2)). BPFDoor는 ICMP, TCP, UDP 등 **비표준 프로토콜 및 포트 (Non-Standard Port, T1571)**로 C2 통신을 수행하고, *애플리케이션 계층 프로토콜 위장 (Application Layer Protocol, T1071)*도 나타납니다. 예를 들어 HTTP 패킷에 숨겨진 명령을 쓰거나, Ping(ICMP) 패킷을 C2 신호로 사용하는 것은 **평범한 트래픽으로 가장**하는 기법입니다. 또한 통신 내용은 **RC4 기반**으로 암호화되거나 커스텀 인코딩되어 있어 *C2 통신 암호화(Encrypted Channel, T1573)* 측면도 있습니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1027%20%20,57)). 정리하면, BPFDoor는 **Command & Control 전술** 단계에서 **은밀한 통신 채널 구축**을 위해 다양한 기술들을 활용하며, 특히 **소켓 레벨 패킷 필터링**을 통한 C2 신호대기와 **역방향/바인드 셸 연결**이 주요 특징입니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Command%20Password%20Feature%200%20pass,shell%202%20N%2FA%20%E2%80%9C1%E2%80%9D%20response)).

- **수집/유출 (Collection/Exfiltration)** – BPFDoor 자체는 수집 및 유출 기능을 내장하지 않았지만, 백도어 세션을 통해 공격자가 임의의 명령을 실행함으로써 필요한 데이터 수집/탈취가 가능합니다. 예를 들어 SKT 사례에서 공격자는 BPFDoor로 열린 셸에서 HSS 데이터베이스 질의를 수행하고 가입자 정보를 파일로 덤프한 뒤, *데이터 압축 (Archive Collected Data, T1560)* 및 *외부로 전송(Exfiltration Over C2 Channel, T1041)*했을 것입니다. BPFDoor의 C2 채널(역방향 셸 자체)을 통해 바로 데이터를 빼돌렸거나, 별도 FTP/HTTP로 빼돌릴 수도 있습니다. MITRE 상에서는 *원격 접근 도구(Remote Access Tool, S0002 등)*로 분류되는 BPFDoor를 이용하여 공격자가 모든 후속 행동(TA0009~TA0011)을 수행할 수 있으므로, 결과적으로 **전체 공격 흐름을 지원하는 인프라**로 볼 수 있습니다. 다만 엄밀히 BPFDoor 소프트웨어가 자동으로 수행하는 것은 아니라는 점에서, 여기서는 공격자가 BPFDoor를 이용해 가능한 기법들을 간략히 언급합니다.

以上와 같이 BPFDoor는 주로 **방어 회피**, **명령제어** 영역의 기법을 복합적으로 구현한 백도어이며, MITRE ATT&CK 매핑을 통해 그 정교함을 확인할 수 있습니다. 특히 **Traffic Signaling (T1205)**과 **Masquerading (T1036)** 관련 기법들은 BPFDoor를 대표하는 행동이며, 이러한 매핑 정보를 토대로 보안 담당자들은 대응책을 마련할 수 있습니다.

## 4. BPFDoor 대응을 위한 보안 전략 (탐지, 분석, 차단, 사후 대응)
SKT 사태를 교훈삼아 **시스템 관리자 및 보안 운영팀(SOC)**은 BPFDoor 같은 은밀한 백도어에 대비한 고도화된 대응책을 마련해야 합니다. 아래에 **탐지**부터 **사후 대응**까지 단계별 심화 전략을 제시합니다.

### 4.1 네트워크 계층 모니터링 전략  
**① 비정상 트래픽 패턴 탐지:** BPFDoor는 일반적이지 않은 패턴의 패킷으로 C2 통신을 수행하므로, **IDS/IPS 및 NDR(Network Detection & Response)** 솔루션을 활용해 알려진 **매직 패킷 시그니처**를 탐지하도록 규칙을 설정해야 합니다. 예를 들어 트렌드마이크로는 자사 IPS 장비(TippingPoint 등)에 BPFDoor의 특이 트래픽 규칙을 업데이트하여 탐지할 수 있게 했습니다 ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=telecommunications%2C%20finance%2C%20and%20retail%20sectors%2C,protect%20them%20against%20this%20threat)). 보안 장비에서 **ICMP Echo 패킷의 비정형 페이로드**나, 평소 서비스하지 않는 포트(예: 42391~43391 사이 고포트)로의 TCP 연결 시도를 모니터링하면 BPFDoor의 활동 징후를 잡아낼 수 있습니다. 또한 **허용된 프로토콜 내 숨겨진 통신**을 찾아내기 위해 평상시 트래픽 베이스라인을 정립하고, **평소와 다른 패턴**(예: DNS나 HTTP로 위장한 임의 바이너리 데이터 전송 등)을 이상 행동으로 플래그해야 합니다.  

**② 공격자 제어 서버 및 IP 모니터링:** KISA가 이번 사건을 통해 공개한 **IOC 정보(IP, 해시)**를 내부 시스템 로그와 연계해 모니터링하는 것도 중요합니다 ([KISA "최근 사용된 악성코드 주의보"…SKT 해킹 악성파일 공개 | 연합뉴스](https://www.yna.co.kr/view/AKR20250425168300017#:~:text=%EA%B7%B8%EB%9F%AC%EB%A9%B4%EC%84%9C%20%EA%B3%B5%EA%B2%A9%20IP%EC%99%80%20%EC%95%85%EC%84%B1%20%EC%BD%94%EB%93%9C,%ED%95%B4%EC%8B%9C%EA%B0%92%20%EB%B0%8F%20%ED%8C%8C%EC%9D%BC%20%EC%A0%95%EB%B3%B4%EB%A5%BC%20%EA%B3%B5%EC%9C%A0%ED%96%88%EB%8B%A4)). BPFDoor 자체는 수동적이지만 일단 활성화되면 공격자 C2와 통신하기 때문에, 방화벽 로그나 프록시 로그에 **의심 IP로의 아웃바운드 접속**이 기록되었는지 확인해야 합니다. 특히 **내부 중요 서버(HSS 등)**에서 평소 접속하지 않을 외부 IP로의 TCP 세션이 있었다면 적극적으로 조사해야 합니다. 네트워크 흐름 가시화(NetFlow)나 트래픽 미러링을 통해 **은밀한 역방향 셸 연결**을 포착하는 것도 가능하며, EDR이 없다면 **네트워크 기반으로라도 이상 세션(예: 서버→인터넷 SSH 등)**을 찾아 차단하는 전략이 필요합니다.

**③ 세그멘테이션과 접근제어:** BPFDoor의 확산과 C2 통신을 차단하려면 **네트워크 세그멘테이션**을 강화해야 합니다. 핵심 서버는 인터넷과 직접 통신할 수 없도록 망분리를 철저히 하고, 필요한 경우에만 엄격한 프록시/게이트웨이를 통해서만 통신하도록 구성합니다. 만약 HSS 망이 외부망과 완전히 격리되어 있었다면, BPFDoor 역방향 접속도 실패했을 것입니다. 또한 **내부망 출구 팩트**에서 *ICMP 트래픽 필터링*을 검토합니다. 일반적으로 서버가 외부로 핑을 보낼 일은 드물므로, 내부 서버에서 오는 ICMP Echo Reply 등이 보인다면 이상 징후로 볼 수 있습니다. 방화벽에서 ICMP를 필요 최소한으로 제한하고, `iptables` 규칙 변경 시 관리 콘솔에 로그가 남도록 설정하는 것도 한 방법입니다.

**④ 함정 패킷 활용한 사전 탐색:** 고급 위협 헌팅 기법으로서, 보안팀은 자체적으로 **BPFDoor 트리거 패킷**을 만들어 내부 주요 서버들을 탐색해볼 수 있습니다. 예를 들어 의심 서버 대상으로 BPFDoor의 매직 바이트(0x5293 등)를 포함한 패킷을 보내보고, 응답으로 "1" 등이 돌아오는지 확인하는 것입니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=password%20in%20the%20source%20code,infection%20status%20from%20this%20information)). 이는 위험을 수반하므로 조심해야 하지만, 이미 알려진 패스프레이즈 (일부 샘플의 경우 "justforfun" 등)를 사용해 역으로 백도어 접속을 시도해볼 수도 있습니다. 이러한 **능동 탐지 기법**은 침해사고 조사 시 은밀히 설치된 BPFDoor를 색출하는 데 도움이 됩니다. 다만 실운영망에 임의 패킷을 보내는 것이므로 반드시 폐쇄망 테스트 환경에서 사전 검증 후 신중히 적용해야 합니다.

### 4.2 엔드포인트 포렌식 및 메모리 검사  
**① 프로세스 인디케이터 점검:** 서버 단에서 **이상 프로세스 징후**를 감지하는 것이 1차 방어입니다. 관리자는 정기적으로 **실행 중인 프로세스 목록과 시작 경로**를 점검하여, `\(deleted\)`로 표시된 실행 파일을 가진 프로세스가 없는지 확인해야 합니다. 리눅스에서는 `/proc/<PID>/exe` 심볼릭링크로 프로세스의 실행 파일 경로를 확인할 수 있는데, BPFDoor 감염 시 이 경로가 삭제된 파일을 가리키고 있을 것입니다 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)). 예를 들어 `ls -l /proc/*/exe | grep "(deleted)"` 등의 명령으로 메모리에만 존재하는 수상한 프로세스를 찾아낼 수 있습니다. 또한 `ps -ef` 출력에서 일반적 시스템 데몬이 *2개 이상* 떠 있거나, 부팅 시점에만 있어야 할 프로세스가 이상 시간에 생성돼 있는 경우 (예: `systemd-journald` 프로세스가 두 개 존재 등) 주의해야 합니다. BPFDoor는 10개의 정형화된 위장 이름 목록 중 하나를 사용하므로 ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20overwrites%20the%20%60argv,journald%60.%5B1)), 해당 프로세스명이 이중으로 나타나거나 해당 시스템 환경에 어울리지 않는 경우 의심 신호로 볼 수 있습니다.  

**② /dev/shm 및 메모리 상의 악성코드 탐지:** BPFDoor는 주로 `/dev/shm`나 `/tmp` 경로에 자신을 숨기므로, 이러한 디렉토리에서 **실행 권한이 부여된 파일**이 있는지, 수상한 파일명이 존재하는지 살펴봐야 합니다. 예컨대 `kdmtmpflush` 같은 생소한 이름의 바이너리가 발견되면 격리 분석을 진행합니다. 파일이 이미 삭제되었다면, **메모리 덤프 분석**으로 전환해야 합니다. 라이브 시스템에서 *메모리 포렌식*을 수행하려면 `gcore`를 이용해 의심 프로세스의 코어 덤프를 뜨거나, `/proc/<PID>/mem`를 dd로 덤프하는 방법 등이 있습니다. 이렇게 확보한 메모리 이미지에 대해 **YARA 룰**을 적용하여 BPFDoor의 known strings (예: "justforfun", iptables 명령 문자열, BPF 바이트코드 시퀀스 등) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=In%20the%20bind%20shell%20process%2C,that%20was%20added%20is%20removed))이 존재하는지 검색할 수 있습니다. 또한 AhnLab EDR 등에서 제공하는 **BPFDoor 전용 탐지 규칙**을 활용하면, 메모리 상 징후나 행위 기반으로 감염 여부를 식별할 수 있습니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=During%20its%20execution%2C%20BPFDoor%20is,of%20the%20behavior%20in%20advance)).  

**③ BPF 사용 여부 모니터링:** 시스템 콜 레벨에서 BPFDoor를 탐지하기 위해, **BPF 필터 등록 이벤트**나 **Raw Socket 생성 이벤트**를 추적하는 것도 가능합니다. 리눅스의 Auditd를 활용하면 `socket()` 및 `setsockopt()` 호출을 모니터링할 수 있는데, BPFDoor는 **AF_PACKET 소켓**을 생성하고 `SO_ATTACH_FILTER` 옵션을 지정하므로 이러한 호출을 Auditd가 기록하도록 설정할 수 있습니다. 정상 환경에서 일반 서버 프로세스가 이런 소켓을 열 일은 거의 없으므로, Audit 로그에 해당 이벤트가 포착되면 신속히 조사합니다. 또한 `bpftool` 같은 유틸리티로 시스템에 로드된 BPF 프로그램을 나열해볼 수 있으나, BPFDoor의 경우 classic BPF 필터를 소켓에 붙이는 것이라 `bpftool`에 나타나지 않을 수도 있습니다 (eBPF가 아니기 때문에). 대신 `tcpdump`를 이용해 인터페이스가 이미 누군가에 의해 장악되어 있는지 확인하거나, `ifconfig`로 인터페이스가 **PROMISC 모드**로 설정되어 있으면 누군가 패킷 스니핑 중임을 의심할 수 있습니다. 이러한 저수준 징후까지 모니터링하는 것은 어렵지만, **Host IDS**나 **EBPF 기반 모니터링 도구**를 사용하면 커널 단에서 이상 행위를 잡아낼 수 있습니다.

**④ 메모리 법의학과 디지털 포렌식:** 이미 침해 발생이 의심되거나 확인된 경우, **메모리 이미지와 디스크 이미지를 보존**하여 사후 forensic 분석을 수행합니다. BPFDoor는 메모리 상주형이므로 **전통적 디스크 포렌식으론 증거가 부족**합니다. 따라서 가능하면 Live 상태에서 메모리 이미징(Volatility 등 사용)을 하고, 해당 프로세스의 메모리를 추출해 리버스엔지니어링해야 공격자의 비밀번호 등 구체 정보를 얻을 수 있습니다. 포렌식 과정에서는 백도어를 통해 실행된 공격자 명령 기록을 재현하는 것도 중요한데, 비록 HISTFILE은 없지만 **.bash_history** 외에 **사설 이력(logging)**이 존재하지 않는지, 메모리의 셸 환경을 분석하거나, 네트워크 PCAP을 역추적하여 공격자가 어떤 SQL쿼리나 쉘 명령을 내렸는지 파악해야 합니다. 이를 통해 실제 **탈취된 데이터 범위**와 **공격자의 행동**을 재구성할 수 있습니다. 

### 4.3 커널 수준 후킹 및 루트킷 탐지 기법  
BPFDoor는 커널 모듈 형태의 루트킷은 아니지만, 그 활동이 **커널 레벨(packet filter)**에서 이뤄지므로 마치 루트킷처럼 동작합니다 ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Introduction)). 따라서 **커널 후킹 탐지 기술**도 병행하면 좋습니다. 예를 들어 **LiME(Linux Memory Extractor)** 등으로 커널 메모리를 덤프하여 비정상적인 훅이나 수정된 함수 포인터가 없는지 검사합니다. 혹은 OSSEC, chkrootkit, rkhunter 등의 **루트킷 스캐너**를 주기적으로 돌려 **PROMISC 모드 인터페이스**나 **비정상 커널 모듈**을 점검합니다. BPFDoor는 모듈을 삽입하지 않지만, 혹시 공격자가 추가로 **LD_PRELOAD 방식 인젝션**이나 **커널 모듈형 백도어**를 사용했을 수 있으므로 전반적인 루트킷 징후를 찾아야 합니다.  

**실시간 커널 모니터링**으로는 eBPF 기반 보안 모듈들을 활용할 수 있습니다. 예를 들어 Facebook의 **osquery**, Cilium의 **hubble**, 또는 Sysmon for Linux 등을 통해 프로세스 생성, 네트워크 연결, 파일 조작을 커널 단에서 수집/분석하면 BPFDoor의 은폐 행위도 간접적으로 드러날 수 있습니다. **커널 audit log**를 꼼꼼히 활성화하여 (예: `audit.rules`에 `-a exit,always -F arch=b64 -S socket -S setsockopt` 등 추가) BPFDoor와 같은 행위를 사전에 포착하는 운영 절차를 마련하는 것이 권장됩니다.

또 하나 고려할 점은, BPFDoor와 유사한 **기타 백도어**나 **변종 위협**에도 대비하는 것입니다. 커널 레벨 후킹 탐지는 BPFDoor뿐 아니라 다른 rootkit, DKOM(Direct Kernel Object Manipulation) 공격도 잡아낼 수 있으므로, 이러한 저수준 모니터링 체계를 구축해두면 전반적인 보안 수준이 향상됩니다.

### 4.4 차단 및 사후 대응 방안  
**① 대응 및 차단:** BPFDoor 감염이 확인되면, 우선 **해당 시스템을 격리(segmentation)** 해야 합니다. 네트워크를 분리하고 계정 로그인 세션을 차단하여 공격자의 추가 활동을 막습니다. 그 다음, **메모리 상 백도어 프로세스 종료** 및 관련 아티팩트 제거를 실시합니다. 단순히 프로세스를 죽이는 것에 그치지 말고, 백도어가 설치된 경로(`/dev/shm` 등)와 임시 방화벽 규칙까지 모두 검토하여 클린업합니다. 가능하다면 시스템을 **재부팅**하여 메모리 상 악성코드를 소거하고, 재부팅 후 동일 프로세스가 다시 등장하지 않는지 확인합니다. 동시에, **동일 네트워크내 다른 서버들**에도 유사 침입 흔적이 없는지 점검해야 합니다. APT 공격자는 여러 시스템에 백도어를 심어놓는 경향이 있으므로, 한 대에서 발견되었다면 전사적 스캔을 통해 추가 감염을 찾아내야 합니다.

**② 패치 및 취약점 봉쇄:** 침해사고 원인이 된 취약점이 밝혀졌다면 즉시 패치 적용 또는 대응 설정을 합니다. 예컨대 방화벽 장비나 웹 서버의 제로데이가 악용되었다면 해당 장비를 업데이트하고, 유사한 구성의 시스템에 가상 패치(IPS 룰 적용 등)라도 적용합니다. **계정 관리**도 필수인데, 공격에 사용된 계정(만약 내부자 계정이나 탈취된 VPN계정 등)이 있다면 즉시 비활성화하고 비밀번호를 변경합니다. 전체 관리자 계정에 대한 비밀번호 정책을 강화하고 2FA 도입을 검토해, 계정 재사용 공격을 차단합니다.

**③ 로깅 및 모니터링 개선:** BPFDoor 같은 위협을 조기에 발견하려면 **로그 체계**를 재정비해야 합니다. 서버의 보안로그(인증 시도, 시스템 변경 등)를 중앙 SIEM으로 모으고, 특히 *iptables 규칙 변경*, *PROMISC 모드 설정*, *프로세스 Crash 및 core dump 생성* 등의 이벤트도 수집하여 상관분석을 합니다. BPFDoor가 설정한 iptables 규칙은 세션 이후 삭제되지만, 시스템 **메세지 로그(syslog)** 등에 **iptables INSERT** 기록이 남았을 수 있으므로 이를 찾아냅니다. 또한 SSH 등의 **원격접속 로그**에 평소 없던 해외 IP가 일시적으로 찍혔다 사라진 경우도 단서가 될 수 있습니다. SKT 사례에서는 해커의 C2가 중국 등 해외로 추정되므로, 통신사 내부 시스템에 평소 접속하지 않던 해외 IP 기록이 있는지 살펴보는 식입니다.

**④ 보안 솔루션 도입:** 이번 사건을 계기로 **리눅스용 EDR/XDR** 도입 필요성이 대두되었습니다 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=%EB%AC%B8%EA%B4%91%EC%84%9D%20%ED%95%9C%EA%B5%AD%EC%A0%95%EB%B3%B4%EA%B3%B5%ED%95%99%EA%B8%B0%EC%88%A0%EC%82%AC%ED%9A%8C%20%EB%AF%B8%EB%9E%98%EC%9C%B5%ED%95%A9%EA%B8%B0%EC%88%A0%EC%9B%90%EC%9E%A5%EC%9D%80%20%E2%80%9CKISA%20%EA%B3%B5%EC%A7%80%EC%97%90%EC%84%9C,%EC%A7%84%ED%96%89%ED%95%A0%20%EA%B2%83%EC%9D%84%20%EA%B6%8C%EA%B3%A0%ED%95%98%EA%B3%A0%20%EC%9E%88%EB%8B%A4%E2%80%9D%EA%B3%A0%20%EB%A7%90%ED%96%88%EB%8B%A4)). 서버 단말에 **행위기반 탐지(Behavior Detection)** 기능을 제공하는 EDR을 설치하면, BPFDoor의 이상 행위(예: `/dev/shm` 실행, 프로세스 이름 변경 등)를 실시간 차단하거나 경고할 수 있습니다. 또한 메모리 포렌식 기능이 있는 EDR이라면, 악성코드가 메모리에만 있더라도 탐지가 가능합니다 ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=During%20its%20execution%2C%20BPFDoor%20is,of%20the%20behavior%20in%20advance)). 조직 차원에서 예산을 확보해 이러한 **서버 보안 솔루션**을 구축하는 것도 장기적 대응 전략입니다. 트렌드마이크로나 안랩 같은 보안업체에서 BPFDoor 탐지 룰을 제공하고 있으므로, 기존 솔루션(SIEM, IPS 등)에 해당 시그니처를 추가 적용하는 작업도 진행해야 합니다.

**⑤ 사후 포렌식 및 재발 방지:** 사고 수습 후에는 **심층적인 원인 분석과 재발 방지 대책** 수립이 이뤄져야 합니다. 디지털 포렌식 결과를 바탕으로 공격 타임라인, 유출 데이터의 범위, 공격자 TTP를 문서화하고, 이를 경영진 및 관련 부서에 전파합니다. 필요하면 고객 통지 등 법적 대응도 수행하며, 유심 교체와 같은 사용자 보호조치를 진행합니다 (SKT는 전 고객 대상 USIM 무료 교체를 진행하였습니다). 기술적으로는 **침해사고 대응 플레이북**을 업데이트하여, 유사한 BPF 기반 백도어 징후 발견 시 어떻게 조치할지 절차를 마련합니다. 또한 보안팀 역량 강화를 위해 BPFDoor 샘플을 이용한 **모의훈련**을 실시, EDR/관제 시스템이 이를 잡아내고 대응하는지 테스트합니다. 마지막으로, **정보 공유**를 통해 얻은 교훈을 업계와 나누는 것도 중요합니다. 이번 사건에서도 KISA가 관련 정보를 공지하고 업계에 자체 점검을 권고하였듯이 ([KISA, SKT 해킹 악성코드 공개...보안 점검 권고](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B8%B0%EB%B0%98%20HSS%EC%97%90%20%EC%B9%A8%ED%88%AC%ED%95%B4,%EC%9D%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4%EB%A1%9C%20%EA%B3%B5%EA%B0%9C%ED%96%88%EA%B8%B0%20%EB%95%8C%EB%AC%B8%EC%9D%B4%EB%8B%A4)), 발견된 IoC와 공격 기법을 공유함으로써 전체적인 방어 수준을 높일 수 있습니다.

## 5. 결론 및 제언  
SKT 유심 해킹 사건은 **은밀한 리눅스 백도어인 BPFDoor**가 국내 중요 인프라를 노린 사례로 큰 충격을 주었습니다. BPFDoor의 **공격 원리**는 커널 단의 패킷 필터링과 프로세스 위장을 통해 **“보이지 않는 문”**을 만들어 놓는 것이며, **글로벌 APT 공격자들**이 수년간 활용해온 고도기술입니다. 이번 사례를 통해 조직들은 기존의 윈도우 중심 보안대책에서 나아가 **리눅스 서버 보안**과 **네트워크 모니터링**의 중요성을 재인식해야 합니다. 기술적으로는 MITRE ATT&CK 매핑을 참고한 다층 방어전략을 수립하고, **선제적 탐지와 신속 대응 체계**를 갖추는 것이 요구됩니다. 특히 **메모리 상주 악성코드**에 대한 포렌식 능력과, **커널 행위 가시성** 확보가 새로운 보안과제로 떠오르고 있습니다. 앞으로도 BPFDoor와 유사한 **스텔스 멀웨어**에 대비하여 보안팀은 지속적으로 최신 정보를 학습하고, 시스템 취약점 관리와 이상행위 모니터링을 강화해야 할 것입니다. **“보이지 않는 백도어”**라도 결국 흔적은 남기 마련이므로, 사람과 기술이 결합된 면밀한 보안 운영으로 이러한 위협을 탐지·차단하고 소중한 고객정보를 지켜내는 데 만전을 기해야겠습니다. 

