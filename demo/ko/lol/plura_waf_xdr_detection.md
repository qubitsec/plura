PLURA-WAF와 PLURA-XDR은 **웹셸 공격 및 파일리스 공격**을 탐지하기 위해 다양한 보안 기법과 탐지 메커니즘을 활용합니다. 아래는 각각의 시스템에서 이 공격을 탐지하는 방법입니다.

---

## **PLURA-WAF에서의 탐지 방법**

PLURA-WAF는 웹 트래픽을 실시간으로 모니터링하고, 웹셸 및 파일리스 공격을 탐지하기 위해 다음과 같은 기능을 제공합니다:

### **1. 웹 요청 패턴 분석**
- **비정상적인 HTTP 요청 탐지**:
  - HTTP 메서드 (POST, GET)와 비정상적인 URL 패턴을 분석.
  - 웹셸 업로드 시 사용되는 멀티파트 요청(`Content-Type: multipart/form-data`)을 식별.
  - 예: 업로드된 파일 이름이 `.php`, `.asp`, `.jsp` 등의 스크립트 파일일 경우 경고.
- **특정 문자열 필터링**:
  - 공격에 자주 사용되는 PHP 코드 (`<?php system(...) ?>`, `eval()`, `base64_decode()`)를 탐지.

### **2. 파일 업로드 정책 적용**
- 파일 크기, 확장자 제한, 업로드 경로 등을 기준으로 차단.
- 업로드된 파일이 실행 가능한 스크립트일 경우 업로드를 차단하거나 경고.

### **3. 웹 트래픽 상관 분석**
- 특정 IP 또는 사용자 세션에서 반복적인 요청(파일 업로드, 명령 실행 등)을 식별.
- 예: 동일한 클라이언트 IP가 짧은 시간에 다수의 파일 업로드 또는 명령 실행 요청을 수행하면 의심스러운 활동으로 간주.

### **4. 시그니처 기반 탐지**
- OWASP Top 10 공격 유형(예: 파일 업로드 취약점, XSS, SQLi)에 대한 시그니처를 사용해 웹셸 업로드 및 실행을 차단.

### **5. 동적 행위 기반 탐지**
- 업로드된 파일의 동작을 분석하여 웹셸 실행 여부를 확인.
  - 업로드된 파일이 실행될 경우, 의심스러운 명령 실행(ex: `cmd.exe`, `ls`)을 모니터링.

---

## **PLURA-XDR에서의 탐지 방법**

PLURA-XDR은 웹서버 및 전체 네트워크 환경에서 발생하는 보안 이벤트를 종합적으로 분석하여 파일리스 공격 및 웹셸 실행을 탐지합니다:

### **1. 로그 수집 및 상관 분석**
- **서버 로그 수집**:
  - Apache, NGINX, IIS 등 웹 서버의 액세스 로그와 에러 로그를 실시간 수집.
  - 웹셸 관련 비정상적인 URL 요청(`webshell.php?cmd=` 등)을 탐지.
- **SIEM 연동**:
  - 수집된 로그를 SIEM과 연동하여 의심스러운 활동의 패턴을 분석.
  - 예: 동일한 클라이언트에서 반복적으로 발생하는 명령 실행 요청.

### **2. 파일리스 공격 탐지**
- **프로세스 행위 모니터링**:
  - PowerShell, WMIC, mshta 등의 비정상적인 실행 여부를 감지.
  - 파일리스 공격에서 사용되는 명령(`IEX`, `DownloadString`, `Remove-Item`)이 실행되면 경고.
- **메모리 분석**:
  - 파일이 없는 상태에서 실행되는 악성 스크립트를 메모리 내에서 탐지.
  - 명령 실행 시 생성된 프로세스 정보를 분석하여 비정상적인 행위를 식별.

### **3. MITRE ATT&CK 기반 탐지**
- T1059 (Command and Scripting Interpreter), T1218 (Signed Binary Proxy Execution) 등 MITRE ATT&CK 기술을 기반으로 한 공격 시나리오 탐지.
- 예: 공격자가 `mshta`를 통해 HTA 파일을 실행한 후 추가 악성 코드를 다운로드할 경우 이를 실시간으로 탐지.

### **4. 위협 인텔리전스 연계**
- PLURA-XDR은 알려진 악성 웹셸 패턴, 공격 IP, 도메인 정보를 Threat Intelligence(TI) 데이터와 비교하여 실시간 탐지.
- 예: `malicious.com`과 같은 악성 URL 요청이 발생하면 자동 차단.

### **5. 사용자 정의 규칙**
- 관리자가 특정 파일 경로, 명령어, HTTP 요청 패턴 등을 기반으로 탐지 규칙을 설정.
- 예: 특정 URL 패턴(`/upload.php`, `/cmd.php`)이 감지되면 즉시 알림 및 차단.

---

## **탐지 후 대응**

1. **PLURA-WAF**:
   - 비정상 요청을 차단하고 관리자에게 알림.
   - 의심스러운 파일 업로드를 검토하고 자동 삭제.

2. **PLURA-XDR**:
   - 실시간 경고를 통해 보안 팀에 알림.
   - 의심스러운 프로세스 및 네트워크 연결을 즉시 차단.
   - 탐지된 이벤트를 기반으로 공격 시나리오를 재구성하여 상세 보고 제공.

---

이 두 시스템의 통합 운영으로 파일리스 및 웹셸 공격에 대해 높은 탐지율과 신속한 대응이 가능합니다.
