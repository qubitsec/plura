## 📊 로그 발생량 비교 분석 보고서

**기본 OS vs PLURA 에이전트 + Sysmon**

---

## 1️⃣ 테스트 개요 🧪

본 테스트는 **동일한 공격 시나리오** 하에서
**기본 OS 환경**과 **PLURA 에이전트 + Sysmon 설치 환경** 간
**로그 생성량 및 가시성(분석 가능성)의 차이**를 비교·분석하기 위해 수행되었다.

### 🎯 테스트 목적

* 동일 공격 발생 시 **로그 생성량 차이** 확인
* 공격 행위에 대한 **탐지 깊이 및 분석 가능성** 비교
* “로그 폭증” 여부가 아닌, **유의미한 보안 로그 증가(가시성 확보)** 여부 검증

---

## 2️⃣ 테스트 환경 🖥️

### 대상 장비

* IIS 웹 서버 2대

### 서버 구성

| 구분       | IP             | 구성                     |
| -------- | -------------- | ---------------------- |
| 기본 OS 서버 | `172.16.13.46` | Windows 기본 OS          |
| 비교 서버    | `172.16.13.47` | PLURA V6 에이전트 + Sysmon |

### Sysmon 설정

* Sysmon 설정 파일 경로(디렉터리):

```
https://github.com/QubitSecurity/EDR/tree/main/Windows/sysmon/server
```

* (권장) 실제 적용한 XML 파일(raw)도 보고서에 함께 명시 필요
  ※ 예: 초기 메모에 기재된 raw XML 주소 등

---

## 3️⃣ 테스트 시나리오 및 일정 ⏱️

### 시나리오 1: 랜섬웨어 공격

* 🦠 사용 랜섬웨어: **MINT 랜섬웨어**
* SHA256:

```
c38528988753e516f48614342c2963e0721d32186ff0ffcdae4547b9e41a4afd
```

* 테스트 시간: **12/16 09:50 ~ 09:53**
  ※ (필요 시) 계획 시간과 실제 실행 시간이 다를 경우 함께 표기 권장

### 시나리오 2: 웹 공격

* 테스트 시간: **12/16 10:10 ~ 10:30**
* 공격 유형:

  1. 웹쉘 업로드
  2. SST Injection
  3. SQL Injection
     (Post-body 기반 공격 위주)

---

## 4️⃣ 로그 수집 및 확인 방법 🔍

### 기본 OS 서버

1. **Windows Event Log(주요 채널) 이벤트 수 카운트**

* PowerShell 스크립트를 이용해 특정 시간대 주요 채널의 이벤트 수를 카운트

📂 대상 채널:

* Security
* System
* Application
* Microsoft-Windows-Sysmon/Operational *(기본 OS에는 보통 N/A)*
* Microsoft-Windows-PowerShell/Operational
* Microsoft-Windows-Windows Defender/Operational

2. **IIS W3C Access 로그 확인**

* IIS Access 로그는 요청당 1라인(1엔트리)로 남으며,
* 단순 접속/요청 정보 중심으로 기록됨(본문(Post-body) 등은 기본적으로 제한적)

### PLURA 에이전트 + Sysmon

* **V6 LIVE 콘솔**에서 동일 시간 구간으로 필터링하여 로그 수 확인

---

## 5️⃣ 테스트 결과 📈

### 🔴 1. 랜섬웨어 공격 테스트 결과

#### 로그 발생 수 비교

| 구분                  |    로그 발생 수 |
| ------------------- | ---------: |
| 기본 OS               |    **53건** |
| PLURA 에이전트 + Sysmon | **1,244건** |

📌 해석 시 주의

* 위 수치는 “동일 단위의 완전한 동등 비교”라기보다,
  **기본 OS에서 확보 가능한 기록량/가시성**과 **PLURA+Sysmon에서 확보 가능한 행위 기반 기록량/가시성**의 격차를 보여준다.

📌 차이점 요약

* **기본 OS**

  * 로그가 존재하더라도(예: IIS Access 로그/일반 이벤트),
  * 공격 행위를 **재구성할 수 있는 핵심 데이터(프로세스·파일·행위 흐름)**가 부족하여
    **공격 전·중·후 흐름 파악이 어려움**
* **PLURA + Sysmon**

  * 프로세스 생성, 파일 생성·변조 등 **행위 단위 로그**가 확보되어
  * **행위 연쇄 관계(Log Chain)** 기반 분석 가능

⚠️ 특이사항(범위/한계)

* 테스트 당시 **V6에서 EDR 기능이 아직 완전 동작하지 않아**,
  예: 허니팟 기반 전원 OFF 등의 **능동 대응 동작은 미확인/미적용**
* 본 결과는 **대응 성능 비교가 아니라 로그 가시성/기록량 비교 결과**임

---

### 🌐 2. 웹 공격 테스트 결과

#### ① 웹쉘 업로드 공격

**기본 OS**

* IIS Access 로그 **1건**
* Post-body, 업로드 파일 내용 등 **상세 정보 미존재(또는 제한적)**

**PLURA 에이전트 + Sysmon**

* Post-body 기록 확인
* 업로드 파일이 작고 인코딩 처리가 없을 경우
  👉 **파일 내부 명령어까지 식별 가능**

#### ② SST Injection 공격

**기본 OS**

* IIS Access 로그 **1건**
* 공격 페이로드 식별 불가(접속 기록 수준)

**PLURA 에이전트 + Sysmon**

* 탐지 확인
* Post-body 기반 **공격 내용 확인 가능**

#### ③ SQL Injection 공격

**기본 OS**

* IIS Access 로그 **1건**
* 단순 요청 기록만 존재

**PLURA 에이전트 + Sysmon**

* SQL Injection 탐지
* Post-body 확인 가능
* 파라미터·쿼리 구조 분석 가능

※ 참고

* 웹 로그 상세 확인은 환경에 따라 **V6 → V5로 옮겨 추가 확인 예정**인 경우,
  보고서에 “추가 검증 항목”으로 명시 권장

---

## 6️⃣ 종합 분석 🧠

### 6-1) ⚠️ 로그 착시와 제1종 오류

이번 테스트에서 특히 주목해야 할 부분은
“**로그가 존재하는 것처럼 보이지만, 실제로는 분석 가능한 정보가 거의 없는 상태**”가
운영자에게 **심각한 판단 오류**를 유발한다는 점이다.

#### 🔍 기본 OS의 53건 로그가 주는 착시

* 기본 OS에서 확인되는 로그는 종종 **IIS Access 로그/일반 이벤트 수준**에 머물며,
* 요청 시각, URL, 응답 코드 등 **형식적 기록**은 남더라도,

  * **의도**
  * **실제 입력값(Post-body)**
  * **파일 생성·변조**
  * **프로세스 실행 흐름**
    같은 **공격 재구성의 핵심 정보가 빠지는 경우**가 많다.

👉 그럼에도 “로그가 있다”는 사실만으로 **‘분석 가능하다’고 착각**하게 된다.

#### 🧠 제1종 오류(Type I Error, 거짓 양성)에 빠지는 구조

이 상황은 전형적인 **거짓 양성(제1종 오류)**을 유발한다.

> ❗ “로그가 있으니, 기록은 남아 있다”
> ❗ “그런데 분석해 보니 아무 것도 없다”

그 결과 다음과 같은 **잘못된 추론**이 반복된다.

* “해커가 로그를 지우고 간 것 아닐까?”
* “고급 공격이라 흔적이 남지 않은 것 같다”
* “파일리스 공격이라 로그가 없었던 것 같다”

그러나 실제 원인은 단순하다.
📌 **처음부터 기록되지 않았을 뿐이다.**

#### 📉 이 착각이 누적되어 온 결과

이러한 착시는 결국,

* 로그의 **양(quantity)**과
* 로그의 **의미(quality)**
  를 구분하지 못하게 만들었고,

우리가 “로그를 제대로 이해하지 못했다”는 문제의 핵심 원인이 되어 왔다.

---

### 6-2) 📌 핵심 비교 포인트

| 항목        | 기본 OS | PLURA + Sysmon |
| --------- | ----- | -------------- |
| 로그 수      | 매우 적음 | 공격 행위에 비례      |
| 공격 가시성    | 거의 없음 | 행위 단위로 확인      |
| Post-body | ❌     | ✅              |
| 포렌식 활용성   | 낮음    | 매우 높음          |
| 대응 자동화 기반 | 불가    | 가능             |

---

## 7️⃣ 결론 ✅

* **PLURA 에이전트 + Sysmon 환경은** 단순히 “로그가 많아지는” 것이 아니라,
  🔍 **공격이 발생했을 때 반드시 필요한 행위 기반 로그가 생성되어 분석 가능성이 급격히 증가**한다.
* **기본 OS 환경은** “로그가 있다”는 착시를 만들 수 있으나,
  실제로는 침해를 입증·재구성할 핵심 데이터가 부족해 **사후 분석 신뢰도가 낮다.**
* 본 테스트는 “로그 폭증”이 아니라, **보안 가시성과 대응 가능성의 격차**를 보여주는 비교 실험으로 판단된다.

📎 요약 한 줄

> **공격은 동일했지만, 로그는 ‘존재 여부’가 아니라 ‘분석 가능성’에서 완전히 갈렸다.**

---
