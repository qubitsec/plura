## 📊 로그 발생량 비교 분석 보고서

**(기본 OS vs PLURA 에이전트 + Sysmon)**

---

## 1️⃣ 테스트 개요 🧪

본 테스트는 **동일한 공격 시나리오** 하에서  
**기본 OS 환경**과 **PLURA 에이전트 + Sysmon 설치 환경** 간  
**로그 생성량 및 가시성 차이**를 비교·분석하기 위해 수행되었다.

### 🎯 테스트 목적

* 동일 공격 발생 시 **로그 생성량 차이** 확인
* 공격 행위에 대한 **탐지 깊이 및 분석 가능성** 비교
* “로그 폭증” 여부가 아닌, **유의미한 보안 로그 증가 여부** 검증

---

## 2️⃣ 테스트 환경 🖥️

### 서버 구성

| 구분       | IP             | 구성                     |
| -------- | -------------- | ---------------------- |
| 기본 OS 서버 | `172.16.13.46` | Windows 기본 OS          |
| 비교 서버    | `172.16.13.47` | PLURA V6 에이전트 + Sysmon |

👉 [Sysmon 설정 파일](https://github.com/QubitSecurity/EDR/tree/main/Windows/sysmon/server)

---

## 3️⃣ 테스트 시나리오 및 일정 ⏱️

### 시나리오 1: 랜섬웨어 공격

* 🦠 사용 랜섬웨어: **MINT 랜섬웨어**
* SHA256:

  ```
  c38528988753e516f48614342c2963e0721d32186ff0ffcdae4547b9e41a4afd
  ```
* 테스트 시간:

  * **12/16 09:50 ~ 09:53**

### 시나리오 2: 웹 공격

* 테스트 시간:

  * **12/16 10:10 ~ 10:30**
* 공격 유형:

  *  웹쉘 업로드
  * SST Injection
  * SQL Injection
     (Post-body 기반 공격 위주)

---

## 4️⃣ 로그 수집 및 확인 방법 🔍

### 기본 OS 서버 로그 카운트 방식

PowerShell 스크립트를 이용해  
**특정 시간대 주요 이벤트 채널 로그 수를 직접 카운트**하였다.

📂 대상 채널:

* Security
* System
* Application
* Microsoft-Windows-Sysmon/Operational
* Microsoft-Windows-PowerShell/Operational
* Microsoft-Windows-Windows Defender/Operational

> 해당 스크립트로 **공격 시간 구간에 생성된 이벤트 수**를 비교

👉 [PowerShell 스크립](https://github.com/QubitSecurity/EDR/blob/main/Windows/Event-Channel/count-logs.md)

### PLURA 에이전트 + Sysmon

* **PLURA 콘솔**에서 시간 범위 지정 후 로그 수 확인

---

## 5️⃣ 테스트 결과 📈

### 🔴 1. 랜섬웨어 공격 테스트 결과

#### 로그 발생 수 비교

| 구분                  | 로그 발생 수    |
| ------------------- | ---------- |
| 기본 OS               | **53건**    |
| PLURA 에이전트 + Sysmon | **1,244건** |

📌 **차이점 요약**

* **기본 OS**:

  * 단순 이벤트 로그 위주
  * 공격 전·중·후 흐름 파악 불가

* **PLURA + Sysmon**:

  * 프로세스 생성
  * 파일 생성·변조
  * 행위 연쇄 관계(Log Chain) 확인 가능

---

### 🌐 2. 웹 공격 테스트 결과

#### ① 웹쉘 업로드 공격

**기본 OS**

* Access 로그 **1건**
* Post-body, 파일 내용 정보 **미존재**

**PLURA 에이전트 + Sysmon**

* Post-body 기록 확인
* 업로드 파일 크기가 작고 인코딩되지 않아  
  👉 **파일 내부 명령어까지 식별 가능**

---

#### ② SST Injection 공격

**기본 OS**

* Access 로그 **1건**
* 공격 페이로드 식별 불가

**PLURA 에이전트 + Sysmon**

* 공격 탐지 확인
* Post-body 기반 **공격 내용 명확히 확인**

---

#### ③ SQL Injection 공격

**기본 OS**

* Access 로그 **1건**
* 단순 요청 기록만 존재

**PLURA 에이전트 + Sysmon**

* SQL Injection 탐지
* Post-body 확인 가능
* 파라미터·쿼리 구조 분석 가능

---

## ⚠️ 로그 착시(Log Illusion)와 제1종 오류(Type I Error)

이번 테스트에서 특히 주목해야 할 부분은  
“**로그가 존재하는 것처럼 보이지만, 실제로는 분석 가능한 정보가 거의 없는 상태**”가  
운영자에게 **심각한 판단 오류**를 유발한다는 점이다.

### 🔍 기본 OS의 53건 로그의 실체

* 기본 OS에서 확인된 **53건의 로그는**

  * 대부분 **IIS 웹 서버의 Access 로그**
  * 요청 시각, URL, 응답 코드 수준의 **형식적 기록**에 불과함
* 공격 행위의

  * **의도**
  * **실제 입력값(Post-body)**
  * **파일 생성·변조**
  * **프로세스 실행 흐름**
    는 전혀 포함되지 않음

👉 그럼에도 불구하고
**“로그가 있다”는 사실 자체가 착각을 유발**한다.

---

### 🧠 제1종 오류(Type I Error)에 빠지는 구조

이 구간은 단순한 기술적 한계 문제가 아니라,  
운영자가 결정을 내릴 때 합리적·객관적 판단을 방해하는 심리적 경향, 즉  
**사이버 보안 인지 편향**(Security Cognitive Biases)과 결합되며 더 위험해진다.

> **Security Cognitive Biases**  
> “결정을 내릴 때 합리적이고 객관적인 판단을 방해하는 다양한 심리적 경향”

이 상황은 전형적인 **제1종 오류(Type I Error)** 를 만든다.

> ❗ *“로그가 있으니, 기록은 남아 있다”*  
> ❗ *“그런데 분석해 보니 아무 것도 없다”*

이로 인해 다음과 같은 **잘못된 추론**이 반복적으로 발생한다.

* “해커가 로그를 지우고 간 것 아닐까?”
* “고급 공격이라 흔적이 남지 않은 것 같다”
* “파일리스 공격이라 로그가 없었던 것 같다”

그러나 실제 원인은 전혀 다르다.

📌 **처음부터 기록되지 않았을 뿐이다.**

---

### 📉 이 착각이 누적되어 온 결과

이러한 로그 착시는,

* 로그의 **양(quantity)** 과
* 로그의 **의미(quality)** 를 구분하지 못하게 만들었고,

결과적으로 우리는 오랫동안 다음과 같은 오해 속에 있었다.

> “**우리는 로그를 보고 있다**”  
> ➤ ❌ 사실은 **보고 싶은 최소한의 형식만 보고 있었을 뿐**

> “**침해 흔적이 없다**”  
> ➤ ❌ 사실은 **침해를 증명할 수 있는 로그 자체가 없었다**

---

### ✅ PLURA + Sysmon 환경이 다른 이유

PLURA 에이전트 + Sysmon 환경에서는  
이러한 **제1종 오류가 구조적으로 발생하지 않는다.**

* 로그가 많기 때문에 의미가 있는 것이 아니라
* **행위 단위로 반드시 남기기 때문에**

  * 분석이 가능하고
  * 공격 흐름이 복원되며
  * “없어서 못 보는” 상황이 발생하지 않는다

즉,

> 🔐 **PLURA는 로그를 ‘보이게’ 하는 도구가 아니라  
> 로그를 ‘의미 있게’ 만드는 체계다.**

---

## 6️⃣ 종합 분석 🧠

### 📌 핵심 비교 포인트

| 항목        | 기본 OS | PLURA + Sysmon |
| --------- | ----- | -------------- |
| 로그 수      | 매우 적음 | 공격 행위에 비례      |
| 공격 가시성    | 거의 없음 | 행위 단위로 확인      |
| Post-body | ❌     | ✅              |
| 포렌식 활용성   | 낮음    | 매우 높음          |
| 대응 자동화 기반 | 불가    | 가능             |

---

## 7️⃣ 결론 ✅

✔ **PLURA 에이전트 + Sysmon 환경은**
단순히 “로그가 많아지는” 것이 아니라,

> 🔍 **공격이 발생했을 때 반드시 필요한 로그가 생성됨**

✔ 기본 OS 환경은

* “공격이 있었다”는 사실조차 입증하기 어려움

✔ 본 테스트는
**로그 폭증 여부가 아닌, 보안 가시성과 대응 가능성의 차이를 명확히 보여주는 실험**으로 판단됨

---

📎 **요약 한 줄**

> **공격은 동일했지만,  
> 로그는 ‘존재 여부’ 수준과 ‘분석 가능성’ 수준으로 완전히 갈렸다.**

---
