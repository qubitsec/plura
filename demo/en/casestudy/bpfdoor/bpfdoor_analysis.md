We will provide a comprehensive overview of BPFDoor's general operating mechanisms and various attack cases, focusing on the BPFDoor attack related to the SKT incident. This will include in-depth response strategies for system administrators and security operations teams.

# Analysis of the SKT USIM Hacking Incident and BPFDoor Malware

## 1. Analysis of BPFDoor Malware Used in the SKT Incident
### 1.1 Attack Method and Internal Infiltration Route  
It was confirmed that the attacker infiltrated the **SK Telecom Home Subscriber Server (HSS)** and planted the `BPFDoor` backdoor ([KISA, SKT hacking malware disclosed... security inspection recommended](https://m.boannews.com/html/detail.html?idx=137004#:~:text=SKT%EB%8A%94%2022%EC%9D%BC%20%EC%9C%A0%EC%8B%AC%20%EA%B4%80%EB%A0%A8%20%EC%A0%95%EB%B3%B4%EA%B0%80,%EC%BD%94%EB%93%9C%EA%B0%80%20BRF%EB%8F%84%EC%96%B4%EC%9D%BC%20%EA%B0%80%EB%8A%A5%EC%84%B1%EC%9D%B4%20%EB%86%92%EB%8B%A4%EB%8A%94%20%EA%B2%83%EC%9D%B4%EB%8B%A4)) ([KISA "Warning on Recently Used Malware"... SKT hacking malware disclosed | Yonhap News](https://www.yna.co.kr/view/AKR20250425168300017#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%B0%B1%EB%8F%84%EC%96%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A1%9C%202021%EB%85%84%20PWC%EC%82%AC%EC%9D%98,%EC%B5%9C%EC%B4%88%EB%A1%9C%20%EC%95%8C%EB%A0%A4%EC%A7%84%20%EC%82%AC%EC%9D%B4%EB%B2%84%20%EA%B3%B5%EA%B2%A9%20%EC%88%98%EB%B2%95%EC%9D%B4%EB%8B%A4)). The HSS is a core server that manages subscriber phone numbers, IMSI, **USIM data**, and communication service authentication. The attacker is believed to have taken over this server to steal a large amount of subscriber information. The initial intrusion method is suspected to be a common **APT attack** technique (e.g., exploiting zero-day vulnerabilities, stealing administrator credentials), and although not clearly disclosed, **a Chinese hacking group** is suspected of employing sophisticated **Advanced Persistent Threat (APT)** tactics ([KISA, SKT hacking malware disclosed... security inspection recommended](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B8%B0%EB%B0%98%20HSS%EC%97%90%20%EC%B9%A8%ED%88%AC%ED%95%B4,%EC%9D%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4%EB%A1%9C%20%EA%B3%B5%EA%B0%9C%ED%96%88%EA%B8%B0%20%EB%95%8C%EB%AC%B8%EC%9D%B4%EB%8B%A4)). 

Once the attacker successfully took control of the HSS system, they obtained root privileges and installed and executed the **BPFDoor** Linux backdoor on the server, securing a persistent foothold to maintain presence and conduct further actions ([KISA, SKT hacking malware disclosed... security inspection recommended](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B8%B0%EB%B0%98%20HSS%EC%97%90%20%EC%B9%A8%ED%88%AC%ED%95%B4,%EC%9D%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4%EB%A1%9C%20%EA%B3%B5%EA%B0%9C%ED%96%88%EA%B8%B0%20%EB%95%8C%EB%AC%B8%EC%9D%B4%EB%8B%A4)). Notably, BPFDoor is a **stealth backdoor** first revealed in a 2021 PwC report and is known for its ability to remain undetected for years since around 2017 ([KISA, SKT hacking malware disclosed... security inspection recommended](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%EB%82%98%20%EC%86%94%EB%9D%BC%EB%A6%AC%EC%8A%A4%20%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84,PwC%20%EC%97%B0%EA%B5%AC%EC%A7%84%EC%97%90%20%EC%9D%98%ED%95%B4%20%EB%8B%A4%EC%8B%9C%20%EB%B0%9C%EA%B2%AC%EB%90%90%EB%8B%A4)). The attacker likely leveraged these characteristics to implant BPFDoor into the HSS and **reside in the internal network undetected for an extended period**, potentially conducting further reconnaissance or data exfiltration.

### 1.2 Backdoor Installation and Persistence Mechanism  
When BPFDoor is executed, it first performs a series of actions to **hide itself in memory**. It copies the BPFDoor binary—received from an external source—to a memory-based filesystem path such as `/dev/shm` (using the name `kdmtmpflush`) and then deletes the original file to erase traces from disk ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=When%20BPFDoor%20is%20first%20executed%2C,no%20exception%20to%20the%20case)) ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)). 

Next, the backdoor process terminates its parent process and uses the `--init` flag to **fork itself as a child of the init(1) process**, effectively becoming an orphan process in the process tree ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1036%20%20,Masquerading%20%3A%20%2055)). This allows the backdoor to run stealthily in the background like a **daemon**, not tied to any user session or terminal. BPFDoor also uses `prctl()` to **manipulate the process name and arguments**. For example, it changes `argv[0]` of the running process to appear as legitimate system daemon processes such as `/sbin/udevd -d`, `dbus-daemon --system`, or `systemd-journald` ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20overwrites%20the%20%60argv,journald%60.%5B1)). 

This **masquerading** technique helps the backdoor avoid suspicion when viewed with commands like `ps`, and if a legitimate process with the same name is already running, it may **obfuscate detection by creating confusion due to duplication**.

BPFDoor typically does not register itself as a service or in boot scripts to maintain **persistence**. Instead, it remains **resident in memory**, **persisting as long as the server stays online** ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=Attack%20Lifecycle)). This takes advantage of high uptime on core systems like HSS, where reboots are rare. Unless the system is restarted, the BPFDoor process does not disappear from memory, continuously providing a backdoor for the attacker ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=Attack%20Lifecycle)). If a reboot does occur and the backdoor process is terminated, the attacker may attempt reinstallation through the same initial access vector or via other persistence methods (e.g., cron jobs, Launch Daemon registration). However, due to BPFDoor's design to **exist only in memory without leaving traces on disk**, in the SKT case, it was likely difficult to detect the malicious executable through disk forensics, and its presence could only be revealed via memory analysis.

### 1.3 Technical Principles of C2 Communication  
The most notable feature of BPFDoor is the **stealthiness of its network communication method**. Unlike typical backdoors that periodically connect to a C2 server or keep a port open, BPFDoor **abuses the Linux kernel's Berkeley Packet Filter (BPF)** functionality to **passively monitor network packets** ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=BPFDoor%20abuses%20BPF%20to%20operate,stealthily%20on%20the%20infected%20system)). After execution, the backdoor process **registers a BPF filter** in the kernel to wait for remote commands. This filter is configured to detect packets containing a pre-defined **“magic byte” pattern**. For instance, BPFDoor’s filter checks for the value **0x5293 in TCP packets** and **0x7255 in UDP or ICMP Echo (ping) packets** ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=BPFDoor%20also%20utilizes%20BPF%20and,and%20ICMP%20protocol%E2%80%99s%20Echo%20Request)). The attacker sends special packets with these magic signatures to the server to activate the backdoor. Traffic not matching the filter is ignored, but when a **packet containing the magic bytes** arrives, BPFDoor recognizes it and initializes a command session from the attacker ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20uses%20BPF%20bytecode,2)). During this process, BPFDoor still **does not listen on any port**, making it extremely difficult to detect via firewalls or port scans ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=BPFDoor%20abuses%20BPF%20to%20operate,stealthily%20on%20the%20infected%20system)).

When a magic packet is received, BPFDoor parses the **embedded passphrase and command code**, and executes one of three operating modes ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Command%20Password%20Feature%200%20pass,shell%202%20N%2FA%20%E2%80%9C1%E2%80%9D%20response)). The first mode (command code 0) is triggered if the packet includes a specific passphrase (e.g., `"justforfun"`), in which case BPFDoor **immediately establishes a reverse shell** to the attacker’s IP and port specified in the packet, granting shell access to the victim system ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)).

The second mode (command code 1) is when the packet passphrase is `"socket"`, prompting BPFDoor to **bind a new local port (bind shell)** and wait for the attacker’s connection ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)). Even in this case, the backdoor doesn’t openly expose the port; instead, it **dynamically adds an `iptables` firewall rule** that only allows connections from the attacker’s IP and redirects the traffic to the backdoor port ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=In%20the%20bind%20shell%20process%2C,that%20was%20added%20is%20removed)). Once the connection is made, the temporary firewall rule is immediately removed to erase traces ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=In%20the%20bind%20shell%20process%2C,that%20was%20added%20is%20removed)).

The third mode (command code 2) is triggered when the passphrase is incorrect. In this case, BPFDoor simply **returns a single “1” byte** to the attacker ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=password%20in%20the%20source%20code,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Command%20Password%20Feature%200%20pass,shell%202%20N%2FA%20%E2%80%9C1%E2%80%9D%20response)). This response serves as a signal to the attacker that BPFDoor is **installed and actively running** on the target system. In other words, the attacker can send brute-force packets or scan targets, and if a “1” is returned, it indicates the presence of BPFDoor, allowing the attacker to proceed with the correct passphrase to open a full shell session.

The BPFDoor protocol is also designed to **encrypt command data using RC4 or custom libraries**, preventing plaintext transmission and making detection and analysis more difficult ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1027%20%20,57)). This **custom communication protocol** allows BPFDoor to perform C2 communications through **non-standard ports/protocols (e.g., ICMP)**, with encrypted traffic that **easily evades intrusion prevention systems (IPS) and security monitoring tools**.

### 1.4 Concealment and Evasion Techniques  
BPFDoor evades detection by security solutions and administrators through **multi-layered stealth techniques**. In addition to previously mentioned methods like **portless communication** and **process masquerading**, it also manipulates **environment variables and logs** during execution to remove traces. For instance, to prevent shell command history from being logged, it sets environment variables like `HISTFILE` to `/dev/null`, effectively **disabling command logging** ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20sets%20the%20,PID%3E%2Fenviron%60.%5B1)). Immediately after execution, it calls the `utimes()` function to alter the timestamps of the malicious file (a technique known as **timestomping**) to make it appear as an old, legitimate file ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)).

BPFDoor also configures the process to ignore specific signals like `SIGHUP`, making it harder to terminate or debug ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20set%27s%20it%27s%20process%20to,2)), and it deletes information in areas like `/proc/<PID>/environ` to **hide traces of its environment variables and execution arguments** ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1070%20%20,51)).

**File deletion and self-concealment** are also key evasion techniques. BPFDoor duplicates itself to locations like /dev/shm, then immediately deletes the original malicious file, eliminating disk-based indicators (hashes, file paths) ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)). During execution, it appears as a process linked to a deleted file, such as `/dev/shm/kdmtmpflush (deleted)`, making it **difficult for administrators to locate the malicious file via filesystem inspection**. This **fileless** nature and **kernel-level packet hooking** make BPFDoor an exceptionally potent tool for **defense evasion**, often remaining undetected on systems for years ([KISA and SKT Disclose Hacking Malware... Security Inspection Recommended](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%EB%82%98%20%EC%86%94%EB%9D%BC%EB%A6%AC%EC%8A%A4%20%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84,PwC%20%EC%97%B0%EA%B5%AC%EC%A7%84%EC%97%90%20%EC%9D%98%ED%95%B4%20%EB%8B%A4%EC%8B%9C%20%EB%B0%9C%EA%B2%AC%EB%90%90%EB%8B%A4)).

In the SKT incident, the backdoor was able to **reside undetected within the HSS system for an extended period**, leaking USIM data thanks to these stealth capabilities. BPFDoor is often regarded as a **stealth tool on par with rootkits** ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Introduction)).

## 2. How BPFDoor Works and Global Attack Cases
### 2.1 General Operating Principle of BPFDoor  
BPFDoor is a **backdoor malware** that mainly targets **Linux and Solaris** servers ([KISA, SKT Hacking Malware Disclosure... Security Inspection Advisory](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%EB%82%98%20%EC%86%94%EB%9D%BC%EB%A6%AC%EC%8A%A4%20%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84,PwC%20%EC%97%B0%EA%B5%AC%EC%A7%84%EC%97%90%20%EC%9D%98%ED%95%B4%20%EB%8B%A4%EC%8B%9C%20%EB%B0%9C%EA%B2%AC%EB%90%90%EB%8B%A4)). As the name suggests, it leverages BPF (Berkeley Packet Filter) technology, making it **almost invisible from normal process or network monitoring**. As previously described, BPFDoor resides **in memory on an infected system** and operates as a **passive backdoor**, only becoming active when receiving a **magic packet** ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=BPFDoor%20abuses%20BPF%20to%20operate,stealthily%20on%20the%20infected%20system)). Its purpose is to **secure a re-entry point** into systems already compromised ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=In%20this%20research%20piece%2C%20we,or%20actively%20compromised%20target%20environment)) ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=BPFDoor%20is%20a%20backdoor%20payload,research%20post%20released%20last%20week)). In other words, BPFDoor acts as a **“backdoor escape hatch”** implanted by the attacker in case their initial access is lost. Once planted, it idles quietly, consuming minimal resources, and can later provide a **stealthy channel for reentry** when needed (e.g., if another payload is deleted or new commands must be executed) ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=BPFDoor%20is%20a%20backdoor%20payload,research%20post%20released%20last%20week)) ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=Attack%20Lifecycle)). Using **pre-shared passphrases** and a **custom protocol**, only the attacker can activate the backdoor. This **asymmetry in operation** makes it extremely difficult for defenders to detect or remove BPFDoor, even if they know it's present.

The **internal architecture** of BPFDoor consists of three main phases: **self-replication and concealment**, **BPF filter installation**, and **waiting for command threads** ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=When%20BPFDoor%20is%20first%20executed%2C,no%20exception%20to%20the%20case)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)). The BPF filter is a **bytecode filter** configured to identify special packets, usually intercepting packets targeting ports like SSH (22), HTTP (80), and HTTPS (443) to check for embedded magic keys ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20uses%20BPF%20bytecode,2)). This design allows attackers to disguise malicious packets as normal web or SSH traffic, thereby **bypassing firewalls and intrusion detection systems**. Upon detecting a magic packet, BPFDoor extracts **attacker-designated IP/port, command codes, and passphrases** and then **forks a child process** to execute commands ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20uses%20BPF%20bytecode,2)). Meanwhile, the parent process remains in the background, maintaining the BPF filter and continuing to monitor incoming traffic. This mechanism allows BPFDoor to **stay idle as a single process and spin up multiple sessions as needed**.

Overall, BPFDoor emphasizes **maximum stealth with minimal footprint**. It avoids disk usage, leaves barely any network traces, and performs limited system API calls, making it hard to detect even with behavior-based tools. Notably, the backdoor lacks **additional features such as file transfer, keylogging, or self-propagation**, and is purely dedicated to providing a **remote shell** ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Command%20Password%20Feature%200%20pass,shell%202%20N%2FA%20%E2%80%9C1%E2%80%9D%20response)). Ultimately, BPFDoor’s destructive power depends on the **attacker’s capabilities**. Skilled APT actors can use it to maintain prolonged covert control over a network and carry out operations such as **deploying additional malware, querying databases, and exfiltrating data**. In the SKT case, BPFDoor itself did not have a dedicated function to steal USIM data. Instead, it appears that the attacker **issued database query and file extraction commands via the backdoor** to exfiltrate USIM information ([KISA, SKT Hacking Malware Disclosure... Security Inspection Advisory](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B8%B0%EB%B0%98%20HSS%EC%97%90%20%EC%B9%A8%ED%88%AC%ED%95%B4,%EC%9D%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4%EB%A1%9C%20%EA%B3%B5%EA%B0%9C%ED%96%88%EA%B8%B0%20%EB%95%8C%EB%AC%B8%EC%9D%B4%EB%8B%A4)). BPFDoor can be described as a malicious platform built for **sophisticated cyber espionage operations**.

### 2.2 Connection to Chinese APT Groups and Global Attack Cases  
BPFDoor has long been suspected of being utilized by **Chinese cyber-espionage groups**. According to PwC's 2021 threat report, the Chinese hacking group **"Red Menshen"** had been using BPFDoor for years to target countries in the Middle East and Asia ([SKT Hacking Involves Chinese Hackers’ Signature Backdoor Malware…"Difficult to Identify the Actor" | Yonhap News](https://www.yna.co.kr/view/AKR20250424055300017#:~:text=match%20at%20L82%20%EB%B3%B4%EA%B3%A0%EC%84%9C%EC%97%90%20%EB%94%B0%EB%A5%B4%EB%A9%B4,%EA%B3%B5%EA%B2%A9%EC%97%90%20%EC%88%98%EB%85%84%EA%B0%84%20BPF%EB%8F%84%EC%96%B4%EB%A5%BC%20%EC%82%AC%EC%9A%A9%ED%95%B4%20%EC%99%94%EB%8B%A4)). Red Menshen reportedly used a customized version of this backdoor, embedding the passphrase `"justforfun"`, and security firms like CrowdStrike dubbed it the **“JustForFun” backdoor**. After BPFDoor information became public around 2022, **other Chinese APT groups began adopting or sharing the tool**, or developing similar techniques. In fact, Mandiant reported that **APT41 (aka Winnti)**—a well-known Chinese hacking group—used BPFDoor in a 2022 breach targeting South Asian government agencies ([Stealth Mode: Chinese Cyber Espionage Actors Continue to Evolve Tactics to Avoid Detection | Mandiant | Google Cloud Blog](https://cloud.google.com/blog/topics/threat-intelligence/chinese-espionage-tactics#:~:text=,to%20APT15%2C%20APT25%2C%20and%20Ke3chang)). Thus, BPFDoor is evolving from being a tool of a specific group to a **modular backdoor used by multiple threat actors**.

**Major global attack cases** show significant damage in the **telecommunications sector**. Since PwC's 2021 report, global security firms have been tracking BPFDoor activity. **Trend Micro** observed a surge in BPFDoor attacks between 2022 and 2023, targeting **telecom providers, financial institutions, and retail companies** in **South Korea, Hong Kong, Myanmar, Malaysia, and Egypt** ([KISA, SKT Hacking Malware Disclosure... Security Inspection Advisory](https://m.boannews.com/html/detail.html?idx=137004#:~:text=%ED%8A%B8%EB%A0%8C%EB%93%9C%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EB%8A%94%20%EC%B5%9C%EA%B7%BC%20%EB%B0%9C%EA%B0%84%ED%95%9C%20%EB%B3%B4%EA%B3%A0%EC%84%9C%EC%97%90%EC%84%9C%20%ED%95%9C%EA%B5%AD%EA%B3%BC,%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%20%ED%8A%B8%EB%9E%98%ED%94%BD%EC%97%90%20%EB%8C%80%ED%95%9C%20%EC%96%B8%EA%B8%89%EC%9D%B4%20%EC%9E%88%EB%8B%A4)). Specifically, attacks against Korean telecom companies were detected as early as **July and December 2022**, and there are signs that the SKT case also involved a **massive subscriber data exfiltration** ([SKT Hacking Involves Chinese Hackers’ Signature Backdoor Malware…"Difficult to Identify the Actor" | Yonhap News](https://www.yna.co.kr/view/AKR20250424055300017#:~:text=%EB%B3%B4%EC%95%88%20%EC%A0%84%EB%AC%B8%ED%9A%8C%EC%82%AC%20%ED%8A%B8%EB%A0%8C%EB%93%9C%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%20%EB%B3%B4%EA%B3%A0%EC%84%9C%EC%97%90%20%EB%94%B0%EB%A5%B4%EB%A9%B4,%EB%AF%B8%EC%96%80%EB%A7%88%2C%20%EB%A7%90%EB%A0%88%EC%9D%B4%EC%8B%9C%EC%95%84%2C%20%EC%9D%B4%EC%A7%91%ED%8A%B8%EC%97%90%EC%84%9C%20%EA%B3%B5%EA%B2%A9%EC%9D%B4%20%EA%B4%80%EC%B0%B0%EB%90%90%EB%8B%A4)). Just before the SKT breach in early April 2025, Trend Micro released an analysis of BPFDoor’s **new C2 controller**, attributing the operation to **Chinese APT group “Earth Bluecrow”**—Trend Micro's codename for Red Menshen ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=%2A%20BPFDoor%C2%A0is%20a%20state,attacks%20zero%20in%20on%20the)). According to this report, the attackers used BPFDoor to **establish backdoor access, move laterally**, and conduct **deep infiltration and data exfiltration**, engaging in highly **organized cyber-espionage campaigns** ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Micro%20tracks%20as%20Earth%20Bluecrow,Intrusion%20Prevention%20and%20Deep%20Discovery)) ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=movement%2C%20enabling%20attackers%20to%20enter,customers%20to%20protect%20them%20against)).

BPFDoor’s **source code is also believed to have leaked** into the public domain, raising concerns that non-Chinese actors might now leverage the malware as well ([KISA, SKT Hacking Malware Disclosure... Security Inspection Advisory](https://m.boannews.com/html/detail.html?idx=137004#:~:text=BPF%EB%8F%84%EC%96%B4%EB%8A%94%20%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B8%B0%EB%B0%98%20HSS%EC%97%90%20%EC%B9%A8%ED%88%AC%ED%95%B4,%EC%9D%B4%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4%EB%A1%9C%20%EA%B3%B5%EA%B0%9C%ED%96%88%EA%B8%B0%20%EB%95%8C%EB%AC%B8%EC%9D%B4%EB%8B%A4)). Since 2023, BPFDoor-like tools have been found on platforms like GitHub for research purposes, which could lead to **derivative malware**. However, **the primary usage is still attributed to Chinese state-sponsored campaigns**, with **cyber espionage as the main objective** ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=%2A%20BPFDoor%C2%A0is%20a%20state,attacks%20zero%20in%20on%20the)). Most targets are entities with **high-value information**, such as **governments, telecoms, high-tech industries, and financial institutions** ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=movement%2C%20enabling%20attackers%20to%20enter,customers%20to%20protect%20them%20against)). For instance, telecom providers in the Middle East were hit in 2021, and several government and corporate networks in Asia were compromised in 2022. The continued targeting of Korean telecoms in 2024–2025 appears to be part of this broader global campaign. The **SKT USIM data breach** was one of the most publicized real-world BPFDoor attacks, drawing attention due to the **sheer volume of subscriber data** involved ([KISA, SKT Hacking Malware Disclosure... Security Inspection Advisory](https://m.boannews.com/html/detail.html?idx=137004#:~:text=SKT%EB%8A%94%2022%EC%9D%BC%20%EC%9C%A0%EC%8B%AC%20%EA%B4%80%EB%A0%A8%20%EC%A0%95%EB%B3%B4%EA%B0%80,%EC%BD%94%EB%93%9C%EA%B0%80%20BRF%EB%8F%84%EC%96%B4%EC%9D%BC%20%EA%B0%80%EB%8A%A5%EC%84%B1%EC%9D%B4%20%EB%86%92%EB%8B%A4%EB%8A%94%20%EA%B2%83%EC%9D%B4%EB%8B%A4)). In this way, BPFDoor has become a **common denominator in global cyberattacks aimed at covertly collecting sensitive data**, increasingly posing a threat to the **critical infrastructure of countries like South Korea**.

## 3. MITRE ATT&CK Tactics and Techniques Mapping Related to BPFDoor
When analyzing the major activities performed or associated with BPFDoor based on the MITRE ATT&CK matrix, the following observations can be made (※ **Tactics**: attack stages, **Techniques**: specific methods):

- **Initial Access** – *Exploit Public-Facing Application (T1190)*: While BPFDoor itself is not an initial access tool, attackers likely exploited zero-day vulnerabilities in external services such as web servers or VPN devices to initially breach internal systems like HSS servers. The use of *Valid Accounts (T1078)* is also suspected, where attackers may have stolen administrator credentials and logged in legitimately to install the backdoor. In fact, groups like APT41 have previously compromised security equipment accounts to implant BPFDoor ([Stealth Mode: Chinese Cyber Espionage Actors Continue to Evolve Tactics to Avoid Detection | Mandiant | Google Cloud Blog](https://cloud.google.com/blog/topics/threat-intelligence/chinese-espionage-tactics#:~:text=,to%20APT15%2C%20APT25%2C%20and%20Ke3chang)). Although initial access is outside BPFDoor’s scope, these MITRE techniques are relevant for real-world deployment of the malware.

- **Execution** – *Command-Line Interface (T1059.004)*: Attackers used Linux shell commands such as `cp`, `chmod`, and `rm` to install and execute BPFDoor ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=When%20BPFDoor%20is%20first%20executed%2C,no%20exception%20to%20the%20case)). After execution, the BPFDoor process performs `fork` and `exec` to run persistently in the background. Although *Create or Modify System Process (T1543)* is not built into BPFDoor, attackers might have manually added it to the root cron or inserted execution scripts into `rc.local` to achieve persistence. Once executed, BPFDoor becomes a child of the init process, which aligns with *Masquerading: Break Process Tree (T1036.009)*—a technique to orphan the process and detach it from the management console ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1036%20%20,Masquerading%20%3A%20%2055)).

- **Persistence** – BPFDoor is designed as a *memory-resident backdoor* and does not use typical **persistence mechanisms** (e.g., autostart on boot) ([A peek behind the BPFDoor — Elastic Security Labs](https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor#:~:text=Attack%20Lifecycle)). Therefore, traditional persistence techniques defined by MITRE (e.g., *Boot or Logon Autostart Execution, T1547*) are not directly applicable. However, attackers may set up environments to relaunch BPFDoor after reboots using techniques like *Hijack System Process (T1543)* or *Scheduled Task/Job (T1053)*. In the SKT case, the server ran continuously without reboot, so memory residency sufficed, but typically, attackers might reinfect the system or use additional persistence techniques if the backdoor dies or the system reboots. In summary, BPFDoor itself does not play a major role in the persistence tactic but is used as a **platform for attack continuity**.

- **Privilege Escalation** – Installing BPFDoor requires *root privileges* as installing BPF socket filters needs kernel-level permissions (CAP_SYS_ADMIN or root). Thus, attackers likely performed *Exploitation for Privilege Escalation (T1068)* or *Credential Dump & Use* to obtain root access after initial intrusion. Once root access was gained, the backdoor was implanted and executed with full privileges, making techniques like UAC bypass unnecessary. BPFDoor does not use *Setuid* or *Token Impersonation* capabilities on its own.

- **Defense Evasion** – BPFDoor's core tactic involves several **techniques**:
  - *Indicator Removal on Host: File Deletion (T1070.004)* – Deletes the original malicious file immediately after execution to avoid leaving traces for disk forensics ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)).
  - *Indicator Removal: Timestomp (T1070.006)* – Uses `utimes()` to alter file creation/modification timestamps, making them appear as old and benign ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)).
  - *Impair Defenses: Disable or Modify Logging (T1562.003)* – Sets environment variables like `HISTFILE` to `/dev/null` to prevent shell command history logging and clears process environments to hinder tracking user activity ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1562%20%20,Impair%20Defenses%20%3A%20%2049)).
  - *Masquerading: Rename or Overwrite Process Arguments (T1036.011)* – Changes the malicious process name to resemble Linux system daemons and falsifies execution arguments to mislead `/proc` entries ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20overwrites%20the%20%60argv,journald%60.%5B1)). For example, a backdoor process may appear as `dbus-daemon --system`.
  - *Masquerading: Parent PID Spoofing (T1036.004 and T1036.009)* – Forks/executes processes using the `--init` argument to impersonate init as the parent, making it difficult to trace origins via `pstree` ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1036%20%20,Masquerading%20%3A%20%2055)).
  - *Impair Defenses: Disable or Modify System Firewall (T1562.004)* – Temporarily alters `iptables` rules to open ports only to attacker IPs and closes them post-session, avoiding detection and forensic traces ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=,Disable%20or%20Modify%20System%20Firewall)).

  In addition, BPFDoor performs *Network Sniffing (T1040)* by switching network interfaces to promiscuous mode, which enables stealthy packet monitoring unless specifically checked. Overall, BPFDoor employs a combination of **Defense Evasion** techniques to bypass antivirus, EDR, IDS, and other detection tools ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Introduction)).

- **Discovery** – BPFDoor itself does not perform active discovery such as internal network scans or system information collection. However, attackers who obtain a shell via the backdoor may conduct *System Service Discovery (T1007)* or *System Network Connections Discovery (T1049)* to gather information about the environment. These are not native BPFDoor functions but can be mapped to MITRE due to attacker behavior through the backdoor.

- **Lateral Movement** – While BPFDoor operates on infected systems only, attackers can use it as a foothold to move laterally. For example, *Remote Services: SSH (T1021.004)* may be used to access other servers or deploy additional instances of BPFDoor. Trend Micro reported cases where attackers repeatedly opened **reverse shells to other systems**, deeply infiltrating internal networks ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Micro%20tracks%20as%20Earth%20Bluecrow,Intrusion%20Prevention%20and%20Deep%20Discovery)). While BPFDoor does not propagate like a worm, APT actors manually install it across multiple machines for lateral movement.

- **Command and Control** – BPFDoor's communication method aligns precisely with the newly added MITRE ATT&CK technique category *Traffic Signaling (T1205.002)*, which uses *Socket Filters* to recognize specific traffic patterns as signals ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20uses%20BPF%20bytecode,2)). It employs **Non-Standard Ports (T1571)** using ICMP, TCP, UDP, and demonstrates *Application Layer Protocol (T1071)* masquerading, such as using HTTP or ICMP to conceal commands. Communications may be encrypted using **RC4** or custom encoding, mapping to *Encrypted Channel (T1573)* ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=Enterprise%20%20T1027%20%20,57)). In summary, BPFDoor builds a **stealthy C2 channel** using a variety of techniques under the **Command & Control** tactic, characterized by *socket-level packet filtering* and *reverse/bind shell connections* ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Command%20Password%20Feature%200%20pass,shell%202%20N%2FA%20%E2%80%9C1%E2%80%9D%20response)).

- **Collection/Exfiltration** – Although BPFDoor itself does not have built-in collection or exfiltration features, attackers can execute arbitrary commands via the backdoor session to collect and steal data. In the SKT case, attackers likely queried HSS databases and dumped subscriber information to files, then used *Archive Collected Data (T1560)* and *Exfiltration Over C2 Channel (T1041)* for data exfiltration. Data may have been transferred directly via BPFDoor's reverse shell or via FTP/HTTP. As BPFDoor is categorized as a *Remote Access Tool (S0002)*, attackers can carry out all subsequent stages (TA0009~TA0011) using it, making it a **full-featured attack infrastructure**. However, since these are not automated by BPFDoor itself, the listed techniques refer to actions enabled through its use.

As shown above, BPFDoor is primarily a backdoor implementing **Defense Evasion** and **Command & Control** techniques in combination. Through MITRE ATT&CK mapping, its sophistication becomes apparent. In particular, *Traffic Signaling (T1205)* and *Masquerading (T1036)* are hallmark behaviors of BPFDoor, and understanding these helps defenders develop countermeasures.

## 4. Security Strategy for BPFDoor Response (Detection, Analysis, Blocking, Post-Incident Response)
Learning from the SKT incident, **system administrators and SOC teams** must establish advanced countermeasures against stealthy backdoors like BPFDoor. Below is a step-by-step strategy from **detection** to **post-incident response**.

### 4.1 Network Layer Monitoring Strategy  
**① Detecting Abnormal Traffic Patterns:**  
Since BPFDoor uses unusual traffic patterns for C2 communication, **IDS/IPS and NDR (Network Detection & Response)** solutions should be configured to detect known **magic packet signatures**. For instance, Trend Micro updated its IPS devices (such as TippingPoint) with BPFDoor-specific traffic rules for detection ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=telecommunications%2C%20finance%2C%20and%20retail%20sectors%2C,protect%20them%20against%20this%20threat)). Monitoring **non-standard payloads in ICMP Echo packets** or TCP connection attempts to rarely used high ports (e.g., between 42391–43391) may help detect BPFDoor activity. Also, to catch **covert communications within allowed protocols**, establish normal traffic baselines and flag **anomalous patterns** (e.g., binary data transfers disguised as DNS or HTTP) as suspicious.

**② Monitoring Attacker C2 Servers and IPs:**  
It’s important to monitor **IOC information (IPs, hashes)** released by KISA in connection with internal system logs ([KISA "Recent Malware Warning"…SKT Hacking Files Revealed | Yonhap News](https://www.yna.co.kr/view/AKR20250425168300017#:~:text=%EA%B7%B8%EB%9F%AC%EB%A9%B4%EC%84%9C%20%EA%B3%B5%EA%B2%A9%20IP%EC%99%80%20%EC%95%85%EC%84%B1%20%EC%BD%94%EB%93%9C,%ED%95%B4%EC%8B%9C%EA%B0%92%20%EB%B0%8F%20%ED%8C%8C%EC%9D%BC%20%EC%A0%95%EB%B3%B4%EB%A5%BC%20%EA%B3%B5%EC%9C%A0%ED%96%88%EB%8B%A4)). Though BPFDoor is passive, once activated, it communicates with attacker C2 servers. Check firewall or proxy logs for **outbound connections to suspicious IPs**. Especially investigate any **unexpected TCP sessions from critical servers (like HSS)** to unknown external IPs. Using NetFlow or traffic mirroring may help detect **covert reverse shell connections**. If no EDR is in place, it's essential to **identify and block anomalous network sessions** (e.g., server → internet SSH).

**③ Segmentation and Access Control:**  
To block the spread and C2 communication of BPFDoor, reinforce **network segmentation**. Critical servers should be isolated from direct internet access, communicating only through strict proxy/gateway channels when necessary. Had the HSS network been completely segmented, BPFDoor reverse connections would have failed. Also consider *ICMP traffic filtering* at the internal network egress. Since servers rarely send pings outward, ICMP Echo Replies from internal servers should be treated as suspicious. Limit ICMP traffic on firewalls and ensure `iptables` rule changes are logged in the management console.

**④ Proactive Probing with Magic Packets:**  
As an advanced threat hunting technique, security teams can create **BPFDoor trigger packets** to probe internal servers. For instance, send packets containing BPFDoor’s magic byte (e.g., 0x5293) to suspect servers and check for a "1" response ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=password%20in%20the%20source%20code,infection%20status%20from%20this%20information)). This carries risk and must be done cautiously. You may also attempt a reverse connection using known passphrases (e.g., "justforfun" in some samples). Such **active detection techniques** are helpful in uncovering hidden BPFDoor instances during incident response. However, as this involves sending custom packets into the production network, it must be pre-validated in a closed test environment and applied with caution.

### 4.2 Endpoint Forensics and Memory Inspection  
**① Checking Process Indicators:**  
The first line of defense is detecting **suspicious process signs** on the server side. Administrators should regularly inspect **the list of running processes and their start paths** to check for processes with executables marked as `\(deleted\)`. On Linux, you can check the executable path via the symbolic link `/proc/<PID>/exe`, and in the case of BPFDoor infection, this path will point to a deleted file ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=)). For example, a command like `ls -l /proc/*/exe | grep "(deleted)"` can help identify suspicious processes that exist only in memory. Also, pay attention if the `ps -ef` output shows more than one instance of a typical system daemon, or if processes that should only run at boot time are seen running at unusual hours (e.g., two instances of `systemd-journald`). BPFDoor uses one of 10 predefined disguised names ([BPFDoor, Software S1161 | MITRE ATT&CK®](https://attack.mitre.org/software/S1161/#:~:text=BPFDoor%20%20overwrites%20the%20%60argv,journald%60.%5B1)), so duplicated names or names that don’t match the system environment should raise suspicion.

**② Detecting Malware in /dev/shm and Memory:**  
BPFDoor typically hides itself in `/dev/shm` or `/tmp`, so check these directories for **files with executable permissions** and suspicious filenames. For example, if you find an unfamiliar binary like `kdmtmpflush`, isolate it for analysis. If the file has already been deleted, switch to **memory dump analysis**. For live memory forensics, use `gcore` to create a core dump of the suspicious process, or dump `/proc/<PID>/mem` using `dd`. You can then apply **YARA rules** to the memory image to detect known BPFDoor strings (e.g., "justforfun", iptables command strings, BPF bytecode sequences) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=Once%20this%20process%20is%20complete%2C,infection%20status%20from%20this%20information)) ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=In%20the%20bind%20shell%20process%2C,that%20was%20added%20is%20removed)). Additionally, using **BPFDoor-specific detection rules** provided by solutions like AhnLab EDR can help identify infection based on memory indicators or behavior ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=During%20its%20execution%2C%20BPFDoor%20is,of%20the%20behavior%20in%20advance)).

**③ Monitoring for BPF Usage:**  
To detect BPFDoor at the syscall level, it's possible to trace **BPF filter registration events** or **Raw Socket creation events**. Linux Auditd can be configured to monitor `socket()` and `setsockopt()` calls. Since BPFDoor creates an **AF_PACKET socket** and uses the `SO_ATTACH_FILTER` option, you can configure Auditd to log these actions. It’s uncommon for regular server processes to open such sockets, so any such event in the audit logs warrants investigation. You can also list loaded BPF programs using tools like `bpftool`, but since BPFDoor uses classic BPF filters attached to sockets, it may not appear in `bpftool` (as it's not eBPF). Instead, use `tcpdump` to check whether interfaces are already being captured, or use `ifconfig` to see if the interface is in **PROMISC mode**, which could indicate packet sniffing. Although low-level indicators are hard to monitor, **Host IDS** or **eBPF-based monitoring tools** can detect abnormal behavior at the kernel level.

**④ Memory Forensics and Digital Investigation:**  
If compromise is suspected or confirmed, **preserve memory and disk images** for post-incident forensic analysis. Since BPFDoor is memory-resident, **traditional disk forensics may lack evidence**. Therefore, if possible, perform live memory imaging (using tools like Volatility) and extract the process memory for reverse engineering to identify specific attacker information, such as passwords. During forensics, it's also important to **reconstruct the commands executed via the backdoor**. Even though HISTFILE may not exist, check whether there is any **alternative command history logging** aside from `.bash_history`, analyze the shell environment in memory, or trace the network PCAP to determine what SQL queries or shell commands were issued. This enables a clearer understanding of the **data exfiltrated** and **attacker behavior**.

### 4.3 Kernel-Level Hooking and Rootkit Detection Techniques  
Although BPFDoor is not a rootkit in the form of a kernel module, its activity occurs at the **kernel level (packet filter)**, making it behave similarly to a rootkit ([BPFDoors Hidden Controller Used Against Asia, Middle East Targets | Trend Micro (US)](https://www.trendmicro.com/en_us/research/25/d/bpfdoor-hidden-controller.html#:~:text=Introduction)). Therefore, it's beneficial to combine **kernel hook detection techniques** as well. For example, you can dump kernel memory using tools like **LiME (Linux Memory Extractor)** and inspect for abnormal hooks or modified function pointers. Regularly running **rootkit scanners** such as OSSEC, chkrootkit, or rkhunter can also help identify **PROMISC-mode interfaces** or **abnormal kernel modules**. While BPFDoor does not insert modules, an attacker might additionally employ **LD_PRELOAD-based injection** or a **kernel module-style backdoor**, so it is important to look for overall rootkit indicators.

For **real-time kernel monitoring**, you can utilize eBPF-based security modules. Tools like Facebook’s **osquery**, Cilium’s **hubble**, or Sysmon for Linux can monitor process creation, network connections, and file operations at the kernel level, potentially revealing BPFDoor’s stealthy activities. It is recommended to thoroughly enable **kernel audit logs** (e.g., adding `-a exit,always -F arch=b64 -S socket -S setsockopt` to `audit.rules`) and establish procedures to detect behaviors similar to BPFDoor in advance.

Another important consideration is preparing for **other backdoors** or **variant threats** similar to BPFDoor. Kernel-level hook detection is not only effective against BPFDoor but can also uncover other rootkits or DKOM (Direct Kernel Object Manipulation) attacks. Establishing such low-level monitoring systems enhances overall security posture.

### 4.4 Mitigation and Post-Incident Response  

**① Response and Containment:** Once BPFDoor infection is confirmed, the first step is to **isolate the affected system (segmentation)**. Disconnect it from the network and block login sessions to prevent further attacker activity. Next, terminate the **in-memory backdoor process** and remove any related artifacts. Do more than just killing the process—review all directories where the backdoor may reside (e.g., `/dev/shm`) and any temporary firewall rules. If possible, **reboot** the system to clear in-memory malware, and verify that the same process doesn’t reappear after reboot. At the same time, check for similar intrusion signs on **other systems within the same network**. APT attackers often implant backdoors on multiple systems, so organization-wide scans are necessary to detect additional infections.

**② Patching and Vulnerability Closure:** If the root cause of the breach is identified, immediately apply patches or configuration changes. For instance, if a zero-day vulnerability in a firewall or web server was exploited, update those systems and apply virtual patches (e.g., IPS rules) on similar setups. **Account management** is also critical—deactivate any accounts used in the attack (e.g., insider or stolen VPN credentials) and change passwords. Strengthen password policies for all admin accounts and consider implementing 2FA to prevent credential reuse attacks.

**③ Logging and Monitoring Enhancement:** To detect threats like BPFDoor early, rework the **logging infrastructure**. Aggregate security logs (auth attempts, system changes) into a centralized SIEM. Correlate events like *iptables rule changes*, *PROMISC mode activation*, or *process crashes and core dumps*. While BPFDoor may delete iptables rules post-session, logs like **syslog** might still contain **iptables INSERT** records—identify them. Also, **remote access logs (e.g., SSH)** showing temporary connections from unusual overseas IPs can serve as clues. In the SKT case, the attacker’s C2 was suspected to be located overseas (e.g., China), so check for connections from unfamiliar IPs to internal systems.

**④ Security Solution Deployment:** This incident highlights the need to deploy **EDR/XDR for Linux** ([KISA, SKT Hacking Malware Disclosure... Security Inspection Advised](https://m.boannews.com/html/detail.html?idx=137004#:~:text=%EB%AC%B8%EA%B4%91%EC%84%9D%20%ED%95%9C%EA%B5%AD%EC%A0%95%EB%B3%B4%EA%B3%B5%ED%95%99%EA%B8%B0%EC%88%A0%EC%82%AC%ED%9A%8C%20%EB%AF%B8%EB%9E%98%EC%9C%B5%ED%95%A9%EA%B8%B0%EC%88%A0%EC%9B%90%EC%9E%A5%EC%9D%80%20%E2%80%9CKISA%20%EA%B3%B5%EC%A7%80%EC%97%90%EC%84%9C,%EC%A7%84%ED%96%89%ED%95%A0%20%EA%B2%83%EC%9D%84%20%EA%B6%8C%EA%B3%A0%ED%95%98%EA%B3%A0%20%EC%9E%88%EB%8B%A4%E2%80%9D%EA%B3%A0%20%EB%A7%90%ED%96%88%EB%8B%A4)). Installing EDR with **behavior-based detection** on Linux endpoints can help detect and block BPFDoor activities in real time (e.g., `/dev/shm` execution, process renaming). EDRs with memory forensic capabilities can also detect malware that exists only in memory ([BPFDoor Linux Malware Detected by AhnLab EDR - ASEC](https://asec.ahnlab.com/en/83925/#:~:text=During%20its%20execution%2C%20BPFDoor%20is,of%20the%20behavior%20in%20advance)). Organizations should budget for such **server security solutions**. Since vendors like Trend Micro and AhnLab provide BPFDoor detection rules, it's also necessary to integrate those signatures into existing SIEMs or IPS systems.

**⑤ Forensics and Recurrence Prevention:** After incident resolution, conduct a **thorough root cause analysis and recurrence prevention planning**. Use digital forensic results to document the attack timeline, data exposure scope, and attacker TTPs, and share this with management and relevant departments. If needed, execute legal response steps such as customer notifications or user protection (e.g., SKT offered free USIM replacements to all customers). Update **incident response playbooks** to include actions for detecting similar BPF-based backdoors. Conduct **mock training** using BPFDoor samples to test EDR and monitoring systems’ detection and response capabilities. Lastly, **share intelligence** and lessons learned with the industry. Just as KISA disclosed relevant indicators and advised internal checks, sharing IoCs and techniques raises the overall level of defense.

## 5. Conclusion and Recommendations  
The SKT USIM hacking incident was a major shock, demonstrating how a **stealthy Linux backdoor like BPFDoor** can target critical infrastructure. BPFDoor’s **attack mechanism** hinges on kernel-level packet filtering and process masquerading, effectively creating an **"invisible door."** This is a sophisticated technique used for years by **global APT actors**. This case reminds organizations to move beyond a Windows-centric security approach and reassess the importance of **Linux server protection** and **network monitoring**. From a technical perspective, layered defense strategies based on MITRE ATT&CK mapping, along with **proactive detection and rapid response frameworks**, are essential. In particular, **memory-resident malware forensics** and **kernel behavior visibility** have emerged as new security challenges. To prepare for future **stealth malware** like BPFDoor, security teams must stay updated, enhance vulnerability management, and strengthen anomaly detection. Even an **"invisible backdoor"** leaves traces—it's crucial to detect and block such threats through diligent security operations, combining human insight with technology to protect valuable customer data.

