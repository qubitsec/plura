# 📘 MSA 개발을 위한 사전 설명 문서

## 6일차 – 개념 이해

**날짜: 6월 18일**

---

## 주제

# **6. 서비스 분해 기준(기능/도메인/팀/데이터)**

> “어떻게 나눠야 ‘운영 가능한 MSA’가 되는가”

---

## 1️⃣ 서비스 분해는 “정답”이 아니라 “기준”으로 결정한다

MSA에서 서비스 분해는 한번에 완벽할 수 없습니다.
처음부터 정교하게 나누려 하기보다,

* **잘못 나누면 폭발하는 지점**을 피하고
* **독립 운영**이 가능한 최소 단위를 만들고
* 필요할 때 점진적으로 조정하는 것이 현실적입니다.

---

## 2️⃣ 서비스 분해 기준 4축

서비스를 나누는 기준은 보통 아래 4개 축으로 설명할 수 있습니다.

* **기능(Function)**
* **도메인(Domain)**
* **팀(Team / Ownership)**
* **데이터(Data / Ownership)**

중요한 점은
👉 **하나만 보고 나누면 실패하기 쉽다**는 것입니다.
최소한 “도메인 + 데이터”는 함께 봐야 합니다.

---

## 3️⃣ (A) 기능(Function) 기준 — “단독으로는 위험”

### ✅ 언제 유용한가

* 화면/기능이 명확히 분리된 제품
* 단기간에 모듈화가 필요할 때

### ❌ 왜 위험한가

기능 기준만 따르면 이런 서비스가 생깁니다.

* 회원조회 서비스
* 회원수정 서비스
* 주문조회 서비스

이 방식은 거의 항상 **DB 공유**로 이어지고,
결국 “겉만 MSA, 속은 모놀리식”이 됩니다.

📌 결론

* 기능 기준은 **보조 기준**으로만 사용하세요.

---

## 4️⃣ (B) 도메인(Domain) 기준 — 가장 강력한 1차 기준

### ✅ 도메인이란

비즈니스가 실제로 다루는 문제 영역입니다.

예시:

* 회원(Member)
* 주문(Order)
* 결제(Payment)
* 배송(Delivery)
* 정산(Billing)
* 알림(Notification)

### ✅ 도메인 기준 분해의 장점

* 서비스 책임이 명확해짐
* API 명명과 모델 정의가 안정됨
* 변경 영향 범위가 줄어듦

📌 체크 질문

* “이 책임은 어떤 업무 팀이 주인인가?”
* “이 기능은 어떤 도메인의 언어로 설명되는가?”
* “같은 단어가 다른 의미로 쓰이는 지점이 있는가?”
  → 그게 경계(바운디드 컨텍스트) 후보

---

## 5️⃣ (C) 팀(Team / Ownership) 기준 — 운영 가능한 구조로 만드는 핵심

MSA는 기술보다 **운영 모델**입니다.
따라서 서비스는 “팀이 책임질 수 있는 크기”가 되어야 합니다.

### ✅ 팀 기준 분해의 목표

* 서비스별 담당자(오너) 명확
* 장애 발생 시 책임/대응 경로 명확
* 독립 배포가 가능

📌 체크 질문

* “이 서비스를 담당할 팀/오너가 명확한가?”
* “배포 승인/릴리즈를 이 팀이 독자적으로 할 수 있는가?”
* “장애 발생 시 이 팀이 끝까지 대응 가능한가?”

---

## 6️⃣ (D) 데이터(Data / Ownership) 기준 — 실패를 막는 가장 현실적인 기준

**데이터 소유권**은 서비스 경계를 강제합니다.

### ✅ 핵심 원칙

* 서비스는 자신의 데이터를 **소유**해야 합니다.
* 다른 서비스 DB를 직접 조회/수정하면
  → 바로 강결합이 됩니다.

📌 체크 질문

* “이 데이터의 진실(SoT)은 어디인가?”
* “누가 생성/수정 권한을 갖는가?”
* “다른 서비스는 API로만 접근 가능한가?”

---

## 7️⃣ 실전 분해 체크리스트 (가장 많이 쓰는 판단 기준)

아래 질문에 “예”가 많을수록 **분리 가치가 큽니다.**

### ✅ 분리 신호(Strong Signals)

* 트래픽 패턴이 다르다 (특정 기능만 폭주)
* 장애 허용 수준이 다르다 (중요도 차이)
* 배포 주기가 다르다 (어떤 것은 매주, 어떤 것은 분기)
* 데이터 소유권이 다르다 (진실의 원천이 다름)
* 팀 책임이 다르다 (담당 조직이 다름)
* 기술 요구가 다르다 (예: 검색/추천은 별도 최적화 필요)

### ❌ 합쳐야 하는 신호(Keep Together)

* 항상 함께 바뀐다(동시 수정이 잦다)
* 강한 트랜잭션 정합성이 핵심이다
* 아직 조직/운영 역량이 부족하다(관측/배포 자동화 없음)

---

## 8️⃣ 추천 접근: “모놀리식 → 모듈러 모놀리식 → MSA”

처음부터 모든 것을 쪼개면 운영이 감당이 안 됩니다.
현실적인 추천 흐름은 아래입니다.

1. **모놀리식(초기)**
2. **모듈러 모놀리식(경계만 먼저 만든다)**

   * 내부를 도메인별로 분리
   * 의존성 규칙을 강제
3. **MSA(독립 배포가 필요한 도메인부터 분리)**

   * 트래픽/장애/배포 압박이 큰 도메인부터

---

## ✅ 오늘의 핵심 요약

* 서비스 분해는 **도메인 + 데이터 소유권**이 1순위다.
* 기능 기준만으로 나누면 거의 항상 실패한다.
* 팀이 책임질 수 있어야 “운영 가능한 MSA”가 된다.
* 처음부터 MSA로 가기보다 **모듈러 모놀리식 → 점진 분리**가 안전하다.

---
