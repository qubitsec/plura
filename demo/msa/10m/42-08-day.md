# 필상 시스템 — Day 42 규제 매핑(ISMS-P · APPI · GDPR) · 표준 로그 & 증거 체계

1. **날짜**

* 2025-10-08

2. **목표**

* **ISMS-P(한국) · APPI(일본) · GDPR(EU)** 핵심 요구를 **필상 아키텍처**에 매핑
* **표준 로그·증거·데이터 권리 행사(Export/Erasure)** 절차와 **감사 가시성**을 일관화

---

3. **내용**

### A. 규제 범주 → 시스템 매핑(요약 표)

| 범주                       | ISMS-P     | APPI       | GDPR           | 필상 충족 설계                                                                      |
| ------------------------ | ---------- | ---------- | -------------- | ----------------------------------------------------------------------------- |
| **개인정보 최소수집·목적**         | P1-1, P1-2 | Art.15, 16 | Art.5(1)(c)(b) | **PII 최소화**(`ip_bucket`, `email_hash`), **Purpose Binding**(요청에 `purpose` 필수) |
| **처리·접근 통제**             | O2-1       | Art.20     | Art.32         | **RBAC+ABAC**(tenant/region/purpose), **JIT/JEA** 운영 접근                       |
| **로그·감사**                | O2-6, O3-2 | Art.26     | Art.30, 33     | **감사 해시체인**, `security.audit.v1`, **상태·결정 로그 중앙화**                            |
| **국외 이전/주권**             | O4-4       | Art.24     | Art.44         | **리전 격리**(교차 리전 금지), 하이브리드/엣지 **데이터 경계**                                      |
| **정보주체 권리**(열람/정정/삭제/이동) | P4-3       | Art.28, 30 | Art.12–20      | **Export/Erasure API**, `EPKG-X`, 삭제 보고서(키 파기 포함)                             |
| **침해 대응 통지**             | O4-6       | Art.26-2   | Art.33–34      | **SLA/상태페이지 템플릿**, RCA(증거 링크)                                                 |
| **위탁/3rd 파티**            | O4-2       | Art.22     | Art.28         | **TI·메일/SMS 공급자 계약·SCC**, **DPA 레지스터**                                        |

### B. 표준 로그 카탈로그(감사·보안·데이터권리)

* **보안감사(Security Audit)**: `actor, tenant, scopes, purpose, action, resource, ip, ts, trace_id, evidence_uri, prev_hash`
* **운영변경(Change Mgmt)**: 플래그/릴리스/정책 결정 로그(OPA Decision + 릴리스 노트 링크)
* **데이터권리(Data Subject Events)**: `export.created`, `erasure.completed`, `legal_hold.toggled` — **요청자·근거·범위** 포함
* **보존주기**: 감사 3년, 사건 증거 3년(법령/계약 우선), 인덱스 로그 90일(고객 설정 가능)

### C. 데이터 권리(Export/Erasure) 운영 절차

* **Export(이동/열람)**: `POST /v1/tenants/{id}:export { scope, pii_mask, locale }` → **서명 해시·루트해시** 포함, 지역 저장소로 전송
* **Erasure(삭제)**: 승인 2인 → **키 파기 → 인덱스/메타/객체 순 삭제** → `erasure-report.json`(서명) 발행
* **제한·예외**: `legal_hold=true`, 규제 데이터(장부/감사) — 삭제 유예 및 근거 기록

### D. 국외 이전·데이터 주권 통제

* **원칙**: 원로그/증거는 **리전 내** 저장, 중앙에는 **메타·모델·정책**만 교환
* **기술 통제**: 게이트웨이 **mTLS + HMAC**·Egress 화이트리스트, **교차 리전 쿼리 차단**(OPA)
* **계약 통제**: TI/알림 공급자는 **지역 내 처리/SCC** 명시, 키는 **리전별 KMS**

### E. 프라이버시 설계(PIA/DPIA 체크리스트)

* [ ] 목적 명세 및 법적 근거 분류(계약/정당 이익/동의)
* [ ] PII 데이터 흐름 다이어그램(수집→저장→사용→삭제)
* [ ] 위험 평가(식별 재식별, 외부 전송, 접근 권한 과다) 및 완화(마스킹/해시/RLS)
* [ ] **테스트/운영 데이터 분리**, 샘플 데이터 **가명화** 원칙
* [ ] **기술·조직적 보호조치**(암호화·접근·감사·훈련) 문서화

### F. 리포팅 & 증빙 자동화

* **규제 리포트**: 월간 `compliance-report.pdf` — 처리현황, 실패/예외, DSR(권리요청) 처리 리드타임
* **감사 준비**: Evidence Package(감사용) 자동 생성 — 정책/로그/결정/서명 해시 인덱스
* **대시보드**: `dsr_sla`, `audit_gap(=0)`, `purpose_mismatch`, `cross_region_denies`, `erasure_latency_p95`

### G. 개인정보·민감정보 취급 규칙

* **인덱스 금지**: 주민번호/여권/결제수단 원문 — 탐지 시 **DLP 차단** + 티켓
* **화면 노출**: 콘솔은 **마스킹 뷰 기본**(IP /24, 이메일 해시), 다운로드는 **서명 URL + 10분 만료**
* **개발·디버깅**: 원본 로그 공유 금지, EPKG 링크만 허용(목적/기한 표시)

### H. 교육·운영

* **분기 교육**: 개인정보보호·데이터권리·사고 통지 플로우(ko/ja/en)
* **모의 훈련**: DSR(삭제/이동) 2주기, 침해통지 1주기 — 목표 MTTA **≤ 60분**, DSR 완료 **≤ 7일**
* **벤더 리뷰**: 연 1회 공급자 DPA/SCC 점검·펜테스트 레포트 수령

### I. API/계약(발췌)

* `GET /v1/audit/search?q=purpose:investigation AND actor:admin` — 감사 조회
* `POST /v1/dsr/export { subject, window }` / `POST /v1/dsr/erase { subject }` — 데이터권리 요청
* `GET /v1/sovereignty/violations?range=24h` — 주권 위반 탐지 요약
* `POST /v1/compliance/report` — 규제 리포트 생성(서명·워터마크)

### J. 지표·SLO

* **DSR 처리**: 접수→완료 `p95 ≤ 5일`(법정 7일 내)
* **Erasure**: 승인→완료 `p95 ≤ 24h`, **키 파기 누락 0건**
* **감사 연속성**: `audit_gap=0`, 결정 로그 지연 `≤ 2m`
* **주권 위반**: 교차 리전 전송 **0건**, 차단율 100%

---

4. **예시 설명 (JP 테넌트—데이터 이동 요청 & 부분 삭제 케이스)**

1) 고객이 **APPI** 기반 데이터 이동 요청 제출 → `DSR Export` 접수(목적: *portability*).
2) 시스템이 **EPKG-X** 생성(최근 180일 요약·스키마·체크섬, 원본은 서명 URL 링크만) → **3영업일 내 제공**.
3) 동일 고객이 일부 데이터 **삭제** 요청 → 사건·감사 레코드는 **legal_hold 제외**, 나머지는 **키 파기→인덱스/메타/객체 삭제**.
4) `erasure-report.json`(서명·루트 해시) 공유, 대시보드에 `dsr_sla` 만족 표시.
5) 전 과정에서 **교차 리전 전송 0건**, 감사 해시체인 검증 통과.

> 결과: 규제 요구사항을 **아키텍처/프로세스/지표**로 명확히 매핑해, **데이터 주권·권리·감사**를 실무적으로 이행하고 고객·감사기관 대응을 **자동화/증거화**합니다.
