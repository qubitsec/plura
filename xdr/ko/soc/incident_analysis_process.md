### PLURA-XDR 침해 사고 분석 프로세스

PLURA-XDR은 EDR, WAF, Web 로그 분석 데이터를 통합하여 다각적인 탐지 및 분석을 수행합니다. 각 시나리오별 침해 사고 분석 프로세스는 다음과 같이 정리됩니다.

---

#### **1) EDR에서 탐지되었을 경우**

**탐지 시나리오:**
- 악성 파일 실행
- 비정상적인 프로세스 동작
- 의심스러운 네트워크 통신 시도

**분석 프로세스:**
1. **이벤트 확인 및 분류:**
   - PLURA-XDR에서 제공하는 EDR 로그를 확인하여 탐지된 위협의 유형과 심각도를 분류합니다.
   - MITRE ATT&CK 매핑을 통해 위협 시나리오를 식별합니다.

2. **위협 세부 정보 확인:**
   - 침해 대상 시스템의 프로세스 트리 분석
   - 탐지된 파일의 해시 값을 활용한 파일 무결성 및 위협 인텔리전스 조회

3. **행위 기반 분석:**
   - 탐지된 프로세스의 파일 접근 이력, 레지스트리 변경 내역, 네트워크 접속 정보를 추적합니다.

4. **조치:**
   - 필요 시 자동 또는 수동으로 해당 프로세스 종료 및 파일 격리
   - 추가 탐지 정책 생성 및 배포
   - 사용자 및 시스템 격리

---

#### **2) WAF에서 탐지되었을 경우**

**탐지 시나리오:**
- OWASP Top 10 공격 (SQL Injection, XSS 등)
- 크리덴셜 스터핑
- 데이터 유출 시도

**분석 프로세스:**
1. **로그 분석:**
   - WAF 로그에서 탐지된 요청의 IP, User-Agent, URL 패턴 및 HTTP 헤더를 분석합니다.
   - 탐지된 공격이 기존 룰셋으로 방어 가능한지 확인하거나 추가 룰셋이 필요한지 평가합니다.

2. **공격 범위 확인:**
   - 동일 IP 및 User-Agent를 사용하는 다른 공격 시도를 조회합니다.
   - 타임라인 분석을 통해 다중 공격 여부 파악.

3. **로그 상관 분석:**
   - SIEM 연동으로 EDR 및 Web 로그와의 상관 관계를 분석하여 추가적인 위협 탐지.
   - 동일 기간 동안의 네트워크 로그와 비교하여 공격 흐름 추적.

4. **조치:**
   - 블랙리스트 IP 추가 또는 세션 차단
   - 탐지된 패턴을 기반으로 추가 방어 규칙 작성
   - 차단 로그를 자동 보고서로 생성하여 담당자에게 전달

---

#### **3) Web 로그 분석에서 탐지되었을 경우**

**탐지 시나리오:**
- 비정상적인 접속 패턴 (특정 User-Agent 반복 접속, 동일 쿠키 재사용 등)
- 크리덴셜 스터핑 시도
- 데이터 탈취 (SQL 쿼리 의심 등)

**분석 프로세스:**
1. **탐지 로그 확인:**
   - Kafka를 통해 수집된 Web 로그에서 의심스러운 요청 확인.
   - User-Agent, Referer, Cookie 등의 비정상적 패턴 탐지.

2. **추가 데이터 탐색:**
   - Redis에 저장된 일별 IP 시도 횟수, User-Agent 분석 데이터를 확인.
   - Apache Solr에 저장된 전체 로그와 비교하여 유사한 탐지 이벤트 탐색.

3. **공격 시나리오 재구성:**
   - 공격자가 시도한 URL 패턴, 시간대, 응답 코드 분석.
   - 정상 사용자와의 비교를 통해 오탐 가능성 검토.

4. **조치:**
   - 탐지된 IP와 User-Agent를 WAF 블랙리스트로 전송.
   - SIEM에 결과를 기록하여 향후 탐지를 위한 기준 데이터 추가.
   - 이메일 및 메시지 플랫폼을 통해 관리자에게 경고 전송.

---

#### **통합 분석 및 보고**
1. **상관 관계 분석:**
   - EDR, WAF, Web 로그의 데이터를 종합하여 탐지된 사건의 전반적인 맥락 파악.
   - 동일 IP/공격 패턴에 대한 연관 탐지 결과 확인.

2. **보고서 생성:**
   - PLURA-XDR에서 제공하는 분석 보고서 자동 생성.
   - 탐지된 위협의 유형, 대응 조치, 잔여 위험 등을 포함.

3. **사후 조치:**
   - 탐지 결과를 바탕으로 탐지 규칙 업데이트.
   - 교육 및 추가 방어 전략 수립.

이 과정을 통해 각 시스템에서 발생한 탐지를 통합적으로 분석하고, 신속하고 정확한 대응이 가능하도록 지원합니다.
