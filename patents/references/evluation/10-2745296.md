## 🤖 생성형 AI로 위협 탐지? 하지만 암호화된 트래픽은 보이지 않습니다.

PLURA 블로그: [NDR의 한계](https://blog.plura.io/ko/column/limitations_of_ndr/)를 바탕으로 특허 제10-2745296호의 실효성과 한계를 검토하면 다음과 같습니다.

---

### ✅ 특허의 기술적 시도: 긍정적 평가

1. **NDR + LLM 통합**
   이 특허는 단순한 시그니처 기반 탐지를 넘어서,

   * 실시간 미러링 트래픽 수집
   * 필드 기반 토큰(MATRIC) 생성
   * ML·LLM을 통한 위협 식별
     등을 연계하여, **자동화된 고도 위협 탐지 체계**를 목표로 하고 있습니다.

2. **LLM 분석을 통한 위협 인텔리전스 강화**
   기존 ML 탐지의 한계를 극복하고자, 생성형 인공지능(LLM)을 활용한 로그 학습·질의 응답 방식이 포함된 점은 기술적으로 참신한 접근입니다.

---

### ❌ 하지만 실질적 한계: ‘암호화 트래픽의 분석 불가’

특허에서 기반으로 삼고 있는 핵심 기술 중 하나인 NDR(Network Detection and Response)은 구조적으로 다음 한계를 가집니다:

| 항목                                       | 기술적 한계                                                                 |
| ---------------------------------------- | ---------------------------------------------------------------------- |
| 🔒 **암호화 트래픽(HTTPS 등)**                  | **복호화 없이는 실제 공격 페이로드를 분석할 수 없음**. 즉, SSL/TLS 통신에서 POST 요청 본문 등은 분석 불가. |
| 💻 **엔드포인트 내부 행위 분석 불가**                 | 네트워크 외부에서만 패킷을 수집하기 때문에, **실행 파일 동작, 메모리 내 악성 행위**는 알 수 없음.            |
| 📉 **FP/FN 문제**                          | 패턴 기반이나 통계 기반 탐지 방식은 여전히 False Positive / Negative를 내포함.               |
| 🧱 **TLS 1.3 / ECH 등 신기술 도입 시 완전 분석 불가** | 앞으로는 암호화 범위가 더 넓어져, NDR로도 SNI나 URI 조차 확인 불가능한 경우가 증가함.                 |

결론적으로, **패킷을 수집하고 필드 조합을 통해 분석하는 토큰 기반 접근 자체가 암호화 트래픽 환경에서는 무력화될 수 있습니다.**

---

### 🧰 Suricata 기반 NDR의 장단점

이번 특허처럼 NDR의 엔진으로 **Suricata**를 사용할 경우, 다음과 같은 특징을 가집니다:

#### ✅ 장점

* **멀티스레드 기반 고속 처리**
  다양한 CPU 자원을 활용해 고속 트래픽 분석이 가능

* **정밀한 Deep Packet Inspection(DPI)**
  HTTP/FTP/DNS 등 비암호화 트래픽에 대해 강력한 탐지력

* **Snort 룰 호환 및 룰셋 다양성**
  커뮤니티 및 상용 룰 업데이트가 활발하며, 실시간 보완 가능

* **다양한 오픈소스 연동 가능**
  Zeek, ELK, MISP 등 다양한 시스템과 유연한 통합 가능

#### ❌ 단점

* **암호화 트래픽 분석 불가**
  TLS 1.3 이후 대부분의 트래픽이 암호화되며, Suricata는 URI/SNI조차 확인 불가

* **엔드포인트 분석 기능 부재**
  악성 파일 실행이나 메모리 내 이상 행위는 탐지 불가

* **룰 기반 한계**
  Zero-Day 공격, Unknown 공격은 탐지 어려움

* **TLS 복호화 구성의 현실적 제약**
  SSL 프록시 구성이 복잡하고, 성능·법률 문제를 야기할 수 있음

> 요약하면, Suricata는 "보이는 트래픽"에 대해서는 탁월하지만, **"보이지 않는 위협"에 대한 탐지는 불가능**합니다.

---

### 🔍 요약: 이 특허의 핵심적 취약성

* 이 특허는 **NDR의 구조적 한계를 인식하지 못한 상태에서 '미러 패킷 수집 기반 분석'에 지나치게 의존**하고 있으며,
* **LLM을 연계한 탐지 기술은 신선하나, 입력 데이터가 실질적으로 불완전**한 상황에서는 정확도와 실효성이 낮아질 수밖에 없습니다.

---

### 🔧 대안 제안

* **엔드포인트 기반 EDR/XDR**과의 연계 없이는 완전한 탐지 시스템이 될 수 없습니다.
* *SSL 복호화 프록시 또는 TLS MITM* 같은 보조적 시스템을 사용하여, **웹방화벽(WAF)과의 성능 비교가 반드시 필요합니다.**

---

### ✅ 결론

> 이 특허는 기술적으로 흥미롭고 복합적 구성을 시도했지만, NDR 기반이라는 구조적 한계(암호화 트래픽 분석 불가)를 극복하지 못한 이상, **실제 공격 대응력이나 시장 가치는 제한적**일 수 있습니다.

📌 요약: *“LLM을 활용한 위협 분석”이라는 발상은 좋지만, 입력 데이터가 눈가림 수준이라면 아무리 뛰어난 AI도 무의미합니다.*

---
