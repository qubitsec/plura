# 0) 즉시 선언

지금이 문제를 해결할 **절호의 기회**이며, **완벽하게 해결**할 수 있습니다.  
현재 **로그가 없기 때문에 AI로 분석할 방법도 없습니다.**  
따라서 **로그 생성이 우선**입니다. 이 선행 조건이 충족되어야, 지금 구축 중인 **AI가 한 번에 문제를 해결**할 수 있습니다.  
→ **결론: “로그 생성·저장·무결성 보장”이 모든 대응의 시작점**입니다.

# 1) 핵심 메시지(요약)

* **로그는 자동으로 생성되지 않습니다.**  
  특히 **웹 요청 본문(POST-Body)** 과 **운영체제 감사(Audit) 로그**는 기본값으로 수집되지 않으므로, 설정·저장이 없으면 **해킹 대응은 구조적으로 실패**합니다.
* **이번 조사에서 반드시 확인할 사항**  
  ① 웹 애플리케이션 계층의 **요청 본문(POST-Body) 로그가 실제로 저장되는지**  
  ② 서버/단말의 **운영체제 감사 정책(Logon/Process/File/Registry/Command 등)이 기록·보관되는지**  
* **현행 가이드의 빈틈**  
  지금까지의 **ISMS** 및 **국가정보보안기본지침(2023.1.31)** 제55조(로그 기록 유지) 해설·가이드에는 “**기본 설정으로는 로그가 생성되지 않는다**”는 경고가 명시되어 있지 않습니다. **본 항은 반드시 보완·수정되어야 합니다.**

# 2) 권고안(운영 지침 초안)

1. **웹 계층(필수)**

   * **요청 본문(POST-Body) 로깅 의무화**: 로그인·결제·관리자 기능·파일 업로드·API 엔드포인트 등 **고위험 URI**에 대해 **요청 헤더+본문 전문**을 암호화 저장.
   * **민감정보 보호**: 저장 전 **PII/결제수단/비밀키**는 **토큰화·마스킹** 후 보관(예: 계정 ID는 해시, 카드번호는 마지막 4자리만).
   * **WAF/리버스프록시 연계**: 차단/우회 의심 시 **원문 재현 가능**하도록 **WAF 이벤트 ↔ 원문(Post-Body) 로그** 상호 참조 키 부여.

2. **운영체제 계층(필수)**

   * **Windows**: 계정/권한·로그온/로그오프·프로세스 생성/명령줄·서비스/드라이버·파일·레지스트리·스크립트 실행 정책을 **감사 성공/실패 모두** 기록.
   * **Linux**: `auditd` 기반으로 **syscall·execve·sudo·권한상승·파일/디렉터리 감시**를 규칙화, `/var/log/audit` 보관. (보조로 `syslog`/`journal` 연동)
   * **시간 동기화/NTP**: 전 시스템 표준 시간 동기화 의무화(증거능력 확보).

3. **보관·무결성**

   * **보존기간**: 고위험 시스템 **최소 1년(온라인) + 1년(오프라인/콜드)**, 일반시스템 **최소 6개월(온라인)**.
   * **무결성**: 수집→전송→보관 전 과정 **암호화/서명/체인 해시** 적용, **WORM 대상** 또는 **오브젝트 락**으로 삭제·변조 방지.

4. **탐지·재현**

   * **공격 인지 후 10분 윈도 로그 전수 재검토 룰** 운영(차단 미탐 보완용).
   * **재현 가능성**: 경보마다 **원문(Post-Body)·프로세스 명령줄**을 근거로 **행위 재현** 가능해야 함.

# 3) 현장 적용을 위한 “설정 가이드 요약”

* **웹/프록시/WAF**

  * 고위험 엔드포인트를 룰셋으로 그룹핑 → **요청 전문 로깅 ON** → **필드별 마스킹 규칙** 적용 → **저장소(압축·암호화)** 지정 → **인덱싱/검색** 가능화.
* **Windows**

  * 고급 감사 정책(Advanced Audit Policy)에서 **Logon/Account Logon/Account Management/DS Access/Object Access/Policy Change/Privilege Use/Process Creation** 활성화, **명령줄 포함(4688)**.
* **Linux**

  * `audit.rules`: `-w /etc/passwd -p wa`, `-w /etc/sudoers -p r`, `-a always,exit -F arch=b64 -S execve` 등 **핵심 규칙** 활성화, `augenrules` 로딩, 로테이션/포워딩 설정.

# 4) 점검 체크리스트(감사용)

* [ ] **POST-Body 원문**이 실제로 저장·검색·재현되는가
* [ ] **민감정보 마스킹** 규칙이 적용되는가
* [ ] **Windows 4688(명령줄)**, 4624/4625(로그온), 4672(특권), 4719(정책변경) 등이 활성/수집되는가
* [ ] **auditd execve** 및 권한상승 이벤트가 수집되는가
* [ ] **시간 동기화** 및 **무결성(서명/체인해시/WORM)** 이 적용되는가
* [ ] **보존주기**가 정책과 실제 스토리지에 반영되어 있는가
* [ ] **WAF 이벤트 ↔ 원문 로그** 상호참조가 되는가
* [ ] **경보 후 10분 재검토 룰**이 자동 실행되는가

# 5) 규정·가이드 개정(안) 문구(초안)

> **제55조(로그 기록의 생성·보관) 보완안**  
> ① 로그는 기본 설정으로 자동 생성되지 않을 수 있으므로, 각 기관·기업은 **웹 요청 본문(POST-Body)** 및 **운영체제 감사 로그**의 **생성·수집·보관을 의무화**한다.  
> ② 웹 애플리케이션의 고위험 기능(인증·결제·관리자·파일업로드·API 등)에 대하여 **요청 헤더와 본문의 원문 로그**를 암호화·마스킹 후 저장한다.  
> ③ 운영체제(Windows/Linux)는 계정·권한·로그온·프로세스/명령줄 등 **행위 기반 감사 항목**을 성공/실패 모두 기록하도록 구성한다.  
> ④ 수집된 로그는 **무결성 보장**(서명·체인해시·WORM 등)과 **표준 시간 동기화**를 준수하며, 고위험 시스템은 최소 **2년(온라인·오프라인 포함)** 보존한다.  
> ⑤ 침해사고 대응 시, 경보 발생 전후 최소 **10분 구간에 대한 전수 재검토**를 수행하여 미탐을 보완한다.  
> ⑥ 본 조의 세부 이행 기준은 별도 **기술 가이드**로 정하며, 매년 최신 위협 양상을 반영하여 갱신한다.  

# 6) 제안서 본문용 문장(다듬은 버전)

* “**로그는 없습니다.**”라는 사실은, **기본값으로는 로그가 생성되지 않는다**는 구조적 현실을 드러냅니다.
* 해킹 대응의 전제는 **증거(원문 요청·행위 로그)**이며, 이는 **사전 설정 없이는 남지 않습니다**.
* 따라서 본 조사는 **①웹 요청 본문(POST-Body), ②운영체제 감사 로그**의 **실제 생성·보관 여부**를 1차 검증 대상으로 삼아야 합니다.
* 현재 **ISMS 및 국가정보보안기본지침(2023.1.31)**의 해설에는 “**로그는 자동 생성되지 않는다**”는 경고가 부재합니다. 본 제안은 이를 **명시적으로 보완**하여, **설정·저장·무결성·보존주기**까지 **실행 기준**으로 격상할 것을 요청합니다.

---
