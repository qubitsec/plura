# PLURA-XDR 제안서

## 0️⃣ 제안 요약

**비즈니스 효과:** 대규모 크리덴셜 스터핑 및 정보 유출 시도를 사고로 확대되기 전에 사전 차단·격리하여, 재무적 손실과 법적/컴플라이언스 리스크(예: 보고 대상 사고)를 줄입니다.  
또한 보안 조직이 소유하는 정책·설정 중심으로 보안을 강화하여, 개발 조직의 리소스 소모를 최소화하고 불필요한 개발 사이클 낭비를 줄입니다.

**정보보안 조직은 개발 변경 통지나 인사 이벤트에 의존하지 않고도, 침투 및 데이터 유출 시도를 독자적으로 탐지·통제할 수 있어야 합니다.**

현실적으로 개발 조직의 입·퇴사(오프보딩), 권한 변경, 배포/개발 변경은 보안 조직이 **항상 먼저** 알기 어렵고, 종종 늦게 인지됩니다.  
“협업이 완벽할 때만 동작하는” 설계는 구조적으로 공백을 만들 수밖에 없습니다.

쿠팡에 필요한 것은 “사람/프로세스가 알려주면 반응하는 보안”이 아니라,  
**알려주지 않아도(또는 늦게 알아도) 시스템 행위 신호로 독자적으로 탐지·통제되는 보안 운영 표준**입니다.

PLURA-XDR 제안 포인트는 다음 4가지입니다.

**1. 키 교체/폐기(1차, Layer 1)**는 필수입니다. 다만 교체 전·후 공백, 지연, 자동화 공격까지 교체만으로 완전히 커버하기 어렵습니다.  
→ “키를 가진 공격자” 시나리오까지 포함하는 **행위 기반 Brute Force 탐지·차단(2차, Layer 2)**이 필요합니다.

**2.** Brute Force의 근거는 Access Log 표면(URL/응답코드/IP)이 아니라, 대부분 **요청 본문(POST Body)**과 **응답 결과 신호(성공/실패·사유)** 안에 있습니다.  
→ **요청 본문 + 응답 결과 신호 기반 분석**이 있어야 “탐지”가 “차단”으로 연결됩니다.

**3.** IP가 수천 개로 분산돼도, 공격의 본질은 IP 숫자가 아니라 **반복성, 시간 밀도, 자동화 패턴, 정상 대비 편차(성공률/실패율)**입니다.  
→ IP 중심이 아니라 **계정/키/세션/엔드포인트 단위 행위**로 탐지·차단 가능합니다.

**4. 조직 이벤트 의존도 제거(핵심).** 개발자 오프보딩 또는 배포 변경이 보안 조직에 실시간 공유되지 않더라도,  
보안 조직은 **관측(Observability) + 통제(Enforcement)** 체계를 통해 침투/유출 시도를 **독자적으로** 상시 탐지·완화할 수 있어야 합니다.

## 1️⃣ 전제 전환: “퇴사”는 인사 이벤트가 아니라 보안 이벤트입니다

키(서명키/인증키/API Key 등)를 다루던 사람이 퇴사하면,  
노트북, 개인 클라우드, 백업 등 경로로 키가 보안 통제 범위를 벗어났을 가능성 자체가 리스크가 됩니다.

따라서 출발점은 다음이어야 합니다.

> “반출되지 않았을 것”이 아니라, “이미 반출되었을 수 있다”에서 출발해야 합니다.

### (운영 현실) 보안 조직은 사실을 ‘늦게’ 알게 되는 경우가 많습니다

실무에서 보안 조직은 개발 조직의 오프보딩, 권한 변경, 배포 일정, 개발 변경을 사전에 충분히 공유받지 못하거나, 사후에 인지하는 경우가 흔합니다.

인사 이벤트만을 트리거로 한 대응(예: “오프보딩 통보 → 즉시 키 교체”)에만 의존하면 공백이 발생할 수밖에 없습니다.

→ 결론: “알아야만 작동하는 보안”이 아니라, **몰라도 작동하는 보안**이 필요합니다.

## 2️⃣ 왜 ‘키 교체’만으로는 방어가 완성되지 않나요

키 교체/폐기는 필요하지만, 현실적으로 다음이 남습니다.

- 교체가 적용되기 전 **공백**
- 교체의 **지연** 가능성
- 이미 키를 확보한 공격자의 **자동화 공격 지속**

따라서 쿠팡에는 다음이 추가로 필요합니다.

> “이미 키를 가진 공격자”를 전제로 한 2차 방어선 = **행위 기반 Brute Force 탐지·차단**

핵심은 단순합니다.

- 키 통제는 **자산 거버넌스**
- Brute Force 방어는 **행위 통제**

둘 다 있어야 작은 이슈가 대형 사고로 확대되는 것을 막을 수 있습니다.

## 3️⃣ 왜 Access Log 중심 탐지는 실패하기 쉬운가

일반적인 웹 Access Log에는 IP, 시간, 메서드, URL, 응답코드 등만 기록됩니다.

예를 들어 아래는 정상처럼 보일 수 있습니다.

- POST /login ... 200

하지만 실제 시도 값(계정/패스워드/토큰/파라미터)은 URL이 아니라 **Body(요청 페이로드)** 안에서 발생합니다.

또한 운영 환경에서는 HTTP 응답코드는 200으로 유지되지만, 실패 사유는 응답 본문(JSON 메시지/코드)에만 담기는 설계도 흔합니다.  
→ 요청/응답 본문(또는 결과 신호)이 없으면 공격을 “정상”으로 오판하기 쉽습니다.

## 4️⃣ 핵심 제안: 쿠팡의 2차 방어선은 “요청 본문 + 응답 결과 신호”를 분석해야 합니다

### 4-1) 왜 ‘요청 본문(POST Body)’가 필수 인프라인가

대부분의 웹 공격에서 결정적인 증거는 **POST Body**에 존재하며, Access Log만으로는 식별이 불가능합니다.

HTTPS 환경에서는 페이로드가 네트워크 구간에서 보이지 않습니다. 본문 분석은 **종료/복호화 지점(웹 서버 / WAF / API Gateway)**에서만 가능합니다.  
그 지점에서 수집하지 않으면 이후에는 복구할 방법이 없습니다.

부분 수집(예: 첫 8KB만 저장, 특정 파라미터만 수집)은 공격자가 악용할 수 있습니다.  
→ **원본 그대로 전체 Body 수집**이 권장됩니다.

※ 이는 애플리케이션 기능 개발이 아니라, 종료/복호화 지점에서의 **운영 정책/설정**으로 구현할 수 있습니다.  
따라서 개발 배포 일정이나 변경 공유에 의존하지 않고, 보안 조직이 **독자적으로** 추진할 수 있습니다.

### 4-2) 왜 ‘응답 결과 신호’가 “안전한 차단”으로 이어지는가

Brute Force는 단순히 “요청이 많다”가 아니라, 다음과 같은 결과 신호로 구분됩니다.

- 로그인 성공/실패
- 실패 사유(비밀번호 오류, 계정 잠금, 추가 인증 필요 등)
- 토큰 발급/권한 부여 결과

이 신호는 실제 공격을 프로모션/장애 등 합법적 트래픽 급증과 분리하고, 차단 시 오탐을 줄입니다.

즉,

> **요청 본문(시도 내용)** + **응답 결과 신호(성공/실패·사유)**를 결합해야 “정확한 탐지”가 “안전한 자동 차단”으로 연결됩니다.

※ 응답 본문 전체 저장이 부담이라면, **구조화된 결과 필드**(예: 성공 플래그, 실패 사유 코드)만 수집하십시오.  
이는 개인정보/성능/비용 리스크를 낮추면서도 차단 정확도를 크게 개선합니다.

또한 이는 기존 응답의 결과 필드를 **추출·정규화**하는 운영 설정으로 시작할 수 있어, 신규 개발을 “시작 조건”으로 삼지 않고 보안 조직이 **독자 운영**할 수 있습니다.

## 5️⃣ 키가 유출돼도 탐지 가능한 이유: 키는 통과해도 ‘행위’는 숨기기 어렵습니다

서명키/인증키가 반출되면, 헤더/서명 수준에서는 정상처럼 보일 수 있습니다.  
그러나 Brute Force/자동화 인증 시도는 다음 특성을 갖습니다.

- 단위 시간 대비 요청 증가율(시간 밀도)
- 동일 리소스(로그인/토큰) 반복 호출
- 정상 기준선 대비 편차(성공률 급락/실패 반복)
- 자동화 패턴 지속성(규칙적 간격, 지속 시퀀스)

PLURA-XDR의 핵심 접근은 IP 블랙리스트가 아니라 **행위 기반**입니다.  
탐지 정확도는 **임계치(1차) + 세션 행위(2차)**로 확보합니다.

따라서 유효한 키를 가진 공격자가 “정상처럼” 위장해도, 다음 조건에서 탐지·차단이 가능합니다.

- **임계치 기반:** 동일 **키/계정/세션**에서 실패·재시도가 정상 범위를 초과
- **세션 행위 기반:** 세션 내에서 반복·자동화된 인증 또는 토큰 발급 흐름이 관측됨

## 6️⃣ 분산 IP는 “탐지 불가”가 아니라, 행위 기반 탐지의 영역입니다

IP 분산은 흔한 우회 수단이지만, IP를 늘린다고 공격이 “정상”이 되지는 않습니다.

핵심은 다음입니다.

> IP가 분산된다고 탐지가 불가능해지는 것이 아닙니다. 공격의 본질은 **반복성, 시간 밀도, 자동화 패턴, 정상 대비 편차**입니다.

따라서 방어 모델은 IP 중심에서 **계정/키/세션/엔드포인트 행위** 중심으로 전환되어야 합니다.

## 7️⃣ 쿠팡 적용 아키텍처 제안: 보안 조직이 독자적으로 운영 가능한 기반을 먼저 구축합니다

대부분의 보안 솔루션은 결국 “이벤트/로그”를 소비합니다. 기반이 약하면 어떤 도구도 정확히 동작하기 어렵습니다.

### 7-1) (핵심) 보안 조직 독자 운영(Autonomous Operation) 원칙

인사/개발 변경이 실시간 공유되지 않더라도 침투·유출을 통제하려면, 최소 다음 3가지를 보안 조직이 직접 소유/운영해야 합니다.

1) **관측(Observability) 파이프라인**

- 종료/복호화 지점에서 요청 본문과 응답 결과 신호 수집(웹 서버 / WAF / API Gateway)
- 필드 단위 마스킹/해싱, 접근 권한 분리, 보관기간(리텐션) 정책으로 개인정보·민감정보를 통제

2) **탐지(Detection) 정책**

- 계정/키/세션/엔드포인트 단위 Brute Force/자동화 탐지(임계치 + 상관 규칙)
- 정상 기준선 대비 편차(성공/실패 비율, 시간 밀도)로 이상 징후 식별

3) **통제(Enforcement) 정책**

- 단계적 자동 대응(제한 → 추가 인증 → 차단/격리)
- 예외 처리, 롤백, 승인 절차를 포함해 운영 리스크 최소화

### 7-2) 권장 구현 흐름

**1. 종료/복호화 지점(웹 서버 / WAF / API Gateway)**

  - 요청 본문(POST Body) 전체 수집
  - 응답 결과 신호(최소: 성공/실패, 사유, 토큰 발급 신호) 수집

**2. PLURA-XDR**

  - “키가 유효해도” 행위 기반 Brute Force 탐지(반복성/시간 밀도/편차)
  - 계정/키/세션/엔드포인트 상관분석으로 분산 IP 우회 무력화

**3. 대응(운영 정책)**

  - 1단계: Rate limit/지연(엔드포인트/키/계정 기준)
  - 2단계: Step-up 인증(추가 인증, 챌린지/CAPTCHA 등)
  - 3단계: 자동 차단/격리(키/계정) + SOC 통보
  - 키 교체와 병행해 노출 창을 최소화

## 8️⃣ 한 문장 정리

> 키가 반출되어 “정상 서명”이 가능해져도, 공격은 요청 본문과 응답 결과 신호에 남는 반복·자동화 행위로 드러납니다.  
> PLURA-XDR은 임계치 + 세션 행위 기반으로 Brute Force를 탐지·차단하는 Layer-2 방어선을 제공합니다.  
> 또한 인사/개발 변경이 보안 조직에 실시간 공유되지 않더라도, “관측 + 통제” 운영 표준으로 침투·유출 시도를 독자적으로 탐지·통제할 수 있습니다.

## 9️⃣ 실행 제안: 개발 의존을 최소화한 보안팀 주도 파일럿

실무에서 중요한 것은 “완벽한 설계”가 아니라, 보안 조직이 **지금부터** 통제권을 가지는 것입니다.

본 제안은 다음 원칙으로 시작합니다.

- **범위 최소화:** 핵심 엔드포인트(로그인/인증/토큰 발급)부터 시작
- **협업 최소화:** 애플리케이션 기능 개발보다, **종료 지점 설정과 보안 정책**을 우선
- **오탐 최소화:** 단계적 통제(제한 → 추가 인증 → 차단)로 안정성 확보

### 9-1) 보안팀이 즉시 착수 가능한 범위(보안 주도)

- 종료/복호화 지점에서 요청 본문 수집 활성화(마스킹/접근권한/리텐션 포함)
- 응답 결과 신호(성공/실패·사유) 구조화 수집 및 정규화
- 임계치 + 세션 행위 기반 탐지 룰 적용
- 단계적 자동 통제(제한/추가 인증/차단) 적용

### 9-2) 최소 승인 항목

개발 협업이 제한적이어도, 다음 승인은 필요합니다.

- 종료/복호화 지점(WAF / API Gateway / 웹 서버) 운영·설정 권한
- 민감정보 처리 원칙 승인(마스킹/해싱, 접근 권한 분리, 보관기간)
- 단계적 통제 범위 승인(즉시 강차단이 아닌 단계적 통제부터 적용)

> 위 3가지만 확보되면, 보안 조직은 “알려주지 않아도 동작하는” 운영 모델을 현실적으로 시작할 수 있습니다.

## 🔟 최종 정리: 쿠팡을 위한 4가지 운영 원칙

- **전제 변경:** “키가 이미 유출되었을 수 있다”에서 설계 시작
- **다층 방어:** 키 교체(1차, Layer 1) + 행위 기반 Brute Force 탐지/차단(2차, Layer 2)
- **가시성 기반:** Access Log만이 아니라 **요청 본문(필수)** + **응답 결과 신호(안전한 차단을 개선)**를 분석
- **조직 의존도 제거:** 인사/개발 이벤트 인지 없이도 동작하는 **보안 조직 독자 운영 모델**로 침투·유출을 통제

### 🎥 데모 영상: 탈취된 JWT로 고볼륨 API 접근을 방어

- https://youtu.be/l6JeCeWeVSo
