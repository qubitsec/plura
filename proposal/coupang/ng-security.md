## 0️⃣ 제안 요약

쿠팡이 지금 필요한 것은 “키가 유출되지 않게 **잘 보관**하는 것”만이 아니라,
**키가 유출되었더라도 침투·유출 사고가 ‘확대되지 않게’ 만드는 운영 표준**입니다.

PLURA‑XDR 제안 포인트는 다음 4가지입니다.

1. **키 교체/폐기(1차)**는 필수이지만, 교체 전·후 공백/지연/자동화 공격까지 완전히 커버하지 못합니다.
   → “키를 가진 공격자” 시나리오까지 포함하는 **행위 기반 Brute Force 탐지·차단(2차)**이 필요합니다.

2. Brute Force의 “증거”는 Access Log 표면(URL/응답코드/IP)이 아니라,
   대부분 **요청 본문(POST Body)**과 **응답 결과 신호(성공/실패·사유)** 안에 있습니다.
   → **요청 본문 + 응답 결과 신호 기반 분석**이 있어야 “탐지”가 “차단”으로 연결됩니다.

3. IP가 수천 개로 분산돼도 공격의 본질은 IP 숫자가 아니라 **반복성/시간 밀도/자동화 패턴/정상 대비 편차**입니다.
   → IP 중심이 아니라 **계정·키·엔드포인트 단위의 행위 기반**으로 탐지·차단 가능합니다.

4. **조직 이벤트 의존도 제거(핵심)**
   개발자 입·퇴사 정보, 배포/개발 변경 사항이 보안 조직에 실시간 공유되지 않더라도,
   보안 조직이 **독자적으로(Autonomous)** 운영 가능한 “관측(Observability) + 통제(Enforcement)” 체계를 갖추어
   침투·유출 시도를 **상시 탐지·완화**할 수 있어야 합니다.

---

## 1️⃣ 전제 전환: “퇴사”는 인사 이벤트가 아니라 보안 이벤트입니다

키(서명키/인증키/API Key 등)를 다루던 담당자가 퇴사하면,
로컬 노트북·개인 클라우드·백업 등 경로로 **키가 통제 밖으로 나갔을 가능성 자체가 리스크**가 됩니다.

따라서 출발점은 다음이어야 합니다.

> “반출되지 않았을 것”이 아니라,
> “이미 반출되었을 수 있다”에서 출발한다.

### (운영 현실) 보안 조직은 ‘사실을 나중에 알게 되는 구조’인 경우가 많습니다
실무에서는 보안 조직이 개발자 입·퇴사, 권한 변경, 배포 일정/개발 변경 사항을
**사전에 충분히 공유받지 못하거나, 사후에 인지하는 경우가 흔합니다.**

따라서 “인사 이벤트를 트리거로 한 대응(예: 퇴사 통보 → 즉시 키 교체)”만으로는
항상 공백이 발생할 수밖에 없습니다.

→ 결론: **인사/개발 이벤트를 ‘알아야만 작동하는 보안’이 아니라, ‘몰라도 작동하는 보안’**이 필요합니다.

---

## 2️⃣ 왜 ‘키 교체’만으로는 방어가 완성되지 않나요

키 교체/폐기는 반드시 필요하지만, 현실적으로 다음 문제가 남습니다.

- 교체 전 **공백 시간**
- 교체 **지연 가능성**
- 이미 키를 확보한 공격자의 **자동화 공격 지속**

즉, 쿠팡에는 아래가 추가로 필요합니다.

> “이미 키를 가진 공격자”를 전제로 한 **2차 방어선**
> = **행위 기반 Brute Force 탐지·차단**

핵심은 간단합니다.
**키 통제는 ‘자산 관리’**, Brute Force 방어는 **‘행위 통제’**입니다.
두 축이 함께 있어야 사고가 커지지 않습니다.

---

## 3️⃣ 왜 Access Log 중심 탐지는 실패하기 쉬운가

웹 서버 Access Log에는 보통 IP, 시간, 메서드, URL, 응답코드 등만 남습니다.

예를 들어 아래 로그는 정상처럼 보일 수 있습니다.

- `POST /login ... 200`

하지만 실제 시도 값(계정/패스워드/토큰/파라미터)은 URL이 아니라 **Body(요청 본문)** 안에서 발생합니다.

또한 운영 환경에서는 “응답코드는 200이지만 실패 사유는 응답 본문(JSON 메시지/코드)에 존재”하는 설계도 흔합니다.
→ **요청·응답 본문(또는 결과 신호)이 없으면 ‘정상’으로 오판할 가능성이 커집니다.**

---

## 4️⃣ 핵심 제안: 쿠팡의 2차 방어선은 “요청 본문 + 응답 결과 신호” 분석이어야 합니다

### 4-1) 왜 ‘요청 본문(POST Body)’가 필수 인프라인가

웹 공격을 판단할 수 있는 근거가 **POST Body 안에 존재하는 경우가 대부분**이며,
Access Log만으로는 식별이 불가능합니다.

특히 HTTPS 환경에서는 네트워크 구간에서 본문이 보이지 않고,
**복호화 지점(웹 서버/WAF/API Gateway)** 에서만 본문 분석이 가능합니다.
따라서 이 지점에서 수집하지 않으면 이후에는 복구할 방법이 없습니다.

또한 부분 수집(예: 8KB 제한, 일부 파라미터만)은 공격자가 악용할 수 있어
**원본 그대로 전체 수집**이 권장됩니다.

### 4-2) 왜 ‘응답 결과 신호’까지 봐야 탐지가 “차단”으로 이어지는가

Brute Force는 단순히 “요청이 많다”가 아니라,

- 로그인 성공/실패
- 실패 사유(비밀번호 오류/계정 잠금/추가 인증 필요 등)
- 토큰 발급 여부/권한 부여 여부

같은 **결과 신호**로 정상 트래픽 폭증(프로모션/장애)과 구분됩니다.

즉,

> **요청 본문(시도 내용) + 응답 결과 신호(성공/실패·사유)**를 결합해야
> “정확한 탐지”가 “안전한 자동 차단”으로 이어집니다.

※ 현실적으로 응답 본문 “전체 저장”이 부담이라면,
응답에서 **성공 여부/실패 사유 코드만 구조화하여 수집**하는 방식으로
개인정보·성능·비용 리스크를 낮추면서도 차단 정확도를 크게 개선할 수 있습니다.

---

## 5️⃣ “키가 유출돼도 탐지 가능”한 이유: 키는 통과해도 ‘행위’는 숨기기 어렵습니다

서명키/인증키가 반출되면 요청 서명/헤더는 정상처럼 보일 수 있습니다.
하지만 공격자가 수행하는 Brute Force/자동화 인증 시도는 다음 특성을 가집니다.

- 단위 시간 대비 요청 증가율(시간 밀도)
- 동일 리소스(로그인/토큰) 반복 호출
- 정상 대비 편차(성공률 급락/실패 반복)
- 자동화 패턴 지속성(간격이 일정·연속성이 높음)

PLURA‑XDR의 핵심은 **IP 블랙리스트가 아니라 행위 기반**입니다.

따라서 “키를 가진 정상 서명 요청”처럼 위장해도,
아래 조건이 성립하면 탐지·차단이 가능합니다.

- 동일 키 식별자(API Key ID/Client ID 등)로 실패가 임계치 이상 누적
- 요청 본문에서 계정 스프레이/패스워드 스프레이 패턴 확인
- 응답 결과 신호에서 실패가 다수를 차지하며 정상 대비 성공률 급락
- 정상 사용자군 대비 요청 간격·연속성이 비정상(봇 패턴)

---

## 6️⃣ 분산 IP는 “회피”가 아니라 “행위 기반 탐지의 영역”입니다

분산 IP는 흔한 우회 수단이지만, IP를 늘린다고 공격이 ‘정상’이 되지는 않습니다.

핵심은 다음입니다.

> IP를 수천 개로 분산했다고 해서 탐지가 불가능해지는 것이 아니라,
> 공격의 본질은 **반복성/시간 밀도/자동화 패턴/정상 대비 편차**입니다.

따라서 방어 관점도 IP 중심이 아니라 **계정·키·엔드포인트·행위** 중심으로 재정의되어야 합니다.

---

## 7️⃣ 쿠팡 적용 아키텍처 제안: 보안 조직이 ‘독자적으로 운영’ 가능한 기반을 먼저 구축합니다

기존 솔루션은 결국 “기반 이벤트/로그”를 소비합니다.
기반이 부실하면 상위 솔루션이 아무리 좋아도 정확히 동작하기 어렵습니다.

### 7-1) (핵심) 보안 조직 독자 운영(Autonomous Operation) 원칙
보안 조직이 인사/개발 변경 정보를 실시간으로 공유받지 못해도
침투·유출을 통제하려면, 최소 다음 3가지를 **보안 조직이 직접 소유/운영**할 수 있어야 합니다.

1) **관측(Observability) 파이프라인**
- 복호화 지점(웹 서버/WAF/API Gateway)에서 요청 본문 및 응답 결과 신호 수집
- 개인정보/민감정보는 필드 단위 마스킹/해싱, 열람 권한 분리, 보관기간(리텐션) 정책으로 통제

2) **탐지(Detection) 정책**
- 계정·키·엔드포인트 단위의 Brute Force/자동화 패턴 탐지 기준(임계치·상관 규칙)
- 정상 대비 편차(성공률/실패율/시간 밀도) 기반의 이상 징후 식별

3) **통제(Enforcement) 정책**
- 단계적 자동 대응(제한 → 추가 인증 → 차단/격리)
- 운영 중 오탐 최소화를 위한 예외/롤백/승인 절차 포함

### 7-2) 구현 흐름(권장)
1. **복호화 지점(웹 서버/WAF/API Gateway)**
   - 요청 본문(POST Body) 전체 수집
   - 응답 결과 신호(최소: 성공/실패·사유·토큰 발급 여부) 수집

2. **PLURA‑XDR**
   - “키가 정상이어도” 행위 기반 Brute Force 탐지(반복성/시간 밀도/편차)
   - 계정·키·엔드포인트 단위 상관분석(분산 IP 우회 대응)

3. **차단/완화 액션(운영 정책)**
   - 1단계: Rate limit/지연(엔드포인트·키·계정 기준)
   - 2단계: Step-up 인증(추가 인증, 챌린지/CAPTCHA 등)
   - 3단계: 자동 차단/격리(키·계정 단위) + SOC 통보
   - 키 교체와 병행(공백 최소화)

---

## 8️⃣ 한 문장 정리

> **키가 반출되어 “정상 서명”이 가능해져도, 공격은 요청/응답 본문에 남는 반복·자동화 ‘행위’로 드러납니다.
> PLURA‑XDR은 그 행위를 기준으로 Brute Force를 탐지·차단하는 2차 방어선을 제공합니다.
> 또한 개발자 입·퇴사 및 개발 변경 사항이 보안 조직에 실시간 공유되지 않더라도,
> 보안 조직이 요청·응답 기반 행위 신호를 통해 침투·유출 시도를 독자적으로 탐지·통제할 수 있도록
> ‘관측 + 통제’ 운영 표준을 구축합니다.**

---

## 🔟 최종 정리: 쿠팡에 제안하는 운영 원칙 4가지

- **전제 변경:** “이미 키가 유출되었을 수 있다”에서 설계 시작
- **다층 방어:** 키 교체(1차) + 행위 기반 Brute Force 탐지·차단(2차) 병행
- **가시성 인프라:** Access Log가 아닌 **요청 본문(필수) + 응답 결과 신호(차단 정확도 향상)** 기반 분석
- **조직 의존도 제거:** 인사/개발 이벤트를 몰라도 작동하는 **보안 조직 독자 운영(Autonomous)** 체계로 침투·유출을 통제

---

### 🎥 [영상 시연] 유출된 JWT를 이용한 대량 조회 공격 방어

- 📺 https://youtu.be/l6JeCeWeVSo
