## 

## 1. 개요: AISVA + PLURA 웹 패킷 분석 통합

AISVA(Application Insight SSL Visibility Appliance)는
HTTPS 트래픽을 복호화하여 보안 장비들이 가시성을 갖도록 해 주는 **SSL 가시성 장비**입니다.

PLURA-XDR는 AISVA와 연동하여 **복호화된 웹 패킷을 미러 포트로 수집·분석**함으로써,

* **웹방화벽(WAF)이 통과시킨 공격**
* **정책 예외로 인해 차단하지 못한 트래픽**
* **최신 AI 기반 우회 공격**

까지 탐지·분석하고, **증적화·포렌식까지 자동 수행**하는 것을 목표로 합니다.

---

## 2. 특별한 환경에서 WAF 운영 시 발생하는 한계

특정 서비스/고객 환경에서는 WAF를 “교과서대로”만 운영하기 어렵습니다. 이 과정에서 실제로는 다음과 같은 문제들이 발생합니다.

### 2-1. WAF가 공격을 놓치는 주요 원인

1. **예외처리(Whitelist, Policy Bypass)**

   * 특정 URL, 파라미터, 클라이언트 IP에 대해
     “업무 영향 최소화”를 이유로 예외 정책 적용
   * → 해당 구간은 **사실상 WAF 미적용 구간**이 되어 공격이 그대로 통과

2. **시그니처 업데이트 미비**

   * 유지보수 계약 문제, 내부 프로세스 지연 등으로
     시그니처·룰셋 업데이트가 정기적으로 수행되지 않음
   * → **신규 취약점, 최신 공격 패턴**에 대해 탐지 불가

3. **운영자 부주의·설정 실수**

   * 테스트용으로 룰을 Off 해 둔 후, 다시 On 하지 않거나
   * 정책 우선순위, 매칭 순서를 잘못 설정해 **실질적으로 무효화된 룰** 발생
   * → 공격이 들어와도 **탐지 로그가 전혀 남지 않는 블라인드 존** 생성

4. **신규 서비스/URL 반영 지연**  *(더불어 추가)*

   * 신규 API, 모바일/SPA용 엔드포인트가 빠르게 늘어나는데
     WAF 정책에 이를 **제때 반영하지 못하는 구간** 발생
   * → 신규 경로로 들어오는 공격을 WAF가 모르는 상태

5. **성능 이슈로 인한 룰 축소·탐지 레벨 완화**  *(더불어 추가)*

   * TPS/Latency를 이유로 **탐지 룰 수를 줄이거나, 탐지 모드를 완화**
   * → 공격 탐지 정확도보다 서비스 가용성을 우선하면서
     **“찾지 못하는 공격”이 늘어나는 구조**

6. **암호화/차단 우회 패턴**  *(더불어 추가)*

   * 비표준 포트, 특수 인코딩, 분할 전송, 우회 Proxy 등을 사용하는 공격
   * 일부 트래픽은 WAF가 아닌 다른 경로로 전달될 수 있어
     **WAF 기준으로는 아예 트래픽 자체를 인지하지 못하는 경우** 발생

---

## 3. AI 시대의 웹 공격 고도화

최근 공격자는 **AI와 자동화 도구**를 활용하여 다음과 같이 WAF를 우회합니다.

* **Payload 자동 변형(Polymorphic Payload)**

  * 동일한 취약점 대상 공격이라도,
    파라미터 이름·순서·인코딩 방식 등을 자동으로 변경
* **WAF 시그니처 회피 패턴 생성**

  * 공개된 WAF 룰셋을 기반으로 “탐지되지 않는 패턴”을
    자동 생성·테스트하는 AI 기반 툴 사용
* **대량·지속적 테스트**

  * 수천~수만 개의 변종 요청을 자동으로 전송해
    “한 번이라도 통과되는 패턴”을 찾아내는 방식

이러한 환경에서는

> **“WAF 로그에 안 남았으니 안전하다”는 가정 자체가 위험**

해지고,
**WAF를 통과한 이후의 웹 패킷을 별도로 분석하는 체계**가 필수적입니다.

---

## 4. AISVA(SSL Visibility Appliance)의 역할과 위치

### 4-1. SSL 복호화 장비가 필요한 이유

* 대부분의 웹 트래픽은 **HTTPS(SSL/TLS)** 로 암호화되어 있어,
  네트워크 미러 기반 분석만으로는 **내용(URI, 파라미터, POST-Body)** 를 볼 수 없음
* AISVA는 **SSL 복호화 후, 트래픽을 재암호화하여 서버로 전달**하면서
  동시에 **복호화된 평문 트래픽을 미러 형태로 PLURA에 제공**합니다.

### 4-2. 왜 “웹방화벽 뒤”에 위치해야 하는가?

PLURA의 목표는 **“웹방화벽을 통과한 공격”을 잡는 것**입니다.
따라서 SSL 복호화 장비의 위치는 매우 중요합니다.

* **WAF 앞단에 위치하는 경우**

  * 복호화된 트래픽이 WAF에 들어가기 전에 미러링됨
  * PLURA는 “**WAF 차단 전의 원본 트래픽**”만 보게 됨
  * → “WAF가 이미 차단한 공격”인지, “통과된 공격”인지 **구분이 어려움**

* **WAF 뒷단에 위치하는 것이 권장 구성** ✅

  * 클라이언트 → WAF → AISVA(복호화) → WAS
  * AISVA에서 복호화된 평문 트래픽을 PLURA로 미러
  * → PLURA는 “**이미 WAF를 통과한 최종 트래픽**”을 기준으로 분석
  * → **WAF 미탐/우회 공격을 정확히 포착** 가능

---

## 5. PLURA가 제공하는 핵심 가치 (AISVA 연동 시)

AISVA와 연동하여 웹 패킷을 분석할 때, PLURA가 제공하는 핵심 가치를 정리하면 다음과 같습니다.

### 5-1. WAF를 통과한 공격 전용 “2차 방어선”

* PLURA는 **WAF 이후**의 트래픽을 미러로 수집
* WAF가 탐지하지 못한 공격, 예외 처리된 URI, 정책 미비 영역을
  **전용 탐지 룰 + AI 분석으로 재검증**
* 결과적으로, **WAF + PLURA** 조합이
  “1차 차단 + 2차 추적·증적화” 구조를 형성

### 5-2. SSL 복호화 이후의 웹 패킷에 대한 정밀 분석

* AISVA에서 복호화된 트래픽을 받아

  * **Request Line, Header, QueryString, Cookie, POST-Body** 까지 정밀 분석
  * JSON·XML·nexacro·multipart 등 다양한 포맷을 파싱
* 특히, **POST-Body 내 공격 코드**(파일 업로드, SQLi, RCE 등)를
  PLURA의 **전문화된 웹 분석 엔진 + AI로 재분석**

### 5-3. AI 기반 “WAF 우회 공격” 탐지

* WAF 로그와 AISVA/PLURA 패킷을 함께 분석하여

  * WAF가 **차단한 요청 vs 통과한 요청**을 비교
  * 동일 목적의 공격인데 패턴만 변형된 우회 공격을 AI가 식별
* **status 406, Blocked:1** 등의 WAF 차단 로그와
  실제 공격 코드 여부를 비교하여
  **오탐/미탐 설명, 룰 튜닝 가이드를 제공** (WAF 운영 고도화 지원)

### 5-4. 포렌식·증적화 및 감사 대응

* 공격이 발생했을 때, PLURA는

  * **공격에 사용된 URI / 파라미터 / 계정 / 세션 / IP / User-Agent**
  * 시간대별 세션 흐름, 연속된 요청 시퀀스
  * 필요 시 원본 패킷(PCAP)까지
* 를 **증거 형태로 자동 보존**하여,

  * 실무 포렌식
  * 규제/감사 대응
  * 사고 조사 보고서 작성
    에 활용 가능

### 5-5. 운영 효율화 및 룰 개선 피드백

* “어떤 공격이 WAF에서 놓였는지”에 대한 **정량적 인사이트 제공**

  * 예: `월간 WAF 미탐 TOP URL`, `WAF 예외 영역에서 발생한 공격 TOP N`
* 이를 기반으로

  * WAF 룰 보강
  * 예외 정책 재점검
  * 신규 취약점 대응 정책 수립
    을 지원하여, **WAF·PLURA·AISVA 전체 보안 품질을 순환적으로 개선**

---

## 6. 전체 구성도 (Mermaid)

아래는 **권장 구성(웹방화벽 뒤 SSL 복호화 + PLURA 미러 연동)** 을 나타낸 예시입니다.

```mermaid
graph LR
  subgraph Internet Zone
    C[사용자 브라우저<br/>Client]
  end

  subgraph DMZ
    FW[방화벽]
    WAF[웹방화벽 (WAF)]
    AISVA[SSL Visibility Appliance<br/>(AISVA)]
    SW[포트 미러링 스위치/탭]
  end

  subgraph Internal
    PLURA[PLURA-XDR<br/>Web Packet Sensor]
    WAS[웹 서버 / WAS]
  end

  C -->|HTTPS| FW --> WAF --> AISVA -->|복호화 후 재암호화| WAS

  %% 미러 구성
  AISVA -->|복호화된 웹 트래픽 미러| SW
  SW -->|SPAN/Mirror| PLURA

  %% 로그/이벤트 연계 (논리선)
  WAF -. 탐지 로그 .-> PLURA
  PLURA -. 분석 결과 / 알림 .-> SIEM[(보안 관제 / 운영자)]
```

* **패킷 흐름**

  * 클라이언트 → 방화벽 → WAF → **AISVA(복호화)** → WAS
  * AISVA는 복호화된 트래픽을 SW/TAP을 통해 **PLURA에 미러 제공**
* **로그/이벤트 흐름**

  * WAF 탐지 로그, PLURA 분석 결과는
    관제 시스템/대시보드에서 함께 조회

---

## 7. 정리: AISVA + PLURA 도입 시 메시지 포인트

문서나 슬라이드에 넣기 좋은 한 줄 메시지로 정리하면:

1. **“웹방화벽을 통과한 공격까지, SSL 복호화 + 패킷 분석으로 끝까지 추적합니다.”**
2. **“특별한 예외 정책·운영 이슈·AI 기반 우회 공격으로 인한 WAF 미탐을 PLURA가 다시 한 번 걸러냅니다.”**
3. **“AISVA와 연동된 PLURA는 단순 탐지를 넘어, 공격 세션 전체를 증적화하고 WAF 룰 개선까지 연결합니다.”**

---
